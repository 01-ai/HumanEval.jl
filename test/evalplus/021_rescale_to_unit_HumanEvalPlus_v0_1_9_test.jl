@testitem "021_rescale_to_unit_HumanEvalPlus_v0_1_9_test.jl" tags=[:HumanEvalPlus_v0_1_9] begin
    include(joinpath(ENV["GENERATION_DIR"], "021_rescale_to_unit.jl"))
    @test rescale_to_unit([-10.0, 0.0, 10.0]) == [0.0, 0.5, 1.0]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0]) == [1.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([1.5, 2.0, 2.5, 3.0, 3.5]) == [0.0, 0.25, 0.5, 0.75, 1.0]
    @test rescale_to_unit([10.0, 5.0, 2.5, 0.0, -2.5, -5.0, -10.0]) == [1.0, 0.75, 0.625, 0.5, 0.375, 0.25, 0.0]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 1.0]) == [1.0, 0.0, 1.0, 0.0, 1.0]
    @test rescale_to_unit([0.1, 0.5, 0.9, 0.3, 0.7]) == [0.0, 0.5, 1.0, 0.24999999999999997, 0.7499999999999999]
    @test rescale_to_unit([5.0, 10.0, 15.0, 20.0, 25.0]) == [0.0, 0.25, 0.5, 0.75, 1.0]
    @test rescale_to_unit([-100.0, -50.0, 0.0, 50.0, 100.0]) == [0.0, 0.25, 0.5, 0.75, 1.0]
    @test rescale_to_unit([1.0, 2.0, 3.0, 4.0]) == [0.0, 0.3333333333333333, 0.6666666666666666, 1.0]
    @test rescale_to_unit([7.0, 3.0, 8.0, 2.0]) == [0.8333333333333334, 0.16666666666666666, 1.0, 0.0]
    @test rescale_to_unit([1.5, 2.0, 2.5, 3.0, 3.5, 3.5, 3.4499912778820896]) == [0.0, 0.25, 0.5, 0.75, 1.0, 1.0, 0.9749956389410448]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 1.0, 0.6831806134735121]) == [1.0, 0.0, 1.0, 0.0, 1.0, 0.841590306736756]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 1.0, 0.531467821985593]) == [1.0, 0.0, 1.0, 0.0, 1.0, 0.7657339109927965]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -5.0, -9.46747586475692]) == [1.0, 0.7431613613015037, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0]
    @test rescale_to_unit([0.5, 0.9, 0.3, 0.7]) == [0.3333333333333333, 1.0, 0.0, 0.6666666666666665]
    @test rescale_to_unit([3.0, 8.0, 2.0]) == [0.16666666666666666, 1.0, 0.0]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -5.0, -2.5]) == [1.0, 0.6666666666666666, 0.3333333333333333, 0.16666666666666666, 0.0, 0.16666666666666666]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 0.6831806134735121, -1.0]) == [1.0, 0.0, 1.0, 0.0, 0.841590306736756, 0.0]
    @test rescale_to_unit([1.0, 2.0, 3.0, 4.88337557029465]) == [0.0, 0.25750792883628437, 0.5150158576725687, 1.0]
    @test rescale_to_unit([1.0, 1.0, -1.0, 1.0]) == [1.0, 1.0, 0.0, 1.0]
    @test rescale_to_unit([4.130142616161574, 2.0, 5.0, 5.0]) == [0.7100475387205248, 0.0, 1.0, 1.0]
    @test rescale_to_unit([-10.0, 10.0]) == [0.0, 1.0]
    @test rescale_to_unit([0.1, 0.9, 0.3, 0.7]) == [0.0, 1.0, 0.24999999999999997, 0.7499999999999999]
    @test rescale_to_unit([1.5, 2.0, 2.1745158364579007, 3.0, 3.5, 3.5, 3.4499912778820896, 2.7376185386525926, 3.5]) == [0.0, 0.25, 0.33725791822895035, 0.75, 1.0, 1.0, 0.9749956389410448, 0.6188092693262963, 1.0]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0, 2.0, 5.0]) == [1.0, 0.0, 0.0, 1.0, 0.0, 1.0]
    @test rescale_to_unit([1.0, 1.0, -1.0, 1.0, -1.0]) == [1.0, 1.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([-10.0, 0.0, 10.0, 0.5218127444499308]) == [0.0, 0.5, 1.0, 0.5260906372224966]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -5.0, -9.46747586475692, 3.5]) == [1.0, 0.7431613613015037, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0, 0.6661097696919548]
    @test rescale_to_unit([-9.142847173489907, 0.0, 10.0, -10.0]) == [0.04285764132550467, 0.5, 1.0, 0.0]
    @test rescale_to_unit([-100.0, -62.89269313319225, 0.0, 50.0, 100.0]) == [0.0, 0.18553653433403874, 0.5, 0.75, 1.0]
    @test rescale_to_unit([1.0, -1.0, -10.0, -1.0, 0.6831806134735121, -1.0, 1.0]) == [1.0, 0.8181818181818182, 0.0, 0.8181818181818182, 0.9711982375885011, 0.8181818181818182, 1.0]
    @test rescale_to_unit([0.1, 0.3, 0.7]) == [0.0, 0.3333333333333333, 1.0]
    @test rescale_to_unit([1.0, -1.0, 1.0, 1.0]) == [1.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([10.0, 4.067002335783351, 0.0, -2.5, -5.0, -9.46747586475692]) == [1.0, 0.6952353913042475, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0]
    @test rescale_to_unit([10.0, 5.0, 2.5, 0.26171065189523324, -2.5, -5.0, -10.0, -100.0]) == [1.0, 0.9545454545454546, 0.9318181818181818, 0.9114700968354111, 0.8863636363636364, 0.8636363636363636, 0.8181818181818182, 0.0]
    @test rescale_to_unit([0.1, 0.3, 0.7, 0.2985177336558441]) == [0.0, 0.3333333333333333, 1.0, 0.33086288942640685]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 0.531467821985593]) == [1.0, 0.0, 1.0, 0.0, 0.7657339109927965]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0, 2.0]) == [1.0, 0.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 0.6831806134735121, -1.0, -1.0]) == [1.0, 0.0, 1.0, 0.0, 0.841590306736756, 0.0, 0.0]
    @test rescale_to_unit([10.0, 0.0, -2.5, -5.0, -9.46747586475692]) == [1.0, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0]
    @test rescale_to_unit([1.0, -1.0, 3.4499912778820896, -1.0, -1.0, 1.0, 0.5838719823105398]) == [0.44943908315970266, 0.0, 1.0, 0.0, 0.0, 0.44943908315970266, 0.3559269857859949]
    @test rescale_to_unit([-10.0, 0.0, 10.0, 0.5218127444499308, 0.0, 0.531467821985593, -10.0]) == [0.0, 0.5, 1.0, 0.5260906372224966, 0.5, 0.5265733910992797, 0.0]
    @test rescale_to_unit([3.0, 8.0, 2.0, -50.0]) == [0.9137931034482759, 1.0, 0.896551724137931, 0.0]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -9.46747586475692, -3.3072700859535313]) == [1.0, 0.7431613613015037, 0.48632272260300735, 0.3579034032537592, 0.0, 0.31643577326609457]
    @test rescale_to_unit([-1.0, 1.0, -1.0, 0.531467821985593]) == [0.0, 1.0, 0.0, 0.7657339109927965]
    @test rescale_to_unit([0.1, 0.9, 0.3, 0.7, 0.7]) == [0.0, 1.0, 0.24999999999999997, 0.7499999999999999, 0.7499999999999999]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 0.531467821985593, 1.0]) == [1.0, 0.0, 1.0, 0.0, 0.7657339109927965, 1.0]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 0.531467821985593, 0.0]) == [1.0, 0.0, 1.0, 0.0, 0.7657339109927965, 0.5]
    @test rescale_to_unit([-5.937376318260506, 10.0]) == [0.0, 1.0]
    @test rescale_to_unit([3.944887597354252, 2.0, 2.0, 5.0, 2.0]) == [0.6482958657847506, 0.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([-1.0, 1.0, -1.0, 0.6831806134735121, -1.0, 1.1140129329785569]) == [0.0, 0.9460680059237304, 0.0, 0.7962016632991834, 0.0, 1.0]
    @test rescale_to_unit([-10.0, 0.0, 0.5218127444499308, 0.0, -10.0]) == [0.0, 0.9504065737412806, 1.0, 0.9504065737412806, 0.0]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0, 5.5393493405344465]) == [0.8476134202528298, 0.0, 0.0, 0.8476134202528298, 1.0]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -5.0, -7.758548951714786]) == [1.0, 0.7184454645706178, 0.4368909291412355, 0.29611366142654433, 0.15533639371185323, 0.0]
    @test rescale_to_unit([7.0, 3.0, 2.0]) == [1.0, 0.2, 0.0]
    @test rescale_to_unit([1.0, 1.0, 1.0, -0.6653352961236785, 1.0]) == [1.0, 1.0, 1.0, 0.0, 1.0]
    @test rescale_to_unit([1.5, 2.0, 2.5, 3.0, 3.5, 3.4499912778820896]) == [0.0, 0.25, 0.5, 0.75, 1.0, 0.9749956389410448]
    @test rescale_to_unit([0.1, 0.3, 0.7, 0.2985177336558441, 0.2985177336558441]) == [0.0, 0.3333333333333333, 1.0, 0.33086288942640685, 0.33086288942640685]
    @test rescale_to_unit([-1.342224527290663, 1.0, -1.0, 0.531467821985593]) == [0.0, 1.0, 0.14611089727018042, 0.799962739457615]
    @test rescale_to_unit([0.1, 0.9, 0.3, 0.7, 0.7, 0.9]) == [0.0, 1.0, 0.24999999999999997, 0.7499999999999999, 0.7499999999999999, 1.0]
    @test rescale_to_unit([-10.0, 0.0, 10.0, 0.0]) == [0.0, 0.5, 1.0, 0.5]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -5.0, -7.758548951714786, 10.0]) == [1.0, 0.7184454645706178, 0.4368909291412355, 0.29611366142654433, 0.15533639371185323, 0.0, 1.0]
    @test rescale_to_unit([-10.0, 0.0, 10.0, 0.5218127444499308, -10.0]) == [0.0, 0.5, 1.0, 0.5260906372224966, 0.0]
    @test rescale_to_unit([-1.0, 1.0, -1.0, 1.1140129329785569]) == [0.0, 0.9460680059237304, 0.0, 1.0]
    @test rescale_to_unit([-1.0, 1.0, -1.0, 0.531467821985593, 4.067002335783351]) == [0.0, 0.39471069233103145, 0.0, 0.30224336214931513, 1.0]
    @test rescale_to_unit([1.5, 2.0, 4.067002335783351, 3.0, 3.5, 3.5, 3.4499912778820896, 2.7376185386525926, 3.5]) == [0.0, 0.19477972147906875, 1.0, 0.5843391644372062, 0.779118885916275, 0.779118885916275, 0.7596375159849735, 0.48212598851216815, 0.779118885916275]
    @test rescale_to_unit([0.1, 0.9, 0.3, 0.7, 0.7, 0.9, 0.7]) == [0.0, 1.0, 0.24999999999999997, 0.7499999999999999, 0.7499999999999999, 1.0, 0.7499999999999999]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0, 3.4499912778820896, 5.165207408346182, 2.5]) == [0.9478051871385885, 0.0, 0.0, 0.9478051871385885, 0.45810308482745166, 1.0, 0.15796753118976475]
    @test rescale_to_unit([0.0, 10.0, 0.5218127444499308, 0.0, 0.531467821985593, -10.0]) == [0.5, 1.0, 0.5260906372224966, 0.5, 0.5265733910992797, 0.0]
    @test rescale_to_unit([5.0, 15.0, 20.0, 25.0, 15.0]) == [0.0, 0.5, 0.75, 1.0, 0.5]
    @test rescale_to_unit([5.0, 2.0, 4.067002335783351, 5.0, 2.0, 4.067002335783351]) == [1.0, 0.0, 0.6890007785944503, 1.0, 0.0, 0.6890007785944503]
    @test rescale_to_unit([0.0, -5.0, -9.46747586475692]) == [1.0, 0.4718761292423558, 0.0]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0, 3.4499912778820896, 5.165207408346182, 2.5, 4.067002335783351, 2.0, 1.3728105527515997]) == [0.9564372045867334, 0.16538075289329596, 0.16538075289329596, 0.9564372045867334, 0.5477224046492423, 1.0, 0.2972234948422022, 0.7104192640222375, 0.16538075289329596, 0.0]
    @test rescale_to_unit([0.13529057908833445, 0.3, 0.7, 0.2985177336558441, 0.2985177336558441, 10.0]) == [0.0, 0.016696834532450282, 0.05724541867544202, 0.01654657502850446, 0.01654657502850446, 1.0]
    @test rescale_to_unit([1.0, 2.0, 3.0, 4.88337557029465, 1.2200287334177464]) == [0.0, 0.25750792883628437, 0.5150158576725687, 1.0, 0.056659143426874836]
    @test rescale_to_unit([1.0, -1.0, 3.4499912778820896, -1.0, -1.0, 1.0, 0.5838719823105398, 0.13529057908833445]) == [0.44943908315970266, 0.0, 1.0, 0.0, 0.0, 0.44943908315970266, 0.3559269857859949, 0.2551219784926545]
    @test rescale_to_unit([3.0, 2.0]) == [1.0, 0.0]
    @test rescale_to_unit([5.0, 20.0, 25.0, 15.0]) == [0.0, 0.75, 1.0, 0.5]
    @test rescale_to_unit([-10.0, 0.0, 10.0, 0.5218127444499308, -9.863742780614741]) == [0.0, 0.5, 1.0, 0.5260906372224966, 0.006812860969262946]
    @test rescale_to_unit([7.0, 3.0, 2.0, 3.0, 7.0]) == [1.0, 0.2, 0.0, 0.2, 1.0]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -9.46747586475692, -3.3072700859535313, 0.26171065189523324]) == [1.0, 0.7431613613015037, 0.48632272260300735, 0.3579034032537592, 0.0, 0.31643577326609457, 0.4997662041161409]
    @test rescale_to_unit([-1.0, -10.0, -1.0, 0.6831806134735121, -1.0, 1.0]) == [0.8181818181818182, 0.0, 0.8181818181818182, 0.9711982375885011, 0.8181818181818182, 1.0]
    @test rescale_to_unit([10.0, 5.0, 2.5, 0.0, -2.5, -10.0]) == [1.0, 0.75, 0.625, 0.5, 0.375, 0.0]
    @test rescale_to_unit([5.0, 2.0, 3.1490494688822803, 5.0, 2.0]) == [1.0, 0.0, 0.3830164896274268, 1.0, 0.0]
    @test rescale_to_unit([-1.0, 1.0, -1.0]) == [0.0, 1.0, 0.0]
    @test rescale_to_unit([10.0, 4.067002335783351, 0.0, -2.5, -5.0, -9.46747586475692, 0.0]) == [1.0, 0.6952353913042475, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0, 0.48632272260300735]
    @test rescale_to_unit([3.944887597354252, 2.0, 0.13529057908833445, 5.0, 3.5]) == [0.78310885371484, 0.3833136287433611, 0.0, 1.0, 0.6916568143716805]
    @test rescale_to_unit([5.0, 5.0, 2.0, 5.0, 2.0]) == [1.0, 1.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([1.5, 2.0, 2.5, 3.0, 3.5, 1.7631948427633328, 3.0]) == [0.0, 0.25, 0.5, 0.75, 1.0, 0.1315974213816664, 0.75]
    @test rescale_to_unit([10.0, 5.0, 2.5, 0.0, -2.5, -5.0, -10.0, 0.0, -10.0]) == [1.0, 0.75, 0.625, 0.5, 0.375, 0.25, 0.0, 0.5, 0.0]
    @test rescale_to_unit([10.0, 0.0, -2.5, -5.0, -9.46747586475692, 10.0]) == [1.0, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0, 1.0]
    @test rescale_to_unit([-1.0, 1.0, -1.0, 0.6831806134735121, -1.0, 1.1140129329785569, 3.4499912778820896, 0.8299626343906432]) == [0.0, 0.44943908315970266, 0.0, 0.3782435758558606, 0.0, 0.47506001719281826, 1.0, 0.41122836430852244]
    @test rescale_to_unit([5.0, 2.0, 2.0, 5.0, 3.4499912778820896, 5.165207408346182, 2.5, 4.067002335783351, 2.0, 1.3728105527515997, 6.451678726414332]) == [0.7141727887441065, 0.12349000324536667, 0.12349000324536667, 0.7141727887441065, 0.40898496556812336, 0.7467011794597568, 0.2219371341618233, 0.5304709023563371, 0.12349000324536667, 0.0, 1.0]
    @test rescale_to_unit([10.0, 5.0, 0.0, -2.5, -5.0, 50.0]) == [0.2727272727272727, 0.18181818181818182, 0.09090909090909091, 0.045454545454545456, 0.0, 1.0]
    @test rescale_to_unit([1.0, -1.0, 1.0, -1.0, 0.531467821985593, -7.758548951714786, 1.0]) == [1.0, 0.7716516730081835, 1.0, 0.7716516730081835, 0.9465057305042891, 0.0, 1.0]
    @test rescale_to_unit([5.0, 2.0, 5.0, 5.5393493405344465, 10.0]) == [0.375, 0.0, 0.375, 0.4424186675668058, 1.0]
    @test rescale_to_unit([0.0, 10.0, 0.5218127444499308, -9.863742780614741]) == [0.4965702027837816, 1.0, 0.5228398111961082, 0.0]
    @test rescale_to_unit([10.0, 4.067002335783351, 0.0, -2.5, -5.0, -9.46747586475692, 4.067002335783351]) == [1.0, 0.6952353913042475, 0.48632272260300735, 0.3579034032537592, 0.22948408390451103, 0.0, 0.6952353913042475]
    @test rescale_to_unit([-6.486753627961523, 0.0]) == [0.0, 1.0]
    @test rescale_to_unit([-100.0, 0.0, 50.0, 100.0]) == [0.0, 0.5, 0.75, 1.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 13.0, 15.0, 17.0, 19.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, 1.3, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.7678571428571429, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.9595959595959596, 1.0]
    @test rescale_to_unit([1.0, 2.0, 2.0, 3.0, 4.0, 4.0]) == [0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 1.0]
    @test rescale_to_unit([5.0e-9, 1.0e9]) == [0.0, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -0.1, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.9595959595959596, 1.0, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -5.0, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.5050505050505051, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 3.0, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.499560300532895, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.0, 0.0, 0.0, 0.499560300532895, 0.0, 0.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.17857142857142858, 0.5, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([7.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0]) == [0.8571428571428571, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 0.7678571428571429, 1.0]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.2451826892610212, 2.6, -0.1]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 0.7580683373680396, 1.0, 0.5178571428571429]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -0.1, -0.1, -0.5]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.9595959595959596, 1.0, 1.0, 0.9595959595959596]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 2.6, -0.1]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 1.0, 0.5178571428571429]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -9.66675615633341, -0.1, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.9595959595959596, 0.033660994309756595, 1.0, 1.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, -100000.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -100000.0, -1.0, -0.5, -9.66675615633341, -0.1, -0.1]) == [0.999900999901, 0.999945999946, 0.0, 0.999990999991, 0.9999959999960001, 0.999904332342769, 1.0, 1.0]
    @test rescale_to_unit([-3.0, -2.5, 0.0, 1.3, 2.6]) == [0.0, 0.08928571428571429, 0.5357142857142857, 0.7678571428571429, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9999400113978344]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 13.0, 17.0]) == [0.0, 0.9998800203965326, 0.9999200135976883, 0.9999400101982663, 0.9999600067988442, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999400113978344]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 1.9850204264692954, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.49893003046209256, 0.7857142857142857]
    @test rescale_to_unit([7.0, 9.0, -1.0, -5.0, -3.0, 2.0, 4.0, 6.0]) == [0.8571428571428571, 1.0, 0.2857142857142857, 0.0, 0.14285714285714285, 0.5, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 17.0, 19.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999960005199324, 0.999980002599662, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, -87387.4823957305]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.12610121681150077]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0]
    @test rescale_to_unit([7.0, -0.5, 9.0, -1.0, -5.0, 1.9850204264692954, 6.0]) == [0.8571428571428571, 0.32142857142857145, 1.0, 0.2857142857142857, 0.0, 0.49893003046209256, 0.7857142857142857]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 1.2451826892610212, 4.0, 4.0, 4.0]) == [0.2739990444362713, 0.2739990444362713, 0.6369995222181357, 0.6369995222181357, 0.6369995222181357, 1.0, 0.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 7.0, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 19.0]) == [0.0, 0.06492479134286995, 0.3934791450276302, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 1.0]
    @test rescale_to_unit([7.0, 9.0, -1.0, 2.0, 4.0, 6.0]) == [0.8, 1.0, 0.0, 0.3, 0.5, 0.7]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 2.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50001]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0]) == [0.1836734693877551, 0.0, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.5833333333333334, 0.75, 0.9166666666666666]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 9.0, 8.422739790413504]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999960005199324, 0.999980002599662, 1.0, 0.999960005199324, 0.9999542333475689]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.2400220924963046, -5.0, 3.0, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.26856985053597826, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999400113978344]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.5662174840625468, 0.2831087420312734, 0.660587064739638, 0.7549566454167291, 0.8493262260938202, 1.0, 0.9436958067709114]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6]) == [1.0, 0.09147524010848404, 0.0, 0.09966014785525446, 0.20606394856326984, 0.31246774927128523]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, -5.5]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 0.9997550465411572]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, -1.0, 11.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.1836734693877551, 0.673469387755102]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6]) == [1.0, 0.09147524010848404, 0.0, 0.17321106918203333, 0.21920090241868048, 0.31246774927128523]
    @test rescale_to_unit([-100000.0, 5.0, -1.2, 11.0, 17.0, 19.0, 11.0, 11.0, 17.0]) == [0.0, 0.999860026594947, 0.9997980383727092, 0.9999200151971126, 0.9999800037992781, 1.0, 0.9999200151971126, 0.9999200151971126, 0.9999800037992781]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 3.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.500015]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, 2.0, 4.0]) == [0.0, 0.0, 1.000020000400008e-5, 1.000020000400008e-5, 1.000020000400008e-5, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5, 1.0, 0.0, 2.000040000800016e-5]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.8493262260938202, 1.0, 0.9436958067709114]
    @test rescale_to_unit([3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.673376412076657, 1.0, 0.3366882060383285, 0.0, 0.2104301287739553, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.3366882060383285, 0.0, 0.2104301287739553, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033]
    @test rescale_to_unit([0.0, 0.0, 0.0, -100000.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.999990000099999, 0.999990000099999, 0.999990000099999, 0.0, 0.999990000099999, 0.999990000099999, 0.999990000099999, 0.999990000099999, 1.0, 0.999990000099999]
    @test rescale_to_unit([-10.0, -5.5, -1.0, 2.0, -0.1]) == [0.0, 0.375, 0.75, 1.0, 0.8250000000000001]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 5.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0, 0.3]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 1.5222176980104452, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.5000076110884901, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 13.0, 17.0, 19.0, -87387.4823957305]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999400113978344, 0.9999800037992781, 1.0, 0.12610121681150077]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, 2.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 1.000020000400008e-5, 1.000020000400008e-5, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5, 1.0, 0.0, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5]
    @test rescale_to_unit([7.0, 9.0, -1.0, -5.0, -3.0, -5.5, 4.0, 6.0]) == [0.8620689655172413, 1.0, 0.3103448275862069, 0.034482758620689655, 0.1724137931034483, 0.0, 0.6551724137931034, 0.7931034482758621]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0, 9.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999400113978344, 0.9999000189963907]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 11.029460583547525, 17.0, 19.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999203097469835, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-0.5, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0]) == [0.023592395169272785, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.8493262260938202, 1.0, 0.9436958067709114]
    @test rescale_to_unit([-9.66675615633341, -3.0, 0.0, 1.3, 2.6]) == [0.0, 0.5434815913326294, 0.7880450245472922, 0.8940225122736462, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.494052310009373, 7.824002367662983, 9.0, 8.422739790413504, -100000.0]) == [0.0, 0.9999492937171365, 0.999915070937272, 0.9999550655403794, 0.999975062841933, 1.0, 0.9999433071507393, 0.9999550655403794, 0.9999492937171365, 0.0]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 11.029460583547525, 19.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999203097469835, 1.0]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 9.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.4718479033854557]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, 0.0]) == [1.0, 0.09147524010848404, 0.0, 0.09966014785525446, 0.20606394856326984, 0.31246774927128523, 0.09966014785525446]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, -93935.84316983708, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.03032078415081458, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 0.5]
    @test rescale_to_unit([2.0, 2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-10.0, -5.5, -1.2400220924963046, -1.0, 2.0, -0.1]) == [0.0, 0.375, 0.7299981589586414, 0.75, 1.0, 0.8250000000000001]
    @test rescale_to_unit([-0.9741314779560433, -5.5, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 11.0]) == [0.18472932743036558, 0.0, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.673469387755102]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.2451826892610212, -0.1, -0.1]) == [0.0, 0.6831272555916355, 0.4198620983247112, 0.706683367853416, 1.0, 0.6831272555916355, 0.6831272555916355]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 19.0]) == [0.0, 0.06492479134286995, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -9.66675615633341, -0.1, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.033660994309756595, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 3.0, 4.0, 6.0, 3.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857, 0.5714285714285714]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0, 6.0, 4.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.6428571428571429]
    @test rescale_to_unit([-3.0, 1.4117100309373578, -2.37372058193593, -1.2, 0.0, 1.3, 2.6, -1.2]) == [0.0, 0.7878053626673853, 0.1118356103685839, 0.32142857142857145, 0.5357142857142857, 0.7678571428571429, 1.0, 0.32142857142857145]
    @test rescale_to_unit([-100000.0, 5.0, -1.2, 11.0, 17.0, 19.0, 11.0, 11.0, 17.0, 19.0]) == [0.0, 0.999860026594947, 0.9997980383727092, 0.9999200151971126, 0.9999800037992781, 1.0, 0.9999200151971126, 0.9999200151971126, 0.9999800037992781, 1.0]
    @test rescale_to_unit([2.0, 2.0, 4.046541901582966, 3.0, -100000.0, 3.458912167325974, 3.0, 4.0, 1.2451826892610212, 4.0, 4.0, 4.0]) == [0.9999795354090925, 0.9999795354090925, 1.0, 0.9999895350044546, 0.0, 0.9999941239404346, 0.9999895350044546, 0.9999995345998168, 0.9999719875414127, 0.9999995345998168, 0.9999995345998168, 0.9999995345998168]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 16.290878548158467, 15.0, 5.0e-9, 17.0, 19.0, 9.0, 19.0]) == [0.6, 0.0, 0.3, 0.4, 0.5, 0.18, 0.6, 0.7, 0.8645439274079234, 0.8, 0.050000000249999996, 0.9, 1.0, 0.5, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.1, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 1.0, 1.0]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, 0.0, 11.0]) == [1.0, 0.09147524010848404, 0.0, 0.09966014785525446, 0.20606394856326984, 0.31246774927128523, 0.09966014785525446, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 1.46050216156186, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 3.0, 4.0]) == [0.21244272401899175, 0.21244272401899175, 0.6062213620094958, 0.6062213620094958, 0.0, 0.6062213620094958, 1.0, 1.0, 1.0, 1.0, 0.21244272401899175, 1.0, 0.6062213620094958, 1.0]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 2.071031386145096, 5.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.14490597207834932, 0.2831087420312734]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.970622647728508, 4.0, 4.0, 4.0, 4.0, -100000.0]) == [0.9999702952500338, 0.9999702952500338, 0.9999802947529962, 0.9999802947529962, 0.9999802947529962, 1.0, 0.9999902942559586, 0.9999902942559586, 0.9999902942559586, 0.9999902942559586, 0.0]
    @test rescale_to_unit([-5.0, 1.0, 2.0, 2.0, 3.0, 4.0, 2.492199888107555]) == [0.0, 0.6666666666666666, 0.7777777777777778, 0.7777777777777778, 0.8888888888888888, 1.0, 0.8324666542341728]
    @test rescale_to_unit([0.0, 0.0, 1.0932387793203828, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9147132528738643, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, 19.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([-10.0, 2.0, -1.0, -0.6513673284956263, -0.1]) == [0.0, 1.0, 0.75, 0.7790527226253645, 0.8250000000000001]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 0.8986163754356359, 19.0]) == [0.0, 0.06492479134286995, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 0.08509444398719732, 1.0]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 13.0, 15.0, 17.0, 19.0, 5.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 0.3]
    @test rescale_to_unit([1.2451826892610212, 2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.5000062259134463, 0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-5.0, 10.401137390833725, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6]) == [0.0, 1.0, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.4194821458710542, 0.49347004751241824]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([7.0, -2.37372058193593, 9.0, -1.2400220924963046, -5.0, 3.0, 4.0, 6.0]) == [0.8571428571428571, 0.18759138700457642, 1.0, 0.26856985053597826, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999400113978344, 0.9999400113978344]
    @test rescale_to_unit([2.0, 2.0, 3.0, -1.0, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.499995, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 13.0, 17.0, 19.0, -1.2176086883151271]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9997978623192763]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999980002599662, 1.0]
    @test rescale_to_unit([-1.0, -5.5, 4.769631488983501, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, -1.0, 10.151375828019562]) == [0.1836734693877551, 0.0, 0.4191686322034082, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.1836734693877551, 0.6388316664497781]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 2.6]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.16986524521876406]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 0.8986163754356359, 19.0, 0.8986163754356359]) == [0.0, 0.06492479134286995, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 0.08509444398719732, 1.0, 0.08509444398719732]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 9.883843909648547, 17.0, 19.0, -1.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999088557565027, 0.9999800037992781, 1.0, 0.9998000379927814]
    @test rescale_to_unit([-10.0, -5.5, -100000.0, -1.0, -0.5, -9.66675615633341, -0.1, -0.12405312115430803]) == [0.999900999901, 0.999945999946, 0.0, 0.999990999991, 0.9999959999960001, 0.999904332342769, 1.0, 0.999999759468548]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0, 6.0, 4.0, 4.0, 4.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.6428571428571429, 0.6428571428571429, 0.6428571428571429]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 9.0, 11.0, 13.0, 17.0, 19.0, -100000.0]) == [0.0, 0.999894247490881, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -6.434931263616406, 2.0, 4.0, 6.0, 6.0]) == [0.8704237831810467, 0.6112713495431401, 1.0, 0.3521189159052336, 0.0, 0.5464832411336635, 0.6760594579526168, 0.80563567477157, 0.80563567477157]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 1.0]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, -3.0]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 0.7678571428571429, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0, 9.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999400113978344, 0.9999000189963907]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 19.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, 17.0, 19.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0, 3.0]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.3366882060383285, 0.0, 0.2104301287739553, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033, 0.673376412076657]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 1.5222176980104452, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.5000076110884901, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([1.2451826892610212, 2.0, 2.0, 3.0, 3.0, 3.0, 2.232577808710385, 4.0, 4.0, 4.0, 100000.0, 1.8392488338004267, -100000.0]) == [0.5000062259134463, 0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.5000111628890436, 0.50002, 0.50002, 0.50002, 1.0, 0.500009196244169, 0.0]
    @test rescale_to_unit([2.0, 10.401137390833725, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 100000.0]) == [3.2175695109092095e-5, 0.0001161860461000966, 0.0, 2.116199296724264e-5, 2.6780782413636407e-5, 1.0]
    @test rescale_to_unit([7.0, -2.37372058193593, 9.0, -1.2400220924963046, -5.0, 3.0, 4.0, 6.0, 7.0]) == [0.8571428571428571, 0.18759138700457642, 1.0, 0.26856985053597826, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857, 0.8571428571428571]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, -5.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 2.071031386145096, 5.0, -1.0, 20.193269967400774]) == [0.6350902451608486, 0.15877256129021214, 0.39693140322553033, 0.4763176838706364, 0.5557039645157424, 0.0, 0.7144765258059546, 0.7938628064510607, 0.19846570181123088, 0.8732490870961668, 1.0, 0.9526353677412728, 0.28067144103543396, 0.39693140322553033, 0.15877256129021214, 1.0]
    @test rescale_to_unit([7.0, 3.0, 5.486580591351534, -1.2400220924963046, -5.0, 3.0, 4.0, 6.0]) == [1.0, 0.6666666666666666, 0.8738817159459611, 0.3133314922919746, 0.0, 0.6666666666666666, 0.75, 0.9166666666666666]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 9.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.4718479033854557, 0.660587064739638, 0.7549566454167291, 0.8493262260938202, 1.0, 0.9436958067709114]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 19.0]) == [0.0, 0.5653842082082107, 0.1525173964046947, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.668187470225369, 0.21450051004382137, 0.8989131908379384, 1.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.499560300532895, 0.0, 0.0, 0.0, 9.883843909648547, 1.0, 0.0]) == [0.0, 0.0, 0.0, 0.05054311916492604, 0.0, 0.0, 0.0, 1.0, 0.10117521170319234, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 1.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271]) == [0.50001, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846]
    @test rescale_to_unit([-1.0, -5.5, 4.769631488983501, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 10.151375828019562, 17.0, 19.0, -1.0, 10.151375828019562]) == [0.1836734693877551, 0.0, 0.4191686322034082, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.6388316664497781, 0.9183673469387755, 1.0, 0.1836734693877551, 0.6388316664497781]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 17.725302075603715, 15.0, 17.0, 19.0, 5.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.3, 0.9362651037801857, 0.8, 0.9, 1.0, 0.3]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 2.071031386145096, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0]) == [0.0, 0.3, 0.4, 0.5, 0.1535515693072548, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 9.0, 2.0, 4.0, 6.0, 6.0, 4.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 1.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.6428571428571429]
    @test rescale_to_unit([-5.0, 4.769631488983501, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0]) == [0.0, 0.6978308206416787, 0.2857142857142857, 0.42857142857142855, 0.5714285714285714, 0.7142857142857143, 0.8571428571428571, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.906463496197338, 4.0, 4.0, -87387.4823957305, 100000.0, -100000.0, 100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.500024532317481, 0.50002, 0.50002, 0.06306258802134747, 1.0, 0.0, 1.0]
    @test rescale_to_unit([0.0, 0.4269239279743262, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]) == [0.0, 0.4269239279743262, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
    @test rescale_to_unit([-88211.32021789154, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0]) == [0.0, 0.9998801176264185, 0.999841324388652, 0.9998866602776086, 0.9999093282220869, 0.9999319961665651, 0.9999773320555218, 1.0, 0.9997903165300344, 0.9999319961665651]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.5]
    @test rescale_to_unit([-0.9741314779560433, 7.0, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0]) == [0.28756203728885404, 0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.2176086883151271, 1.0, 0.0, 0.0]) == [0.5490638157808762, 0.5490638157808762, 0.5490638157808762, 0.5490638157808762, 0.5490638157808762, 0.5490638157808762, 0.0, 1.0, 0.5490638157808762, 0.5490638157808762]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 11.324887692190664, 17.0, 19.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999232634568651, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 19.0, 3.458912167325974]) == [0.0, 0.5653842082082107, 0.1525173964046947, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.668187470225369, 0.21450051004382137, 0.8989131908379384, 1.0, 0.21450051004382137]
    @test rescale_to_unit([-5.0, 10.401137390833725, -0.1, -1.2176086883151271, 0.8986163754356359, 2.6]) == [0.0, 1.0, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.49347004751241824]
    @test rescale_to_unit([-10.0, -5.5, -100000.0, -1.0, -0.5, -0.1, 4.970622647728508, 4.970622647728508]) == [0.9998503012144845, 0.9998952989778155, 0.0, 0.9999402967411464, 0.9999452964926276, 0.9999492962938126, 1.0, 1.0]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 2.071031386145096, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, -1.0]) == [0.0, 0.3, 0.4, 0.5, 0.1535515693072548, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0, 0.0]
    @test rescale_to_unit([-10.0, -5.5, -100000.0, -1.0, -0.5, -9.66675615633341, -0.1, -0.12405312115430803, 4.769631488983501, -0.5]) == [0.9998523107293442, 0.9998973085831124, 0.0, 0.9999423064368806, 0.9999473061984104, 0.9998556430088433, 0.9999513060076342, 0.9999510654878946, 1.0, 0.9999473061984104]
    @test rescale_to_unit([2.0, 2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0]) == [0.50001, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002]
    @test rescale_to_unit([2.0, 3.0, 3.0, 1.5222176980104452, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.500015, 0.500015, 0.5000076110884901, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([7.0, 2.258580593854103, 12.527987311788877, -1.0, -5.0, 1.9850204264692954, 6.0]) == [0.6846193910654594, 0.41411375218032975, 1.0, 0.2282064636884865, 0.0, 0.3985067025791004, 0.6275677751433378]
    @test rescale_to_unit([2.0, 2.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, 4.0]) == [0.50001, 0.50001, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.50002]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 2.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50001]
    @test rescale_to_unit([7.0, 3.0, 9.0, 0.4269239279743262, -5.0, 3.0, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.38763742342673757, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, 19.0, 8.422739790413504]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 1.0, 0.999894247490881]
    @test rescale_to_unit([7.0, -2.37372058193593, 9.0, -1.2400220924963046, -10.0, -5.0, 3.0, 4.0, 6.0]) == [0.8947368421052632, 0.40138312726652997, 1.0, 0.461051468815984, 0.0, 0.2631578947368421, 0.6842105263157895, 0.7368421052631579, 0.8421052631578947]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, -3.0, 1.3]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 0.7678571428571429, 1.0, 0.0, 0.7678571428571429]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 11.0, 5.0, 13.0, 15.0, 17.0, 18.55562594891745]) == [0.18706642718654798, 0.0, 0.5196289644070777, 0.6859102330173426, 0.43648833010194527, 0.769050867322475, 0.8521915016276075, 0.9353321359327399, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -147046.595120599, 19.0, 19.0]) == [0.3199021163448808, 0.9999280779423568, 0.9999048043834554, 0.9999456025048317, 0.9999592018786237, 0.999833407671047, 1.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, 0.4269239279743262, -5.0, 3.0, 4.0, -5.392186064112541, 6.0]) == [0.8610357042988017, 0.5831071128964052, 1.0, 0.40432426082907846, 0.02724993009161211, 0.5831071128964052, 0.6525892607470043, 0.0, 0.7915535564482026]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.322975733592047, 0.4269239279743262, -5.0, 3.0, 4.0, 6.0, 9.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.45164112382800337, 0.38763742342673757, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857, 1.0]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 13.0, -116505.32195163157, 17.0]) == [0.14164944257189566, 0.9998970154404837, 0.9999313436269892, 0.9999485077202419, 0.9999656718134946, 0.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -5.0, 3.0, 4.0, 6.0, 3.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857, 0.5714285714285714]
    @test rescale_to_unit([2.0, 2.0, 3.562048029970825, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0]) == [0.0, 0.0, 0.7810240149854124, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 6.0]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.5833333333333334, 0.9166666666666666]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 13.0, 12.435097367794613, 17.725302075603715, 17.0, 19.0, 3.458912167325974]) == [0.0, 0.5653842082082107, 0.1525173964046947, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.668187470225369, 0.9355724270886383, 0.8989131908379384, 1.0, 0.21450051004382137]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 11.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.5662174840625468]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.626959923143518, 4.0]) == [0.0, 0.0, 0.5, 0.813479961571759, 1.0]
    @test rescale_to_unit([-1.2176086883151271, -0.5899488856573549, -3.0, -2.5, -1.2, 0.0, 1.3, 2.6]) == [0.3182841628008702, 0.4303662704183295, 0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.7678571428571429, 1.0]
    @test rescale_to_unit([9.0, -1.2400220924963046, 3.0, 4.0, 6.0]) == [1.0, 0.0, 0.41406376414005136, 0.5117198034500428, 0.7070318820700258]
    @test rescale_to_unit([-100000.0, 8.422739790413504, -88211.32021789154, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0]) == [0.0, 0.999894247490881, 0.11786440358440359, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 13.0, 17.0, 19.0, -1.9494985562533456]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9997905448109234]
    @test rescale_to_unit([7.0, 9.0, -1.0, -5.0, 2.0, 4.0, 9.294663202788586, 6.0]) == [0.8394741330917859, 0.9793864886070835, 0.2798247110305953, 0.0, 0.4896932443035418, 0.6296055998188395, 1.0, 0.7695179553341371]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, -100000.0, 19.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 19.0, 3.0, 4.0, 6.0, 3.0]) == [0.4, 0.2, 0.5, 0.0, 1.0, 0.2, 0.25, 0.35, 0.2]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, -5.5, 19.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 0.9997550465411572, 1.0]
    @test rescale_to_unit([7.0, 3.0, 3.0, 9.0, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.17857142857142858, 0.5, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-100000.0, 19.41864539875061, 5.0, 9.0, 11.0, 11.029460583547525, 17.0, 19.0]) == [0.0, 1.0, 0.9998558415396327, 0.9998958337736826, 0.9999158298907076, 0.9999161244393457, 0.9999758182417824, 0.9999958143588074]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, 12.435097367794613, -2.5, 2.0, 4.0, 6.0, 3.0]) == [0.1433889325228488, 0.4588445840731161, 0.6814087571883665, 0.22942229203655806, 0.0, 1.0, 0.1433889325228488, 0.4014890110639766, 0.5162001570822556, 0.6309113031005347, 0.4588445840731161]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0, 11.0, 17.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.8493262260938202, 1.0, 0.9436958067709114, 0.5662174840625468, 0.8493262260938202]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, -1.9494985562533456, 2.0, 4.0, 6.0, 3.0]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.3366882060383285, 0.0, 0.2104301287739553, 0.256766964653098, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033, 0.673376412076657]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 17.725302075603715]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.999987255442222]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 16.290878548158467, 15.0, 3.6477041535209116, 5.0e-9, 17.0, 19.0, 9.0, 19.0]) == [0.6, 0.0, 0.3, 0.4, 0.5, 0.18, 0.6, 0.7, 0.8645439274079234, 0.8, 0.2323852076760456, 0.050000000249999996, 0.9, 1.0, 0.5, 1.0]
    @test rescale_to_unit([7.0, 19.41864539875061, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.49142775137780514, 1.0, 0.3276185009185368, 0.48653100263518106, 0.1638092504592684, 0.0, 0.10238078153704273, 0.28666618830371965, 0.36857081353335386, 0.45047543876298807]
    @test rescale_to_unit([7.0, 19.41864539875061, 3.0, 3.562048029970825, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.49142775137780514, 1.0, 0.3276185009185368, 0.3506356675464441, 0.1638092504592684, 0.0, 0.10238078153704273, 0.28666618830371965, 0.36857081353335386, 0.45047543876298807]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 9.0, 6.822138554696681, 5.0, 13.0, 15.0, 17.0, 19.0, 5.0]) == [0.1836734693877551, 0.0, 0.5102040816326531, 0.5918367346938775, 0.5029444308039462, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.42857142857142855]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -5.0]) == [0.0, 0.5, 1.0, 0.5555555555555556]
    @test rescale_to_unit([-10.0, -5.5, -1.0, 2.0, -0.1, 2.0]) == [0.0, 0.375, 0.75, 1.0, 0.8250000000000001, 1.0]
    @test rescale_to_unit([-3.913461319358456, -10.0, -5.5, -1.0, -9.66675615633341, -0.1, -0.1, -3.913461319358456]) == [0.6148018869334892, 0.0, 0.45454545454545453, 0.9090909090909091, 0.033660994309756595, 1.0, 1.0, 0.6148018869334892]
    @test rescale_to_unit([5.0, 9.0, 11.0, 11.029460583547525, 18.149298285479812, 19.0]) == [0.0, 0.2857142857142857, 0.42857142857142855, 0.4306757559676804, 0.9392355918199866, 1.0]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, 0.0, 100000.0, 11.0]) == [0.0001221745992746156, 1.1175950803803282e-5, 0.0, 1.2175938627864655e-5, 2.5175780340662495e-5, 3.8175622053460336e-5, 1.2175938627864655e-5, 1.0, 0.0001221745992746156]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 17.0, 19.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.9183673469387755, 1.0]
    @test rescale_to_unit([-87387.4823957305, 3.0, 9.0, -1.0, -5.0, 3.0, 4.0, 3.0]) == [0.0, 0.9999313473513404, 1.0, 0.9998855789189006, 0.9998398104864609, 0.9999313473513404, 0.9999427894594504, 0.9999313473513404]
    @test rescale_to_unit([7.0, 9.0, -1.0, -5.0, 9.0, 2.0, 4.0, 6.0, 6.0, 4.0, 2.0]) == [0.8571428571428571, 1.0, 0.2857142857142857, 0.0, 1.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.6428571428571429, 0.5]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.322975733592047, 0.4269239279743262, 2.0, -5.0, 3.0, 4.0, 6.0, 9.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.45164112382800337, 0.38763742342673757, 0.5, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, 1.2451826892610212, -0.1]) == [0.0, 0.40017135553497335, 0.8003427110699467, 1.0, 0.8803769821769414]
    @test rescale_to_unit([-10.0, -0.11712437774261075, -5.5, -1.1252324395847113, -0.5, -0.1, -0.1]) == [0.0, 0.9982702648744837, 0.45454545454545453, 0.8964411677187161, 0.9595959595959596, 1.0, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 19.0, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 1.0, 0.9999400113978344]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.322975733592047, 0.4269239279743262, 2.0, -5.0, 3.3850444114672107, 4.0, 6.0, 9.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.45164112382800337, 0.38763742342673757, 0.5, 0.0, 0.5989317436762294, 0.6428571428571429, 0.7857142857142857, 1.0]
    @test rescale_to_unit([2.0, 3.0, 4.0, 4.0, 4.0]) == [0.0, 0.5, 1.0, 1.0, 1.0]
    @test rescale_to_unit([2.258580593854103, 12.527987311788877, -1.0, -5.0, 1.9850204264692954, 6.0]) == [0.41411375218032975, 1.0, 0.2282064636884865, 0.0, 0.3985067025791004, 0.6275677751433378]
    @test rescale_to_unit([-1.0, 18.803842168566185, 5.0, 7.0, 2.071031386145096, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 1.46050216156186]) == [0.0, 0.9901921084283092, 0.3, 0.4, 0.1535515693072548, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0, 0.123025108078093]
    @test rescale_to_unit([-10.0, -5.5, -1.5661416747342105, -0.5, -0.1, -0.1, -0.5, -5.5]) == [0.0, 0.45454545454545453, 0.8519048813399788, 0.9595959595959596, 1.0, 1.0, 0.9595959595959596, 0.45454545454545453]
    @test rescale_to_unit([-5.0, 10.401137390833725, 4.0, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6]) == [0.0, 1.0, 0.5843724246857585, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.4194821458710542, 0.49347004751241824]
    @test rescale_to_unit([2.0, 2.0, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, 4.0]) == [0.50001, 0.50001, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.50002]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -0.1, -0.5]) == [0.0, 0.45454545454545453, 0.9090909090909091, 0.9595959595959596, 1.0, 0.9595959595959596]
    @test rescale_to_unit([-1.0, 18.803842168566185, 5.0, 7.0, 2.071031386145096, -0.5, 5.0, 13.0, 15.0, 17.0, 19.0, 1.46050216156186]) == [0.0, 0.9901921084283092, 0.3, 0.4, 0.1535515693072548, 0.025, 0.3, 0.7, 0.8, 0.9, 1.0, 0.123025108078093]
    @test rescale_to_unit([-3.9976986611875804, 10.401137390833725, 4.0, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6]) == [0.0, 1.0, 0.5554406364717838, 0.2706953983714831, 0.1930774100648354, 0.3400493636383805, 0.3790723641153772, 0.4582105551692421]
    @test rescale_to_unit([-10.0, -5.5, 4.906463496197338, -0.1]) == [0.0, 0.3018824687121769, 1.0, 0.6641414311667893]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0, 11.0, 17.0, 7.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.8493262260938202, 1.0, 0.9436958067709114, 0.5662174840625468, 0.8493262260938202, 0.37747832270836457]
    @test rescale_to_unit([10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 10.282719410300084, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 19.0]) == [0.4871684799805879, 0.0, 0.3996042914800858, 0.5228843224240002, 0.48010609560315165, 0.6421632418180001, 0.6084727540518577, 0.07313791855570075, 0.8807210806060001, 1.0]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.8340070003829894, 10.31652351054666, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 2.071031386145096, 5.0, 7.0]) == [0.5662174840625468, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.18090681646958737, 0.5339677892063658, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.14490597207834932, 0.2831087420312734, 0.37747832270836457]
    @test rescale_to_unit([-10.0, -9.194474676157663, -5.5, -1.0, -9.66675615633341, -0.1, -0.1]) == [0.0, 0.0813661943275088, 0.45454545454545453, 0.9090909090909091, 0.033660994309756595, 1.0, 1.0]
    @test rescale_to_unit([18.149298285479812, 2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, -1.2176086883151271]) == [0.5000907464914274, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.49999391195655846]
    @test rescale_to_unit([7.0, 3.0, 5.486580591351534, -1.2400220924963046, 3.0, 4.0, 4.006918996620226, 6.0]) == [1.0, 0.514564408311167, 0.8163330884723421, 0.0, 0.514564408311167, 0.6359233062333752, 0.6367629880379334, 0.8786411020777918]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -99999.35396643436, 19.0, 19.0, 8.004448108665093]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 6.459108425846658e-6, 1.0, 1.0, 0.9998900653686666]
    @test rescale_to_unit([5.0, 9.0, 11.0, 10.971192509868965, 18.149298285479812, 19.0]) == [0.0, 0.2857142857142857, 0.42857142857142855, 0.4265137507049261, 0.9392355918199866, 1.0]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 3.562048029970825, 13.0, -6.434931263616406, 15.0, 17.0, 19.0, -1.0, 11.0]) == [0.21367980936480238, 0.03675776647188292, 0.4495758665553617, 0.5282078856188814, 0.6068399046824012, 0.6854719237459209, 0.4495758665553617, 0.39304133319548173, 0.7641039428094407, 0.0, 0.8427359618729605, 0.9213679809364802, 1.0, 0.21367980936480238, 0.6854719237459209]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, -5.5, 19.0, -5.5]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 0.9997550465411572, 1.0, 0.9997550465411572]
    @test rescale_to_unit([2.0, 2.0, 3.562048029970825, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 2.0, 4.0]) == [0.0, 0.0, 0.7810240149854124, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0]
    @test rescale_to_unit([-5.0, 1.0, 2.0, 2.0, 4.0, 2.492199888107555]) == [0.0, 0.6666666666666666, 0.7777777777777778, 0.7777777777777778, 1.0, 0.8324666542341728]
    @test rescale_to_unit([-1.0, 1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 5.0]) == [0.0, 0.1, 0.3, 0.4, 0.5, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0, 0.3]
    @test rescale_to_unit([-10.0, -0.11712437774261075, -5.5, -1.1252324395847113, -0.1716125073528473, -0.5, -0.1, -0.1]) == [0.0, 0.9982702648744837, 0.45454545454545453, 0.8964411677187161, 0.9927664133987022, 0.9595959595959596, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0, 6.0]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.5833333333333334, 0.75, 0.9166666666666666, 0.9166666666666666]
    @test rescale_to_unit([-0.7849750781391729, 15.73361557746605, 0.499560300532895, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 19.0, -0.7849750781391729, 11.0]) == [0.0, 0.8349058106146898, 0.06492479134286995, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 1.0, 0.0, 0.5956527633517534]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 13.0, 3.626959923143518, -87387.4823957305]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999960005199324, 1.0, 0.9999062817825998, 0.12610878190104782]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 17.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.9183673469387755]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, 12.751538518728971, -2.5, 2.0, 4.0, 6.0, 3.0]) == [0.14083286343672946, 0.4506651629975343, 0.6692618792626058, 0.22533258149876714, 0.0, 1.0, 0.14083286343672946, 0.3943320176228425, 0.506998308372226, 0.6196645991216096, 0.4506651629975343]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, 2.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 1.000020000400008e-5, 1.000020000400008e-5, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5, 1.0, 0.0, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 3.562048029970825, 13.0, -6.434931263616406, 15.0, 17.0, 19.0, 11.0]) == [0.21367980936480238, 0.03675776647188292, 0.4495758665553617, 0.5282078856188814, 0.6068399046824012, 0.6854719237459209, 0.4495758665553617, 0.39304133319548173, 0.7641039428094407, 0.0, 0.8427359618729605, 0.9213679809364802, 1.0, 0.6854719237459209]
    @test rescale_to_unit([2.258580593854103, -1.0, -5.0, 1.9850204264692954, 6.0]) == [0.6598709630776457, 0.36363636363636365, 0.0, 0.6350018569517542, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 5.234060683691759, 2.0, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.3092087928475343, 0.3092087928475343, 0.3092087928475343, 0.6184175856950686, 0.6184175856950686, 0.6184175856950686, 1.0, 0.0, 0.6184175856950686, 0.6184175856950686, 0.3092087928475343]
    @test rescale_to_unit([3.3850444114672107, 7.0, 3.0, 9.0, 0.4269239279743262, -5.0, 3.0, 4.0, -5.392186064112541, 6.0]) == [0.6098608256230169, 0.8610357042988017, 0.5831071128964052, 1.0, 0.40432426082907846, 0.02724993009161211, 0.5831071128964052, 0.6525892607470043, 0.0, 0.7915535564482026]
    @test rescale_to_unit([0.3815710434538918, -10.0, -5.5, -1.0, -0.5, -0.1, -1.0]) == [1.0, 0.0, 0.4334604060565071, 0.8669208121130142, 0.915083079452626, 0.9536128933243156, 0.8669208121130142]
    @test rescale_to_unit([-10.0, -6.022656626008542, -1.0, 1.2451826892610212, -0.1, 1.2451826892610212]) == [0.0, 0.3536930865329347, 0.8003427110699467, 1.0, 0.8803769821769414, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 9.0, 9.294663202788586, 8.422739790413504]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999960005199324, 0.999980002599662, 1.0, 0.999960005199324, 0.9999629514483396, 0.9999542333475689]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 17.0, 19.0, -99999.35396643436, 17.725302075603715]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 6.459108425846658e-6, 0.999987255442222]
    @test rescale_to_unit([24.263901532923043, 9.0, 11.0, 10.971192509868965, 18.149298285479812, 16.116478869765537, 19.0]) == [1.0, 0.0, 0.13102809892255635, 0.12914080358925645, 0.599407580410912, 0.4662293486639604, 0.6551404946127818]
    @test rescale_to_unit([-100000.0, 19.41864539875061, 5.0, 9.0, 11.0, 17.0, 15.0, -100000.0]) == [0.0, 1.0, 0.9998558415396327, 0.9998958337736826, 0.9999158298907076, 0.9999758182417824, 0.9999558221247574, 0.0]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 8.873088049958566, 19.0]) == [0.0, 0.5653842082082107, 0.1525173964046947, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.668187470225369, 0.21450051004382137, 0.8989131908379384, 0.4881513921525801, 1.0]
    @test rescale_to_unit([2.0, 10.401137390833725, -1.0858890328967417, 0.8986163754356359, 1.46050216156186, 100000.0]) == [3.085855523930036e-5, 0.00011486901688724808, 0.0, 1.9844838590397926e-5, 2.5463635437761423e-5, 1.0]
    @test rescale_to_unit([2.232577808710385, 2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.514661959966183, 2.0]) == [0.5000111628890436, 0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.5000225733097998, 0.50001]
    @test rescale_to_unit([6.822138554696681, -5.0, 10.401137390833725, 4.0, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6]) == [0.7676146413532321, 0.0, 1.0, 0.5843724246857585, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.4194821458710542, 0.49347004751241824]
    @test rescale_to_unit([20.193269967400774, -116505.32195163157, -100000.0, 5.0, 9.0, 11.0, 13.0, 17.0, 1.46050216156186, -100000.0, 19.0]) == [1.0, 0.0, 0.14164556080479937, 0.999869614221928, 0.9999039414677025, 0.9999211050905896, 0.9999382687134768, 0.9999725959592513, 0.9998392389188735, 0.14164556080479937, 0.9999897595821384]
    @test rescale_to_unit([5.0, 11.324887692190664, 9.0, 11.0, 10.971192509868965, 18.149298285479812, 19.0]) == [0.0, 0.4517776922993332, 0.2857142857142857, 0.42857142857142855, 0.4265137507049261, 0.9392355918199866, 1.0]
    @test rescale_to_unit([-88211.32021789154, 8.422739790413504, 5.0, 7.295974043936857, 9.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.0]) == [0.0, 0.9998801176264185, 0.999841324388652, 0.9998673468947279, 0.9998866602776086, 0.9999093282220869, 0.9999319961665651, 0.9999773320555218, 1.0, 0.9997903165300344, 0.9999319961665651]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 6.887143430238047, 13.0, 17.0, 19.0, 0.499560300532895, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.999878894444358, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999400113978344]
    @test rescale_to_unit([10.971192509868965, 2.0, 10.401137390833725, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 100000.0]) == [0.00012188652788088757, 3.2175695109092095e-5, 0.0001161860461000966, 0.0, 2.116199296724264e-5, 2.6780782413636407e-5, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -100000.0, -1.0, -0.09622505532175613, -0.5, -9.66675615633341, -0.1, -0.1, -1.0, -0.1]) == [0.999900962155254, 0.9999459621985554, 0.0, 0.9999909622418567, 1.0, 0.999995962246668, 0.9999042945968973, 0.9999999622505169, 0.9999999622505169, 0.9999909622418567, 0.9999999622505169]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, -5.5, 19.0, -5.5]) == [0.0, 0.999894247490881, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 0.9997550465411572, 1.0, 0.9997550465411572]
    @test rescale_to_unit([-100000.0, 6.361720364471644, 5.0, 13.0, 19.0, -1.9494985562533456]) == [0.0, 0.9998736412118144, 0.999860026594947, 0.9999400113978344, 1.0, 0.9997905448109234]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0]) == [0.50001, 0.50001, 0.500015, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002]
    @test rescale_to_unit([7.0, 19.41864539875061, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.707385811718033, 4.0, 6.0]) == [0.49142775137780514, 1.0, 0.3276185009185368, 0.48653100263518106, 0.1638092504592684, 0.0, 0.10238078153704273, 0.3156352732044827, 0.36857081353335386, 0.45047543876298807]
    @test rescale_to_unit([7.0, 3.0, 9.0, 0.4269239279743262, -5.0, 3.0, 2.492199888107555, -5.392186064112541, 6.0]) == [0.8610357042988017, 0.5831071128964052, 1.0, 0.40432426082907846, 0.02724993009161211, 0.5831071128964052, 0.5478240704433436, 0.0, 0.7915535564482026]
    @test rescale_to_unit([2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 3.6375526859691534, 4.0, 4.0, 4.0, 100000.0, -100000.0, 2.0, 100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.5000181877634298, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50001, 1.0]
    @test rescale_to_unit([-10.0, -9.194474676157663, -5.5, -1.0, -0.5, -0.7178865318555435, -0.1, -10.0, -10.0]) == [0.0, 0.0813661943275088, 0.45454545454545453, 0.9090909090909091, 0.9595959595959596, 0.9375872190044906, 1.0, 0.0, 0.0]
    @test rescale_to_unit([4.970622647728508, 7.0, 3.0, 6.822138554696681, 9.0, 0.4269239279743262, -5.0, 3.0, 4.0, 6.0]) == [0.7121873319806077, 0.8571428571428571, 0.5714285714285714, 0.8444384681926201, 1.0, 0.38763742342673757, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([2.0, -1.2176086883151271, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 3.0]) == [0.6166826376843831, 0.0, 0.8083413188421915, 0.8083413188421915, 0.8083413188421915, 1.0, 1.0, 1.0, 1.0, 0.6166826376843831, 1.0, 1.0, 0.8083413188421915]
    @test rescale_to_unit([10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 10.282719410300084, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 19.0, 2.232577808710385]) == [0.4871684799805879, 0.0, 0.3996042914800858, 0.5228843224240002, 0.48010609560315165, 0.6421632418180001, 0.6084727540518577, 0.07313791855570075, 0.8807210806060001, 1.0, 0.0]
    @test rescale_to_unit([-3.0, 7.295974043936857, -2.5, -1.2, 0.0, 1.3, 2.6]) == [0.0, 1.0, 0.04856267098832115, 0.17482561555795614, 0.2913760259299269, 0.4176389704995619, 0.5439019150691968]
    @test rescale_to_unit([-10.0, 9.0, -100000.0, -1.0, -0.5, -9.66675615633341, -0.1, -0.12405312115430803, 4.769631488983501, -0.5]) == [0.9998100170984612, 1.0, 0.0, 0.9999000089991901, 0.9999050085492306, 0.9998133492370053, 0.9999090081892629, 0.9999087676796973, 0.9999577001218788, 0.9999050085492306]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -100000.0]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999980002599662, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 20.193269967400774, 3.0, 4.0, 4.0, 4.0, 5.234060683691759, 2.0, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.054965380153860675, 0.054965380153860675, 1.0, 0.054965380153860675, 0.10993076030772135, 0.10993076030772135, 0.10993076030772135, 0.1777613749197721, 0.0, 0.10993076030772135, 0.10993076030772135, 0.054965380153860675]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 8.932911673408139, 11.98005133446692, 13.0, 15.0, 17.0, 0.8986163754356359, 19.0, 0.8986163754356359, 0.8986163754356359]) == [0.0, 0.06492479134286995, 0.4911750817560951, 0.6451878944598941, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 0.08509444398719732, 1.0, 0.08509444398719732, 0.08509444398719732]
    @test rescale_to_unit([11.0, 4.970622647728508, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 11.0]) == [0.5662174840625468, 0.28172257782364146, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.5662174840625468]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 1.5222176980104452, 4.0, 4.0, 5.0e-9, 4.0, 127422.41835526374, -100000.0]) == [0.4397191830217183, 0.4397191830217183, 0.4397235801256064, 0.4397235801256064, 0.4397170821633005, 0.4397279772294946, 0.4397279772294946, 0.439710388813964, 0.4397279772294946, 1.0, 0.0]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 10.151375828019562, 17.0, 19.0, -1.0, 10.151375828019562]) == [0.1836734693877551, 0.0, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.6388316664497781, 0.9183673469387755, 1.0, 0.1836734693877551, 0.6388316664497781]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 20.193269967400774, 3.0, 4.0, 4.0, 4.0, 5.234060683691759, 2.0, 4.0, 4.0, 3.0, 3.0]) == [0.0, 0.0, 0.054965380153860675, 0.054965380153860675, 1.0, 0.054965380153860675, 0.10993076030772135, 0.10993076030772135, 0.10993076030772135, 0.1777613749197721, 0.0, 0.10993076030772135, 0.10993076030772135, 0.054965380153860675, 0.054965380153860675]
    @test rescale_to_unit([-3.0, -0.1, 0.5283826421326979, -1.2176086883151271, 0.0, 2.6, -0.1]) == [0.0, 0.5178571428571429, 0.6300683289522675, 0.3182841628008702, 0.5357142857142857, 1.0, 0.5178571428571429]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.9325817584583431, 1.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.9325817584583431, 1.0, 1.0]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 13.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.7551020408163265]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 7.0, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 19.0, 15.0]) == [0.0, 0.06492479134286995, 0.3934791450276302, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 1.0, 0.7978263816758767]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.322975733592047, 0.4269239279743262, 2.0, -5.0, 3.3850444114672107, 4.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.45164112382800337, 0.38763742342673757, 0.5, 0.0, 0.5989317436762294, 0.6428571428571429, 0.7857142857142857]
    @test rescale_to_unit([-12.436351439193258, -3.0, 0.0, 5.0, 2.6]) == [0.0, 0.5411884173189077, 0.7132427608243173, 1.0, 0.8623565251956722]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.322975733592047, 0.4269239279743262, -5.0, 3.0, 3.4732209828361675, 4.0, 6.0, 9.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.45164112382800337, 0.38763742342673757, 0.0, 0.5714285714285714, 0.6052300702025833, 0.6428571428571429, 0.7857142857142857, 1.0]
    @test rescale_to_unit([2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, -100000.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, -5.5, -1.0858890328967417, -100000.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 0.9997550465411572, 0.9997991792656106, 0.0]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.690179826736281, 6.0]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.5833333333333334, 0.8075149855613567, 0.9166666666666666]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 8.722521795855851, 2.0, 4.0, 6.0, 6.0, 4.0, 4.0, 4.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.9801801282754179, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.6428571428571429, 0.6428571428571429, 0.6428571428571429]
    @test rescale_to_unit([-3.0, -0.1, 0.5283826421326979, -1.2176086883151271, 0.0, 2.6, -0.1, 0.5283826421326979]) == [0.0, 0.5178571428571429, 0.6300683289522675, 0.3182841628008702, 0.5357142857142857, 1.0, 0.5178571428571429, 0.6300683289522675]
    @test rescale_to_unit([11.0, 6.0, 5.0, 7.0, 9.0, -5.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 2.071031386145096, 5.0, -1.0, 20.193269967400774]) == [0.6350902451608486, 0.4366245435480834, 0.39693140322553033, 0.4763176838706364, 0.5557039645157424, 0.0, 0.7144765258059546, 0.7938628064510607, 0.19846570181123088, 0.8732490870961668, 1.0, 0.9526353677412728, 0.28067144103543396, 0.39693140322553033, 0.15877256129021214, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, 2.0, 3.0]) == [0.50001, 0.50001, 0.500015, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.50001, 0.500015]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 9.883843909648547, 17.0, 19.0, -1.0, 5.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999088557565027, 0.9999800037992781, 1.0, 0.9998000379927814, 0.999860026594947]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 9.0, 11.0, 13.0, 17.0, 19.0, -100000.0, 17.0]) == [0.0, 0.999894247490881, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0, 0.9999800037992781]
    @test rescale_to_unit([12.527987311788877, -10.0, -9.194474676157663, -5.5, -1.0, -0.5, -0.7178865318555435, -0.1, -10.0, -10.0]) == [1.0, 0.0, 0.035756648505426245, 0.19975153295852371, 0.39950306591704743, 0.42169768069021674, 0.4120258654126254, 0.4394533725087522, 0.0, 0.0]
    @test rescale_to_unit([11.0, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 16.290878548158467, 15.0, 5.0e-9, 17.0, 19.0, 9.0, 19.0, 7.0]) == [0.6, 0.0, 0.3, 0.4, 0.5, 0.18, 0.6, 0.7, 0.8645439274079234, 0.8, 0.050000000249999996, 0.9, 1.0, 0.5, 1.0, 0.4]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 8.932911673408139, 9.270697628078713, 11.0, 13.0, 15.0, 17.0, 0.8986163754356359, 19.0]) == [0.0, 0.06492479134286995, 0.4911750817560951, 0.5082479339247996, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 0.08509444398719732, 1.0]
    @test rescale_to_unit([10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 19.0]) == [0.4871684799805879, 0.0, 0.3996042914800858, 0.5228843224240002, 0.6421632418180001, 0.6084727540518577, 0.07313791855570075, 0.8807210806060001, 1.0]
    @test rescale_to_unit([7.0, 19.41864539875061, 3.0, 6.880428028847085, -1.0, -0.09622505532175613, -2.5, 2.0, 4.0, 6.0]) == [0.43342094491576166, 1.0, 0.2509279154775462, 0.42796568210286307, 0.06843488603933079, 0.10966804293550286, 0.0, 0.20530465811799237, 0.2965511728371001, 0.3877976875562078]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.970622647728508, 1.631962701646998, 4.0, 0.8986163754356359, 4.0, 4.0, -100000.0]) == [0.9999702952500338, 0.9999702952500338, 0.9999802947529962, 0.9999802947529962, 0.9999802947529962, 1.0, 0.9999666150599786, 0.9999902942559586, 0.9999592819612171, 0.9999902942559586, 0.9999902942559586, 0.0]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 13.0, -155640.12451219512, 17.0]) == [0.35745311810533886, 0.9999229074799011, 0.9999486049866007, 0.9999614537399505, 0.9999743024933003, 0.0, 1.0]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.707385811718033, 1.3]) == [0.0, 0.50811353843399, 0.3122955711221384, 0.5256346949317138, 0.753409729402123, 1.0, 0.753409729402123]
    @test rescale_to_unit([-2.5, 9.0, 3.0, 6.880428028847085, 10.971192509868965, -5.0, 12.751538518728971, -2.5, 2.0, 4.0, 6.0, 3.0]) == [0.14083286343672946, 0.788664035245685, 0.4506651629975343, 0.6692618792626058, 0.8997075094656369, 0.0, 1.0, 0.14083286343672946, 0.3943320176228425, 0.506998308372226, 0.6196645991216096, 0.4506651629975343]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, 19.0, 8.422739790413504, -5.5]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 1.0, 0.999894247490881, 0.9997550465411572]
    @test rescale_to_unit([2.0, 2.0, 4.046541901582966, 3.0, -100000.0, 3.0, 2.2157899019980976, 4.0, 1.2451826892610212, 4.0, 4.0, 4.0]) == [0.9999795354090925, 0.9999795354090925, 1.0, 0.9999895350044546, 0.0, 0.9999895350044546, 0.9999816932207957, 0.9999995345998168, 0.9999719875414127, 0.9999995345998168, 0.9999995345998168, 0.9999995345998168]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.970622647728508, 1.631962701646998, 16.290878548158467, 4.0, 0.8986163754356359, 4.0, 4.0, -100000.0, 0.8986163754356359]) == [0.999857114491823, 0.999857114491823, 0.9998671128630006, 0.9998671128630006, 0.9998671128630006, 0.9998868158796833, 0.999853434718307, 1.0, 0.999877111234178, 0.9998461024495358, 0.999877111234178, 0.999877111234178, 0.0, 0.9998461024495358]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.1, -0.1, -0.1, -0.1]) == [0.0, 0.45454545454545453, 0.9090909090909091, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([8.422739790413504, -88211.32021789154, 11.0, 13.0, -5.5, 20.193269967400774, 19.0, 19.0]) == [0.9998665949419693, 0.0, 0.9998958051425847, 0.9999184727804947, 0.9997087971298266, 1.0, 0.9999864756942249, 0.9999864756942249]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -9.66675615633341, -0.1, -0.12405312115430803, 4.769631488983501, -0.5, -10.0]) == [0.0, 0.30467923342274983, 0.6093584668454997, 0.643211715003583, 0.022562773073597202, 0.6702943135300496, 0.6686657609712231, 1.0, 0.643211715003583, 0.0]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 8.341045402099477, 9.0, 2.071031386145096, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, -1.0, 15.0]) == [0.0, 0.3, 0.4, 0.46705227010497385, 0.5, 0.1535515693072548, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0, 0.0, 0.8]
    @test rescale_to_unit([-0.9741314779560433, -5.5, 7.0, 9.0, 11.0, 5.0, 15.0, 17.0, 19.0, 11.0]) == [0.18472932743036558, 0.0, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.8367346938775511, 0.9183673469387755, 1.0, 0.673469387755102]
    @test rescale_to_unit([10.401137390833725, 2.232577808710385, 11.0, 10.282719410300084, 13.0, 6.887143430238047, 12.435097367794613, 3.458912167325974, 17.0, 19.0]) == [0.4871684799805879, 0.0, 0.5228843224240002, 0.48010609560315165, 0.6421632418180001, 0.27759577879214065, 0.6084727540518577, 0.07313791855570075, 0.8807210806060001, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, 0.4269239279743262, -5.0]) == [0.0, 0.4315750293264325, 0.863150058652865, 1.0, 0.47952781036270276]
    @test rescale_to_unit([-1.0, 18.803842168566185, 5.0, 7.0, 2.071031386145096, -0.5, 13.0, 15.0, 17.0, 19.0, 1.46050216156186]) == [0.0, 0.9901921084283092, 0.3, 0.4, 0.1535515693072548, 0.025, 0.7, 0.8, 0.9, 1.0, 0.123025108078093]
    @test rescale_to_unit([6.822138554696681, -5.0, 10.401137390833725, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6, 0.8986163754356359]) == [0.7676146413532321, 0.0, 1.0, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.4194821458710542, 0.49347004751241824, 0.38299875040049364]
    @test rescale_to_unit([-100000.0, 5.0, 7.295974043936857, 11.0, 17.0, 19.0, 6.718598622152663, 11.0, 17.0]) == [0.0, 0.999860026594947, 0.9998829819738644, 0.9999200151971126, 0.9999800037992781, 1.0, 0.9998772093164515, 0.9999200151971126, 0.9999800037992781]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 4.690179826736281, 6.0]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.8075149855613567, 0.9166666666666666]
    @test rescale_to_unit([3.0, -5.392186064112541, 6.822138554696681, -1.0, -5.0, -2.5, 4.046541901582966, 4.0, 6.0]) == [0.6870773723492782, 0.0, 1.0, 0.3595930353241861, 0.03210869829909393, 0.23678640893977654, 0.7727588925514974, 0.7689484566055513, 0.9326906251180974]
    @test rescale_to_unit([-3.0, -1.2176086883151271, 0.0, 1.3, 2.6, -3.0, 1.5688721641863903, 1.3]) == [0.0, 0.3182841628008702, 0.5357142857142857, 0.7678571428571429, 1.0, 0.0, 0.8158700293189983, 0.7678571428571429]
    @test rescale_to_unit([-100000.0, 5.0, 3.3850444114672107, 11.0, 13.0, -116505.32195163157, 17.0]) == [0.14164944257189566, 0.9998970154404837, 0.9998831558163235, 0.9999485077202419, 0.9999656718134946, 0.0, 1.0]
    @test rescale_to_unit([2.0, 10.401137390833725, -1.0858890328967417, 0.8986163754356359, 1.46050216156186, 100000.0, 2.0]) == [3.085855523930036e-5, 0.00011486901688724808, 0.0, 1.9844838590397926e-5, 2.5463635437761423e-5, 1.0, 3.085855523930036e-5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.906463496197338, 4.0, -87387.4823957305, 100000.0, -100000.0, 100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.500024532317481, 0.50002, 0.06306258802134747, 1.0, 0.0, 1.0]
    @test rescale_to_unit([2.258580593854103, 18.255935636763752, 20.193269967400774, -1.0, -5.0]) == [0.28811585805441126, 0.9231011165623253, 1.0, 0.15877256129021214, 0.0]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 4.690179826736281, 6.0, -5.0]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.8075149855613567, 0.9166666666666666, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 9.0, 11.0, 13.0, 17.0, 19.0, -100000.0, 2.2157899019980976, 17.0]) == [0.0, 0.999894247490881, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0, 0.9998321897829612, 0.9999800037992781]
    @test rescale_to_unit([-100000.0, 5.0, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, 19.0, 8.422739790413504]) == [0.0, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 1.0, 0.999894247490881]
    @test rescale_to_unit([2.258580593854103, 18.255935636763752, 20.193269967400774, -1.0, 6.361720364471644, -5.0, 18.255935636763752, 2.258580593854103]) == [0.28811585805441126, 0.9231011165623253, 1.0, 0.15877256129021214, 0.45098236073258136, 0.0, 0.9231011165623253, 0.28811585805441126]
    @test rescale_to_unit([7.0, 4.482372439717762, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0, 6.0, 4.0, 7.0]) == [0.8571428571428571, 0.6773123171226972, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.7857142857142857, 0.6428571428571429, 0.8571428571428571]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.23828023614698846, 1.0, 1.0, 0.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.23828023614698846, 1.0, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 4.336363527402568, 11.0, 13.0, -100000.0]) == [0.0, 0.9999542333475689, 0.9999133748965374, 0.999980002599662, 1.0, 0.0]
    @test rescale_to_unit([-5.0, -0.1, -1.2176086883151271, 0.8986163754356359, 2.6, -0.1, -1.2176086883151271]) == [0.0, 0.6447368421052633, 0.497683067326957, 0.7761337336099522, 1.0, 0.6447368421052633, 0.497683067326957]
    @test rescale_to_unit([7.0, 3.0, -1.0, -5.0, -2.5, 4.690179826736281, 6.0, -5.0]) == [1.0, 0.6666666666666666, 0.3333333333333333, 0.0, 0.20833333333333334, 0.8075149855613567, 0.9166666666666666, 0.0]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 9.0, 11.0, 5.0, 3.562048029970825, 13.0, 11.0, 15.0, 17.0, 19.0, -1.0, 11.0]) == [0.1836734693877551, 0.0, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.3698795114273806, 0.7551020408163265, 0.673469387755102, 0.8367346938775511, 0.9183673469387755, 1.0, 0.1836734693877551, 0.673469387755102]
    @test rescale_to_unit([-0.5, -2.37372058193593, 9.0, -1.2400220924963046, -10.0, -5.0, 3.0, 4.0, 6.0]) == [0.5, 0.40138312726652997, 1.0, 0.461051468815984, 0.0, 0.2631578947368421, 0.6842105263157895, 0.7368421052631579, 0.8421052631578947]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 3.0, 1.3, 4.690179826736281, 2.6]) == [0.0, 0.06501798543925603, 0.23406474758132173, 0.7802158252710724, 0.5591546747776018, 1.0, 0.7282014369196675]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.322975733592047, 0.4269239279743262, 2.0, -5.0, 3.0, 4.0, 6.0, 9.0, 9.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.45164112382800337, 0.38763742342673757, 0.5, 0.0, 0.5714285714285714, 0.6428571428571429, 0.7857142857142857, 1.0, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 11.0, 13.0, -5.5, 19.0, -100000.0, 19.0, -5.5, 19.0, -5.5, -100000.0]) == [0.0, 0.999894247490881, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.0, 1.0, 0.9997550465411572, 1.0, 0.9997550465411572, 0.0]
    @test rescale_to_unit([3.0, 6.880428028847085, 6.124505038471483, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0]) == [0.673376412076657, 1.0, 0.9363724111168275, 0.3366882060383285, 0.0, 0.2104301287739553, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 10.151375828019562, 13.0, 17.0, 19.0, -100000.0, 17.0]) == [0.0, 0.999894247490881, 0.9999115305674724, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0, 0.9999800037992781]
    @test rescale_to_unit([-6.434931263616406, -100000.0, 19.41864539875061, 5.0, 9.0, 11.0, 15.0, -100000.0]) == [0.999741514427773, 0.0, 1.0, 0.9998558415396327, 0.9998958337736826, 0.9999158298907076, 0.9999558221247574, 0.0]
    @test rescale_to_unit([7.0, -0.5, -2.37372058193593, 9.0, -1.2400220924963046, -10.0, -5.0, 3.0, 4.0, 6.0]) == [0.8947368421052632, 0.5, 0.40138312726652997, 1.0, 0.461051468815984, 0.0, 0.2631578947368421, 0.6842105263157895, 0.7368421052631579, 0.8421052631578947]
    @test rescale_to_unit([3.0, -5.847428382699748, 5.578999868638974, 6.822138554696681, -1.0, -5.0, -2.5, 4.046541901582966, 4.0, 6.0]) == [0.6983212943597169, 0.0, 0.9018799385803499, 1.0, 0.3826041100419716, 0.0668869257242263, 0.2642101659228171, 0.7809241099692951, 0.7772505904391532, 0.9351091825980259]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 18.255935636763752, 11.0, 14.357147265189116, 13.0, 17.0, 19.0, -100000.0]) == [0.0, 0.999894247490881, 0.9999925607698213, 0.9999200151971126, 0.9999535802923962, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 6.361720364471644, 5.0, 13.0, 19.0, 7.340064277412082, -1.9494985562533456]) == [0.0, 0.9998736412118144, 0.999860026594947, 0.9999400113978344, 1.0, 0.9998834227924435, 0.9997905448109234]
    @test rescale_to_unit([2.0, 2.0, 3.0, -1.2176086883151271, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0]) == [0.50001, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002]
    @test rescale_to_unit([-1.0, 18.803842168566185, 5.0, 11.0, -116505.32195163157, 2.071031386145096, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 1.46050216156186]) == [0.9998283620134834, 0.9999983165932387, 0.9998798534094383, 0.9999313448053934, 0.0, 0.9998547172956658, 0.9999313448053934, 0.9998798534094383, 0.999948508604045, 0.9999656724026966, 0.9999828362013483, 1.0, 0.9998494777953248]
    @test rescale_to_unit([-10.0, -9.194474676157663, -5.5, -1.0, -9.66675615633341, -0.1, -0.1, -9.66675615633341]) == [0.0, 0.0813661943275088, 0.45454545454545453, 0.9090909090909091, 0.033660994309756595, 1.0, 1.0, 0.033660994309756595]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, -1.4695256238944465, 0.0, 1.2451826892610212, -0.1, -0.1]) == [0.0, 0.6831272555916355, 0.4198620983247112, 0.36052026217320937, 0.706683367853416, 1.0, 0.6831272555916355, 0.6831272555916355]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.942680122481894, 11.0, 13.0, 17.0, 19.0, -87387.4823957305]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999294402075853, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.12610121681150077]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 3.0, 6.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5714285714285714, 0.7857142857142857]
    @test rescale_to_unit([-1.0, 4.769631488983501, 7.0, 9.0, 11.0, 5.0, 13.0, 17.0, 19.0, -1.0]) == [0.0, 0.28848157444917505, 0.4, 0.5, 0.6, 0.3, 0.7, 0.9, 1.0, 0.0]
    @test rescale_to_unit([2.0, 3.0, 1.5222176980104452, 4.0, 4.0, 5.0e-9, 6.361720364471644, 100000.0, -100000.0]) == [0.50001, 0.500015, 0.5000076110884901, 0.50002, 0.50002, 0.500000000000025, 0.5000318086018224, 1.0, 0.0]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 2.071031386145096, 11.0, 3.0, -3.0, 15.0, 17.0, 19.0, -1.0]) == [0.09090909090909091, 0.36363636363636365, 0.45454545454545453, 0.5454545454545454, 0.23050142664295892, 0.6363636363636364, 0.2727272727272727, 0.0, 0.8181818181818182, 0.9090909090909091, 1.0, 0.09090909090909091]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 11.029460583547525, 19.0, 11.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999203097469835, 1.0, 0.9999200151971126]
    @test rescale_to_unit([11.0, -0.1, 1.7387690576468535, -1.2176086883151271, 0.0, 1.3, 2.6, 0.0, 11.0]) == [1.0, 0.09147524010848404, 0.24197679115303872, 0.0, 0.09966014785525446, 0.20606394856326984, 0.31246774927128523, 0.09966014785525446, 1.0]
    @test rescale_to_unit([2.0, 10.401137390833725, -1.0858890328967417, 0.8986163754356359, 1.46050216156186, 100000.0, 3.0, 2.0]) == [3.085855523930036e-5, 0.00011486901688724808, 0.0, 1.9844838590397926e-5, 2.5463635437761423e-5, 1.0, 4.085844665157621e-5, 3.085855523930036e-5]
    @test rescale_to_unit([8.422739790413504, 5.0, 13.0]) == [0.42784247380168794, 0.0, 1.0]
    @test rescale_to_unit([5.0, 9.0, 11.0, 11.029460583547525, 23.88238347602904, 19.0]) == [0.0, 0.21183766366560408, 0.3177564954984061, 0.3193167107956394, 1.0, 0.7414318228296143]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.015599539923190964, -0.1, -0.1, -0.1, -0.1]) == [0.0, 0.4507030760628547, 0.9014061521257094, 1.0, 0.9915467673382804, 0.9915467673382804, 0.9915467673382804, 0.9915467673382804]
    @test rescale_to_unit([7.0, -1.1252324395847113, 2.258580593854103, 12.527987311788877, -1.0, -5.0, 1.9850204264692954, 6.0]) == [0.6846193910654594, 0.22106175064430922, 0.41411375218032975, 1.0, 0.2282064636884865, 0.0, 0.3985067025791004, 0.6275677751433378]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 9.0, 6.822138554696681, 5.0, 13.0, 15.0, 17.0, 19.0]) == [0.1836734693877551, 0.0, 0.5102040816326531, 0.5918367346938775, 0.5029444308039462, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0]
    @test rescale_to_unit([-1.1252324395847113, 8.422739790413504, 5.0, 4.514661959966183, 13.0, -5.5, 13.327637346787848, 19.0, -100000.0, 19.0, 19.0]) == [0.9997987859062819, 0.999894247490881, 0.999860026594947, 0.9998551741365137, 0.9999400113978344, 0.9997550465411572, 0.9999432871489096, 1.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([-10.0, -4.737351970693368, -100000.0, -1.0, -0.09622505532175613, -0.5, -9.66675615633341, -0.1, -0.1, -1.0, -0.1]) == [0.999900962155254, 0.9999535886861871, 0.0, 0.9999909622418567, 1.0, 0.999995962246668, 0.9999042945968973, 0.9999999622505169, 0.9999999622505169, 0.9999909622418567, 0.9999999622505169]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 11.0, 13.0, -5.5, 19.0, 19.0, -5.5, 19.0, -5.5, -100000.0, -100000.0]) == [0.0, 0.999894247490881, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 1.0, 0.9997550465411572, 1.0, 0.9997550465411572, 0.0, 0.0]
    @test rescale_to_unit([1.0, 2.0, 2.258580593854103, 3.0, 4.0, 4.0]) == [0.0, 0.3333333333333333, 0.41952686461803435, 0.6666666666666666, 1.0, 1.0]
    @test rescale_to_unit([5.0, 9.0, 11.0, 11.029460583547525, 18.149298285479812, 24.457547670728097, 19.0, 9.0]) == [0.0, 0.20557575228339764, 0.30836362842509646, 0.30987772383146905, 0.6757942217590758, 1.0, 0.7195151329918917, 0.20557575228339764]
    @test rescale_to_unit([3.0, -5.847428382699748, 5.578999868638974, -4.211888230877799, 6.822138554696681, -1.0, -5.0, -2.5, 4.046541901582966, 4.0, 6.0]) == [0.6983212943597169, 0.0, 0.9018799385803499, 0.1290920328929609, 1.0, 0.3826041100419716, 0.0668869257242263, 0.2642101659228171, 0.7809241099692951, 0.7772505904391532, 0.9351091825980259]
    @test rescale_to_unit([20.193269967400774, -116505.32195163157, -100000.0, 5.0, 11.942680122481894, 11.0, 13.0, 17.0, 1.46050216156186, -100000.0, 19.0]) == [1.0, 0.0, 0.14164556080479937, 0.999869614221928, 0.9999291949936523, 0.9999211050905896, 0.9999382687134768, 0.9999725959592513, 0.9998392389188735, 0.14164556080479937, 0.9999897595821384]
    @test rescale_to_unit([3.0, 6.880428028847085, 6.124505038471483, -1.0, -5.0, -2.5, 2.0, 4.0, -2.5402928043798356, -116505.32195163157, 6.0, 6.124505038471483]) == [0.999966695093307, 1.0, 0.9999935120701958, 0.9999323639252551, 0.9998980327572031, 0.9999194897372355, 0.999958112301294, 0.99997527788532, 0.999919143912476, 0.0, 0.999992443469346, 0.9999935120701958]
    @test rescale_to_unit([-3.0, 7.51554490959548, -2.5, 8.722521795855851, -1.2, 0.0, 1.3, 2.6]) == [0.0, 0.8970377784507885, 0.04265293839562406, 1.0, 0.15355057822424664, 0.2559176303737444, 0.3668152702023669, 0.4777129100309895]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, -3.0, 2.6]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 0.7678571428571429, 1.0, 0.0, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 11.168244657255205, 9.0, 9.294663202788586, 8.422739790413504]) == [0.0, 0.9999542333475689, 0.9999200103986482, 0.999960005199324, 0.999980002599662, 1.0, 0.9999816848275449, 0.999960005199324, 0.9999629514483396, 0.9999542333475689]
    @test rescale_to_unit([2.0, 2.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0]) == [0.50001, 0.50001, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002]
    @test rescale_to_unit([20.193269967400774, -116505.32195163157, -100000.0, 5.0, 9.0, 11.0, 13.0, 1.46050216156186, -100000.0, 19.0]) == [1.0, 0.0, 0.14164556080479937, 0.999869614221928, 0.9999039414677025, 0.9999211050905896, 0.9999382687134768, 0.9998392389188735, 0.14164556080479937, 0.9999897595821384]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 11.0, 13.0, -5.5, 19.0, 5.578999868638974, 19.0, -5.5, 19.0, -5.5, -100000.0, -100000.0]) == [0.0, 0.999894247490881, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 1.0, 0.9998658154937425, 1.0, 0.9997550465411572, 1.0, 0.9997550465411572, 0.0, 0.0]
    @test rescale_to_unit([-3.0, 1.4117100309373578, -2.37372058193593, -1.2, 0.0, 1.3, 2.6, -1.2, 1.3]) == [0.0, 0.7878053626673853, 0.1118356103685839, 0.32142857142857145, 0.5357142857142857, 0.7678571428571429, 1.0, 0.32142857142857145, 0.7678571428571429]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.970622647728508, 4.0, 4.0, 4.0, 4.0, -100000.0, 3.0]) == [0.9999702952500338, 0.9999702952500338, 0.9999802947529962, 0.9999802947529962, 0.9999802947529962, 1.0, 0.9999902942559586, 0.9999902942559586, 0.9999902942559586, 0.9999902942559586, 0.0, 0.9999802947529962]
    @test rescale_to_unit([7.0, 3.0, 9.0, 0.4269239279743262, -5.0, 3.0, 3.4732209828361675, -5.392186064112541, 6.0]) == [0.8610357042988017, 0.5831071128964052, 1.0, 0.40432426082907846, 0.02724993009161211, 0.5831071128964052, 0.6159875231918336, 0.0, 0.7915535564482026]
    @test rescale_to_unit([10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 10.282719410300084, 13.0, 12.435097367794613, 3.707031356089287, 17.0, 19.0, 2.232577808710385]) == [0.4871684799805879, 0.0, 0.3996042914800858, 0.5228843224240002, 0.48010609560315165, 0.6421632418180001, 0.6084727540518577, 0.08793561291400268, 0.8807210806060001, 1.0, 0.0]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.5997629033964986, 1.3, 2.6]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.6428148041779462, 0.7678571428571429, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.494052310009373, 7.824002367662983, 9.0, 8.422739790413504, -100000.0, -100000.0, 5.0, 11.0]) == [0.0, 0.9999492937171365, 0.999915070937272, 0.9999550655403794, 0.999975062841933, 1.0, 0.9999433071507393, 0.9999550655403794, 0.9999492937171365, 0.0, 0.0, 0.999915070937272, 0.999975062841933]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 11.029460583547525, 19.0, 16.47865507751967]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999203097469835, 1.0, 0.9999747913404204]
    @test rescale_to_unit([-1.0, -5.5, 7.0, 5.0, 13.0, 15.0, 17.0, 18.55562594891745]) == [0.18706642718654798, 0.0, 0.5196289644070777, 0.43648833010194527, 0.769050867322475, 0.8521915016276075, 0.9353321359327399, 1.0]
    @test rescale_to_unit([-1.0, 3.6375526859691534, 5.0, 7.0, 9.0, 11.0, 13.0, 15.0, -1.5661416747342105, 19.0]) == [0.027527850565656823, 0.2530223919976285, 0.3192694953959598, 0.416516710339394, 0.5137639252828283, 0.6110111402262627, 0.7082583551696969, 0.8055055701131314, 0.0, 1.0]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 2.232577808710385, 8.932911673408139, 13.0, 12.435097367794613, 17.725302075603715, 17.0, 19.0, 3.458912167325974]) == [0.0, 0.5653842082082107, 0.1525173964046947, 0.4911750817560951, 0.6967395725138151, 0.668187470225369, 0.9355724270886383, 0.8989131908379384, 1.0, 0.21450051004382137]
    @test rescale_to_unit([7.0, 19.41864539875061, 3.0, 6.880428028847085, -1.0, -0.09622505532175613, -2.5, 2.0, 4.0]) == [0.43342094491576166, 1.0, 0.2509279154775462, 0.42796568210286307, 0.06843488603933079, 0.10966804293550286, 0.0, 0.20530465811799237, 0.2965511728371001]
    @test rescale_to_unit([11.0, 4.970622647728508, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 11.0, 11.0]) == [0.5662174840625468, 0.28172257782364146, 0.0, 0.2831087420312734, 0.37747832270836457, 0.4718479033854557, 0.16986524521876406, 0.5662174840625468, 0.660587064739638, 0.7549566454167291, 0.04718479057446952, 0.8493262260938202, 1.0, 0.9436958067709114, 0.5662174840625468, 0.5662174840625468]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0, 5.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.7551020408163265, 0.8367346938775511, 0.9183673469387755, 1.0, 0.42857142857142855]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 8.932911673408139, 11.0, 13.0, 12.435097367794613, 3.458912167325974, 17.0, 19.0, 3.458912167325974, 19.0, 17.0]) == [0.0, 0.5653842082082107, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.668187470225369, 0.21450051004382137, 0.8989131908379384, 1.0, 0.21450051004382137, 1.0, 0.8989131908379384]
    @test rescale_to_unit([7.0, 3.0, -1.0, -5.0, -2.5, 4.690179826736281, 6.0, -5.0, -1.0]) == [1.0, 0.6666666666666666, 0.3333333333333333, 0.0, 0.20833333333333334, 0.8075149855613567, 0.9166666666666666, 0.0, 0.3333333333333333]
    @test rescale_to_unit([7.0, 3.0, 4.784100732862937, -1.0, -5.0, -2.5, 4.690179826736281, 6.0, -5.0]) == [1.0, 0.6666666666666666, 0.815341727738578, 0.3333333333333333, 0.0, 0.20833333333333334, 0.8075149855613567, 0.9166666666666666, 0.0]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 5.0, 3.562048029970825, 13.0, -6.434931263616406, 15.0, 17.0, 19.0, 11.0]) == [0.21367980936480238, 0.03675776647188292, 0.4495758665553617, 0.5282078856188814, 0.6068399046824012, 0.4495758665553617, 0.39304133319548173, 0.7641039428094407, 0.0, 0.8427359618729605, 0.9213679809364802, 1.0, 0.6854719237459209]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -5.0, -2.5, -1.9494985562533456, 2.0, 4.0, 6.0]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.0, 0.2104301287739553, 0.256766964653098, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033]
    @test rescale_to_unit([-10.0, -4.737351970693368, -100000.0, -1.0, -0.09622505532175613, -0.5, -9.66675615633341, -0.657703561355692, -0.1, -1.0, -0.1]) == [0.999900962155254, 0.9999535886861871, 0.0, 0.9999909622418567, 1.0, 0.999995962246668, 0.9999042945968973, 0.9999943852095369, 0.9999999622505169, 0.9999909622418567, 0.9999999622505169]
    @test rescale_to_unit([-100000.0, 19.477741831900236, 8.422739790413504, 10.151375828019562, 13.0, 17.0, 19.0, -100000.0, 17.0]) == [0.0, 1.0, 0.9998894715080395, 0.9999067545020786, 0.9999352351964023, 0.9999752274068228, 0.999995223512033, 0.0, 0.9999752274068228]
    @test rescale_to_unit([-9.66675615633341, -3.0, 0.0, 1.3, -93935.84316983708, -2.5]) == [0.9998832543146803, 0.9999542247096845, 0.9999861609587418, 1.0, 0.0, 0.9999595474178608]
    @test rescale_to_unit([-1.0, 3.6375526859691534, 5.0, 9.0, 11.0, 13.0, 15.0, -1.5661416747342105, 19.0]) == [0.027527850565656823, 0.2530223919976285, 0.3192694953959598, 0.5137639252828283, 0.6110111402262627, 0.7082583551696969, 0.8055055701131314, 0.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, 18.149298285479812, -5.0, -2.5, 2.0, 4.690179826736281, 6.0]) == [0.5183742440921801, 0.3455828293947868, 0.5132089915787631, 1.0, 0.0, 0.10799463418587087, 0.30238497572043843, 0.418594970233476, 0.47517639041783183]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 10.151375828019562, -94845.99165474174, 13.0, 17.0, 19.0, -100000.0, 17.0, 19.0]) == [0.0, 0.999894247490881, 0.9999115305674724, 0.051530292696970195, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0, 0.9999800037992781, 1.0]
    @test rescale_to_unit([2.0, 2.0, 4.046541901582966, 3.0, -100000.0, 3.458912167325974, 3.0, 4.0, 1.8392488338004267, 4.0, 4.0, 4.0]) == [0.9999795354090925, 0.9999795354090925, 1.0, 0.9999895350044546, 0.0, 0.9999941239404346, 0.9999895350044546, 0.9999995345998168, 0.9999779279624764, 0.9999995345998168, 0.9999995345998168, 0.9999995345998168]
    @test rescale_to_unit([0.0, 0.0, 0.0, -100000.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.999990000099999, 0.999990000099999, 0.999990000099999, 0.0, 0.999990000099999, 0.999990000099999, 0.999990000099999, 1.0, 0.999990000099999]
    @test rescale_to_unit([2.0, 2.0, 4.046541901582966, 3.0, -100000.0, 3.0, 2.2157899019980976, 4.0, 1.2451826892610212, 4.0, 4.0, 4.0, 2.0]) == [0.9999795354090925, 0.9999795354090925, 1.0, 0.9999895350044546, 0.0, 0.9999895350044546, 0.9999816932207957, 0.9999995345998168, 0.9999719875414127, 0.9999995345998168, 0.9999995345998168, 0.9999995345998168, 0.9999795354090925]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([2.0, 10.401137390833725, -1.0858890328967417, 0.8986163754356359, 1.46050216156186]) == [0.26864124091520847, 1.0, 0.0, 0.17276058530105654, 0.2216754014945192]
    @test rescale_to_unit([3.0, 7.0, 5.578999868638974, 6.822138554696681, -1.0, -2.5, 4.046541901582966, 4.0, 6.822138554696681]) == [0.5789473684210527, 1.0, 0.8504210388041025, 0.9812777425996507, 0.15789473684210525, 0.0, 0.6891096738508385, 0.6842105263157895, 0.9812777425996507]
    @test rescale_to_unit([-100000.0, 5.0, 13.0, 17.0, 19.0, 14.357147265189116]) == [0.0, 0.999860026594947, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9999535802923962]
    @test rescale_to_unit([7.0, -2.37372058193593, 9.0, -1.2400220924963046, -10.0, -5.0, 4.0, 6.0]) == [0.8947368421052632, 0.40138312726652997, 1.0, 0.461051468815984, 0.0, 0.2631578947368421, 0.7368421052631579, 0.8421052631578947]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.626959923143518, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.813479961571759, 1.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, -1.2176086883151271, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, -100000.0, 4.0]) == [0.50001, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.0, 0.50002]
    @test rescale_to_unit([-0.7849750781391729, 10.401137390833725, 2.232577808710385, 8.932911673408139, 11.0, 13.0, -0.657703561355692, 12.435097367794613, 17.0, 19.0, 3.458912167325974, -0.7348076171425224]) == [0.0, 0.5653842082082107, 0.1525173964046947, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.00643273576442893, 0.668187470225369, 0.8989131908379384, 1.0, 0.21450051004382137, 0.002535634277956789]
    @test rescale_to_unit([-100000.0, 9.0, 18.469247120829454, 11.0, 11.029460583547525, 19.0]) == [0.0, 0.9999000189963907, 0.9999946934794471, 0.9999200151971126, 0.9999203097469835, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 13.0, 9.883843909648547, 17.0, 12.528000738941515, 19.0, -1.0, 5.0, 5.486580591351534, 17.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999400113978344, 0.9999088557565027, 0.9999800037992781, 0.9999352923018521, 1.0, 0.9998000379927814, 0.999860026594947, 0.999864891476533, 0.9999800037992781]
    @test rescale_to_unit([5.0, 9.0, 11.0, 11.029460583547525, 18.149298285479812, 24.457547670728097, 19.0, 9.0, 19.0]) == [0.0, 0.20557575228339764, 0.30836362842509646, 0.30987772383146905, 0.6757942217590758, 1.0, 0.7195151329918917, 0.20557575228339764, 0.7195151329918917]
    @test rescale_to_unit([2.0, 2.088536751425015, 3.0, 3.0, 3.0, 4.970622647728508, 1.631962701646998, 16.290878548158467, 4.0, 0.8986163754356359, 4.0, 4.0, -100000.0, 0.8986163754356359, 3.0]) == [0.999857114491823, 0.9998579997151267, 0.9998671128630006, 0.9998671128630006, 0.9998671128630006, 0.9998868158796833, 0.999853434718307, 1.0, 0.999877111234178, 0.9998461024495358, 0.999877111234178, 0.999877111234178, 0.0, 0.9998461024495358, 0.9998671128630006]
    @test rescale_to_unit([7.0, -2.37372058193593, 9.0, -1.2400220924963046, -10.0, -5.0, 4.0, 6.0, -10.0]) == [0.8947368421052632, 0.40138312726652997, 1.0, 0.461051468815984, 0.0, 0.2631578947368421, 0.7368421052631579, 0.8421052631578947, 0.0]
    @test rescale_to_unit([2.258580593854103, -1.0, -5.0, 1.9850204264692954, 16.47865507751967, 6.0, 2.258580593854103]) == [0.3379439060619393, 0.18623139975773173, 0.0, 0.3252075328394313, 1.0, 0.5121363493337623, 0.3379439060619393]
    @test rescale_to_unit([18.149298285479812, 2.0, 3.0, -0.5292714556132707, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, -1.2176086883151271]) == [0.5000907464914274, 0.50001, 0.500015, 0.49999735364272196, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.49999391195655846]
    @test rescale_to_unit([2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271]) == [0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 9.0, 4.006918996620226, 11.0, 13.0, 17.0, -100000.0, 19.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9998500976714086, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 0.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 1.4902206382938175]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.5000074511031914]
    @test rescale_to_unit([7.0, 3.0, 9.0, -9.66675615633341, -5.0, 3.0, 4.0, 6.0, 7.0]) == [0.8928576565071042, 0.6785729695213129, 1.0, 0.0, 0.25000359554972995, 0.6785729695213129, 0.7321441412677607, 0.8392864847606564, 0.8928576565071042]
    @test rescale_to_unit([-100000.0, 5.0, 1.3, 9.0, 11.0, 13.0, 17.0]) == [0.0, 0.9998800203965326, 0.9998430266854635, 0.9999200135976883, 0.9999400101982663, 0.9999600067988442, 1.0]
    @test rescale_to_unit([12.528000738941515, 2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.5000626400036947, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, 17.0, 19.0, 0.499560300532895, 13.72122445462381, 13.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0, 0.9998150307471634, 0.9999472222723145, 0.9999400113978344]
    @test rescale_to_unit([-5.0, 10.401137390833725, -0.1, -1.2176086883151271, 0.8986163754356359, 2.6, -0.1]) == [0.0, 1.0, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.49347004751241824, 0.31815832010669076]
    @test rescale_to_unit([3.0, 7.0, 5.578999868638974, 6.822138554696681, -1.0, -2.5, 4.046541901582966, 4.0, 6.822138554696681, 6.822138554696681, -1.0]) == [0.5789473684210527, 1.0, 0.8504210388041025, 0.9812777425996507, 0.15789473684210525, 0.0, 0.6891096738508385, 0.6842105263157895, 0.9812777425996507, 0.9812777425996507, 0.15789473684210525]
    @test rescale_to_unit([-0.9741314779560433, 7.0, 3.0, 9.0, -1.0, -5.0, 2.0, 4.0, 6.0, -1.0]) == [0.28756203728885404, 0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5, 0.6428571428571429, 0.7857142857142857, 0.2857142857142857]
    @test rescale_to_unit([2.0, 2.0, 4.602606106550939, 3.0, -100000.0, 3.458912167325974, 3.0, 4.0, 1.2451826892610212, 4.0, 4.0, 4.0, 1.2451826892610212]) == [0.9999739751367565, 0.9999739751367565, 1.0, 0.999983974676517, 0.0, 0.9999885635869807, 0.999983974676517, 0.9999939742162776, 0.9999664273110458, 0.9999939742162776, 0.9999939742162776, 0.9999939742162776, 0.9999664273110458]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.0, 4.0, 5.0e-9, 4.0, -100000.0, -1.2176086883151271, 4.0]) == [0.999980000799968, 0.999980000799968, 0.999990000399984, 1.0, 1.0, 0.9999600015999861, 1.0, 0.0, 0.9999478260000769, 1.0]
    @test rescale_to_unit([11.0, -0.3933151616068914, -1.2176086883151271, 11.743598807823856, 0.0, 1.3, 2.6, 0.0, 100000.0, 11.0]) == [0.0001221745992746156, 8.242834901608432e-6, 0.0, 0.00012961049681271968, 1.2175938627864655e-5, 2.5175780340662495e-5, 3.8175622053460336e-5, 1.2175938627864655e-5, 1.0, 0.0001221745992746156]
    @test rescale_to_unit([-5.0, 2.0, 4.0, 2.492199888107555]) == [0.0, 0.7777777777777778, 1.0, 0.8324666542341728]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 14.803481340003744, -147046.595120599, 19.0, 19.0]) == [0.3199021163448808, 0.9999280779423568, 0.9999048043834554, 0.9999456025048317, 0.9999592018786237, 0.999833407671047, 0.9999714649870586, 0.0, 1.0, 1.0]
    @test rescale_to_unit([8.873088049958566, 5.0, 9.0, 11.0, 10.971192509868965, 18.149298285479812, 19.0]) == [0.2766491464256119, 0.0, 0.2857142857142857, 0.42857142857142855, 0.4265137507049261, 0.9392355918199866, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([-1.0, 18.803842168566185, 5.0, 16.290878548158467, 7.0, 2.071031386145096, -0.5, 13.0, 15.0, 17.0, 19.0, 1.46050216156186, -1.0]) == [0.0, 0.9901921084283092, 0.3, 0.8645439274079234, 0.4, 0.1535515693072548, 0.025, 0.7, 0.8, 0.9, 1.0, 0.123025108078093, 0.0]
    @test rescale_to_unit([-1.0, -5.5, 5.0, 7.0, 9.0, 11.0, 5.0, 15.0, 17.0, 19.0, 17.0]) == [0.1836734693877551, 0.0, 0.42857142857142855, 0.5102040816326531, 0.5918367346938775, 0.673469387755102, 0.42857142857142855, 0.8367346938775511, 0.9183673469387755, 1.0, 0.9183673469387755]
    @test rescale_to_unit([12.528000738941515, 2.0, 3.0, -1.2176086883151271, 4.0, 4.0, 5.0e-9, 100000.0, -100000.0]) == [0.5000626400036947, 0.50001, 0.500015, 0.49999391195655846, 0.50002, 0.50002, 0.500000000000025, 1.0, 0.0]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, -1.4695256238944465, 0.0, 1.2451826892610212, -0.1, -0.1, -1.4695256238944465]) == [0.0, 0.6831272555916355, 0.4198620983247112, 0.36052026217320937, 0.706683367853416, 1.0, 0.6831272555916355, 0.6831272555916355, 0.36052026217320937]
    @test rescale_to_unit([2.0, 3.0, -1.0, 4.0, 4.0, -1.9494985562533456, 4.0, 100000.0, -100000.0, -1.0]) == [0.50001, 0.500015, 0.499995, 0.50002, 0.50002, 0.49999025250721874, 0.50002, 1.0, 0.0, 0.499995]
    @test rescale_to_unit([-0.5, -2.37372058193593, 9.0, -1.2400220924963046, -10.0, -5.0, 3.0, 4.046541901582966, 6.0]) == [0.5, 0.40138312726652997, 1.0, 0.461051468815984, 0.0, 0.2631578947368421, 0.6842105263157895, 0.7392916790306824, 0.8421052631578947]
    @test rescale_to_unit([5.486580591351534, -3.0, 7.51554490959548, -2.5, 8.722521795855851, -1.2, 11.324887692190664, 0.0, 1.3, 2.6]) == [0.5924360995847853, 0.0, 0.7340752078166811, 0.03490428761075588, 0.8183325445718143, 0.12565543539872118, 1.0, 0.2094257256645353, 0.30017687345250055, 0.39092802124046583]
    @test rescale_to_unit([11.0, -87387.4823957305, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 17.0, 20.193269967400774, 19.0]) == [0.9998948230816413, 0.0, 0.9998261792245167, 0.9998490605102249, 0.9998719417959332, 0.9997987216816668, 0.9998948230816413, 0.9999177043673496, 0.9999405856530579, 0.9999634669387661, 1.0, 0.9999863482244743]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 3.621270797455902, 9.0, 11.0, 5.0, 13.0, 15.0, 17.0, 19.0]) == [0.0, 0.3, 0.4, 0.2310635398727951, 0.5, 0.6, 0.3, 0.7, 0.8, 0.9, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.1, -0.1, -0.1, -0.1, -10.0]) == [0.0, 0.45454545454545453, 0.9090909090909091, 1.0, 1.0, 1.0, 1.0, 0.0]
    @test rescale_to_unit([2.0, -3.9976986611875804, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 4.0, 3.0, 2.0, 4.0]) == [0.7499280624680326, 0.0, 0.8749640312340163, 0.8749640312340163, 1.0, 1.0, 1.0, 1.0, 0.7499280624680326, 1.0, 1.0, 0.8749640312340163, 0.7499280624680326, 1.0]
    @test rescale_to_unit([2.0, 3.0, 3.0, 1.8139876754497708, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.500015, 0.500015, 0.5000090699383772, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 20.193269967400774, 3.0, 4.0, 4.0, 4.0, 5.234060683691759, 2.0, 4.0, 4.0, 3.0, 3.0, 3.0]) == [0.0, 0.0, 0.054965380153860675, 0.054965380153860675, 1.0, 0.054965380153860675, 0.10993076030772135, 0.10993076030772135, 0.10993076030772135, 0.1777613749197721, 0.0, 0.10993076030772135, 0.10993076030772135, 0.054965380153860675, 0.054965380153860675, 0.054965380153860675]
    @test rescale_to_unit([-100000.0, 5.0, -1.2, 11.0, 17.0, 19.0, 11.0, 14.001363610040931, 17.0, 19.0]) == [0.0, 0.999860026594947, 0.9997980383727092, 0.9999200151971126, 0.9999800037992781, 1.0, 0.9999200151971126, 0.9999500231317053, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 1.0, 10.151375828019562, -94845.99165474174, 13.0, 17.0, 19.0, -100000.0, 17.0, 19.0]) == [0.0, 0.999894247490881, 0.9998200341935032, 0.9999115305674724, 0.051530292696970195, 0.9999400113978344, 0.9999800037992781, 1.0, 0.0, 0.9999800037992781, 1.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.5, -9.66675615633341, -0.1, -155640.12451219512, 4.336363527402568, -0.1]) == [0.999907890306878, 0.9999368023540828, 0.9999657144012876, 0.9999689268509769, 0.9999100313650422, 0.9999714968107285, 0.0, 1.0, 0.9999714968107285]
    @test rescale_to_unit([-5.0, 10.401137390833725, 4.0, -0.1, -1.2176086883151271, 0.8986163754356359, 2.6]) == [0.0, 1.0, 0.5843724246857585, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.49347004751241824]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 11.736647377028104, 13.0, -5.5, 19.0, -149710.3331618766, 19.0, -5.5, 19.0, -5.5]) == [0.3320012993588461, 0.9999293574613188, 0.9999514901157336, 0.9999599276917001, 0.9998363714077755, 1.0, 0.0, 1.0, 0.9998363714077755, 1.0, 0.9998363714077755]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 1.3, 2.6, -3.0]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.7678571428571429, 1.0, 0.0]
    @test rescale_to_unit([1.9850204264692954, -2.5, -1.2, 0.0, 1.3, 2.6]) == [0.8794157698959404, 0.0, 0.25490196078431376, 0.4901960784313726, 0.7450980392156863, 1.0]
    @test rescale_to_unit([-0.7849750781391729, 0.499560300532895, 7.0, 8.932911673408139, 11.0, 13.0, 15.0, 17.0, 19.0, 15.0, 15.0, 15.0]) == [0.0, 0.06492479134286995, 0.3934791450276302, 0.4911750817560951, 0.5956527633517534, 0.6967395725138151, 0.7978263816758767, 0.8989131908379384, 1.0, 0.7978263816758767, 0.7978263816758767, 0.7978263816758767]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, -5.5, 19.0, -100000.0, 19.0, 8.422739790413504, -100000.0]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9997550465411572, 1.0, 0.0, 1.0, 0.999894247490881, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 1.0, 1.0, 1.0]
    @test rescale_to_unit([-2.371036804582337, 6.361720364471644, 5.0, 13.0, 7.340064277412082, -1.9494985562533456]) == [0.0, 0.5681306524782125, 0.479540638558937, 1.0, 0.6317791835030537, 0.027424190943536382]
    @test rescale_to_unit([-3.913461319358456, -1.0, 5.0, 9.883843909648547, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 14.803481340003744, 17.0, 20.193269967400774, 19.0, 2.6]) == [0.0, 0.12085675509888363, 0.36974989322813046, 0.5723424326957699, 0.45271427260454605, 0.5356786519809617, 0.2701926379764317, 0.6186430313573772, 0.7016074107337927, 0.7845717901102084, 0.7764197657789713, 0.8675361694866239, 1.0, 0.9505005488630396, 0.2701926379764317]
    @test rescale_to_unit([2.0, 2.088536751425015, 3.0, 3.0, 3.0, 1.250889673660545, 4.970622647728508, 1.631962701646998, 16.290878548158467, 4.0, 0.8986163754356359, 4.0, 4.0, -100000.0, 0.8986163754356359, 3.0]) == [0.999857114491823, 0.9998579997151267, 0.9998671128630006, 0.9998671128630006, 0.9998671128630006, 0.9998496246087274, 0.9998868158796833, 0.999853434718307, 1.0, 0.999877111234178, 0.9998461024495358, 0.999877111234178, 0.999877111234178, 0.0, 0.9998461024495358, 0.9998671128630006]
    @test rescale_to_unit([7.0, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 6.0, -1.0, 6.880428028847085]) == [1.0, 0.6666666666666666, 0.9900356690705904, 0.3333333333333333, 0.0, 0.20833333333333334, 0.5833333333333334, 0.9166666666666666, 0.3333333333333333, 0.9900356690705904]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, -1.2176086883151271, 4.784100732862937, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.49999391195655846, 0.5000239205036643, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, -1.9494985562533456, 2.0, 4.0, 6.0, 11.743598807823856, 6.880428028847085, -5.0]) == [0.14931079206411788, 0.4777945346051772, 0.709550447619162, 0.2388972673025886, 0.0, 0.14931079206411788, 0.18218911470341922, 0.4180702177795301, 0.5375188514308243, 0.6569674850821187, 1.0, 0.709550447619162, 0.0]
    @test rescale_to_unit([-3.0, -2.5, 0.0, 1.3]) == [0.0, 0.11627906976744186, 0.6976744186046512, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 3.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 0.5, 1.0]
    @test rescale_to_unit([-100000.0, 5.0, 9.0, 11.0, 11.029460583547525, -4.737351970693368, 19.0]) == [0.0, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999203097469835, 0.9997626715726943, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.2400220924963046, -5.0, 3.0, 4.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.26856985053597826, 0.0, 0.5714285714285714, 0.6428571428571429]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0, 2.492199888107555, 3.0]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.3366882060383285, 0.0, 0.2104301287739553, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033, 0.6306338349018745, 0.673376412076657]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, 1.9052748416682936, -5.0, -2.5, -1.9494985562533456, 2.0, 4.0, 6.0, 3.0]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.3366882060383285, 0.5812311496607251, 0.0, 0.2104301287739553, 0.256766964653098, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033, 0.673376412076657]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, 0.0, 3.458912167325974, 11.0]) == [1.0, 0.09147524010848404, 0.0, 0.09966014785525446, 0.20606394856326984, 0.31246774927128523, 0.09966014785525446, 0.3827689177927025, 1.0]
    @test rescale_to_unit([0.0, 0.4269239279743262, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]) == [0.0, 0.4269239279743262, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.09622505532175613, -5.0, -0.1, -0.1]) == [0.0, 0.45437219899853015, 0.9087443979970603, 1.0, 0.5048579988872558, 0.9996188377967664, 0.9996188377967664]
    @test rescale_to_unit([-3.0, 0.46837860635787776, -1.2176086883151271, 0.0, 1.2451826892610212, 2.6, -0.1]) == [0.0, 0.6193533225639067, 0.3182841628008702, 0.5357142857142857, 0.7580683373680396, 1.0, 0.5178571428571429]
    @test rescale_to_unit([3.0, 7.0, 5.578999868638974, 6.822138554696681, -1.0, -2.5, 4.046541901582966, 4.0, 6.822138554696681, 6.822138554696681, -1.0, 7.0, -1.0, 6.822138554696681]) == [0.5789473684210527, 1.0, 0.8504210388041025, 0.9812777425996507, 0.15789473684210525, 0.0, 0.6891096738508385, 0.6842105263157895, 0.9812777425996507, 0.9812777425996507, 0.15789473684210525, 1.0, 0.15789473684210525, 0.9812777425996507]
    @test rescale_to_unit([2.0, 10.401137390833725, -1.0858890328967417, 0.8986163754356359, -0.1716125073528473, 1.46050216156186]) == [0.26864124091520847, 1.0, 0.0, 0.17276058530105654, 0.07959209736430456, 0.2216754014945192]
    @test rescale_to_unit([-5.392186064112541, -6.028697603862666, -100000.0, -1.0, -0.5, -9.66675615633341, -0.1, -0.12405312115430803]) == [0.999947078086437, 0.9999407129646743, 0.0, 0.999990999991, 0.9999959999960001, 0.999904332342769, 1.0, 0.999999759468548]
    @test rescale_to_unit([-5.0, -0.1, -1.2176086883151271, 0.8986163754356359, 2.6, -0.1]) == [0.0, 0.6447368421052633, 0.497683067326957, 0.7761337336099522, 1.0, 0.6447368421052633]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.0, 4.0, 3.0, 2.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.0, 1.0, 0.5, 0.0]
    @test rescale_to_unit([-2.5, 3.0, 6.880428028847085, -1.0, -5.0, -2.5, 2.0, 4.0, 6.0, 3.5026414432127666]) == [0.2104301287739553, 0.673376412076657, 1.0, 0.3366882060383285, 0.0, 0.2104301287739553, 0.5892043605670748, 0.7575484635862391, 0.9258925666054033, 0.7156847735256127]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 2.6, -3.0, 1.3]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 1.0, 0.0, 0.7678571428571429]
    @test rescale_to_unit([-100000.0, 9.0, 18.469247120829454, 11.0, 11.029460583547525, 11.307879951386456, 19.0, 9.0]) == [0.0, 0.9999000189963907, 0.9999946934794471, 0.9999200151971126, 0.9999203097469835, 0.9999230934117657, 1.0, 0.9999000189963907]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 1.3, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.7678571428571429, 1.0]
    @test rescale_to_unit([-9.66675615633341, -2.3146433358554312, 0.0, 1.3, -93935.84316983708, -2.5]) == [0.9998832543146803, 0.9999615206167244, 0.9999861609587418, 1.0, 0.0, 0.9999595474178608]
    @test rescale_to_unit([-1.0, -12.436351439193258, 1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 13.0, 17.0, 19.0, 5.0, 9.0]) == [0.3637938537910284, 0.0, 0.42741446841192554, 0.5546556976537199, 0.6182763122746171, 0.6818969268955142, 0.7455175415164114, 0.5546556976537199, 0.8091381561373086, 0.9363793853791028, 1.0, 0.5546556976537199, 0.6818969268955142]
    @test rescale_to_unit([-3.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, -3.0, 2.6, -1.2176086883151271]) == [0.0, 0.5178571428571429, 0.3182841628008702, 0.5357142857142857, 0.7678571428571429, 1.0, 0.0, 1.0, 0.3182841628008702]
    @test rescale_to_unit([18.065380446624353, -100000.0, 8.422739790413504, 5.0, 9.0, 11.0, 9.578249337079814, 17.0, 19.0, -87387.4823957305]) == [0.9999906555799061, 0.0, 0.999894247490881, 0.999860026594947, 0.9999000189963907, 0.9999200151971126, 0.9999058003912964, 0.9999800037992781, 1.0, 0.12610121681150077]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 0.0, 100000.0, 11.0]) == [0.0001221745992746156, 1.1175950803803282e-5, 0.0, 1.2175938627864655e-5, 2.5175780340662495e-5, 1.2175938627864655e-5, 1.0, 0.0001221745992746156]
    @test rescale_to_unit([7.0, 9.0, -1.0, -5.0, -3.0, -5.5, 4.0, 6.0, -5.5]) == [0.8620689655172413, 1.0, 0.3103448275862069, 0.034482758620689655, 0.1724137931034483, 0.0, 0.6551724137931034, 0.7931034482758621, 0.0]
    @test rescale_to_unit([-10.0, -5.5, -1.0638245062379739, -9.66675615633341, -0.1, -0.12405312115430803, 4.769631488983501, -0.5, -10.0]) == [0.0, 0.30467923342274983, 0.6050371331490171, 0.022562773073597202, 0.6702943135300496, 0.6686657609712231, 1.0, 0.643211715003583, 0.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, -5.0, 3.0, 4.0, 3.0]) == [0.8571428571428571, 0.5714285714285714, 1.0, 0.2857142857142857, 0.0, 0.5714285714285714, 0.6428571428571429, 0.5714285714285714]
    @test rescale_to_unit([6.822138554696681, -5.0, 10.401137390833725, -0.1, -1.2176086883151271, 0.8986163754356359, 1.46050216156186, 2.6]) == [0.7676146413532321, 0.0, 1.0, 0.31815832010669076, 0.24559168687995953, 0.38299875040049364, 0.4194821458710542, 0.49347004751241824]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 9.0, 11.0, 13.0, -100000.0]) == [0.0, 0.9999542333475689, 0.999960005199324, 0.999980002599662, 1.0, 0.0]
    @test rescale_to_unit([-93935.84316983708, -1.0, 5.0, 7.0, 9.0, 2.6, 11.0, 13.0, 15.0, 5.0e-9, 17.0, 20.193269967400774, 19.0, 15.0]) == [0.0, 0.9997744341846414, 0.9998382938388728, 0.9998595803902833, 0.9998808669416938, 0.9998127499771803, 0.9999021534931042, 0.9999234400445147, 0.9999447265959251, 0.9997850774603999, 0.9999660131473357, 1.0, 0.9999872996987461, 0.9999447265959251]
    @test rescale_to_unit([-100000.0, 5.0, 11.0, 1.8139876754497708, -5.5, 19.0, -99999.35396643436, 19.0, 19.0, 8.004448108665093]) == [0.0, 0.999860026594947, 0.9999200151971126, 0.9998281725239748, 0.9997550465411572, 1.0, 6.459108425846658e-6, 1.0, 1.0, 0.9998900653686666]
    @test rescale_to_unit([-99999.95414373039, 5.0, 3.3850444114672107, 11.0, 13.0, -116505.32195163157, 17.0]) == [0.1416498361125396, 0.9998970154404837, 0.9998831558163235, 0.9999485077202419, 0.9999656718134946, 0.0, 1.0]
    @test rescale_to_unit([10.733186857378628, -71087.59728792847, 8.422739790413504, 9.0, 11.0, 13.0, 17.0, 19.0]) == [0.9998837405605397, 0.0, 0.9998512478361642, 0.9998593660731717, 0.9998874928585374, 0.999915619643903, 0.9999718732146343, 1.0]
    @test rescale_to_unit([-10.0, -4.737351970693368, -100000.0, -1.0, -0.09622505532175613, -0.5, -9.66675615633341, -0.1, -0.1, -1.0, -0.1, -0.1]) == [0.999900962155254, 0.9999535886861871, 0.0, 0.9999909622418567, 1.0, 0.999995962246668, 0.9999042945968973, 0.9999999622505169, 0.9999999622505169, 0.9999909622418567, 0.9999999622505169, 0.9999999622505169]
    @test rescale_to_unit([-100000.0, 8.620022473016821, 5.0, 11.0, 13.0, -5.5, 14.803481340003744, -147046.595120599, 19.0, 19.0]) == [0.3199021163448808, 0.9999294194028285, 0.9999048043834554, 0.9999456025048317, 0.9999592018786237, 0.999833407671047, 0.9999714649870586, 0.0, 1.0, 1.0]
    @test rescale_to_unit([2.0, 3.0, -1.0, 4.0, -1.9494985562533456, 4.0, 100000.0, -100000.0, -1.0, 4.0]) == [0.50001, 0.500015, 0.499995, 0.50002, 0.49999025250721874, 0.50002, 1.0, 0.0, 0.499995, 0.50002]
    @test rescale_to_unit([-100000.0, 8.620022473016821, 5.0, 11.0, 13.0, -5.5, 14.803481340003744, -147046.595120599, 19.0, 23.38614527981872, -100000.0, 14.803481340003744]) == [0.31989257573607993, 0.9998995979826766, 0.9998749836974101, 0.9999157806020426, 0.9999293795702533, 0.9998035891143033, 0.9999416423129591, 0.0, 0.9999701764748857, 1.0, 0.31989257573607993, 0.9999416423129591]
    @test rescale_to_unit([-1.0, 6.361720364471644, 5.0, 7.0, 9.0, 11.0, 13.0, 15.0, 17.0, 19.0, 7.277367751488355]) == [0.0, 0.3680860182235822, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 0.4138683875744178]
    @test rescale_to_unit([2.0, 4.0, 4.0, 5.0e-9, 4.0, 100000.0, -100000.0, -1.2176086883151271, 4.0, 4.0]) == [0.50001, 0.50002, 0.50002, 0.500000000000025, 0.50002, 1.0, 0.0, 0.49999391195655846, 0.50002, 0.50002]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 5.0, 15.0, 17.0, 19.0, 5.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.3, 0.8, 0.9, 1.0, 0.3]
    @test rescale_to_unit([-3.0, 0.46837860635787776, -1.2176086883151271, 0.0, 1.2451826892610212, 2.6, 7.51554490959548]) == [0.0, 0.329833464283241, 0.16950061333088245, 0.28529192027533323, 0.40370544044629336, 0.5325449178472886, 1.0]
    @test rescale_to_unit([-5.0, 10.151375828019562, 4.0, -0.1, -1.2176086883151271, 0.8986163754356359, 2.6]) == [0.0, 1.0, 0.5940054620885469, 0.3234029738037644, 0.24964012209967534, 0.38931226064152386, 0.5016046124303285]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 5.0, 11.0, 13.0, -5.5, 8.9984541936865, 19.0, -100000.0, 19.0, -5.5, 19.0, -5.5]) == [0.0, 0.999894247490881, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9997550465411572, 0.9999000035412641, 1.0, 0.0, 1.0, 0.9997550465411572, 1.0, 0.9997550465411572]
    @test rescale_to_unit([-10.0, -5.5, -1.0, -0.1, -0.1, -0.1, -0.1, -10.0, -5.5, -1.0]) == [0.0, 0.45454545454545453, 0.9090909090909091, 1.0, 1.0, 1.0, 1.0, 0.0, 0.45454545454545453, 0.9090909090909091]
    @test rescale_to_unit([-100000.0, 8.422739790413504, 12.900300750606242, 5.0, 11.0, 13.0, 17.0, 19.0]) == [0.0, 0.999894247490881, 0.9999390145947331, 0.999860026594947, 0.9999200151971126, 0.9999400113978344, 0.9999800037992781, 1.0]
    @test rescale_to_unit([11.0, -0.1, -1.2176086883151271, 0.0, 1.3, 2.6, -0.31657732340816347, 0.0, 3.458912167325974, 11.0]) == [1.0, 0.09147524010848404, 0.0, 0.09966014785525446, 0.20606394856326984, 0.31246774927128523, 0.07374858598710127, 0.09966014785525446, 0.3827689177927025, 1.0]
    @test rescale_to_unit([1.0, 2.0, 3.0, 3.0, 4.0, 5.0]) == [0.0, 0.25, 0.5, 0.5, 0.75, 1.0]
    @test rescale_to_unit([-5.0, -2.0, -1.0]) == [0.0, 0.75, 1.0]
    @test rescale_to_unit([-5.0, -2.0, 0.0, 1.0, 3.0]) == [0.0, 0.375, 0.625, 0.75, 1.0]
    @test rescale_to_unit([1.1, 2.2, 3.3]) == [0.0, 0.5000000000000001, 1.0]
    @test rescale_to_unit([5.0, -3.0, 1.0, 2.0, 5.0, 0.0]) == [1.0, 0.0, 0.5, 0.625, 1.0, 0.375]
    @test rescale_to_unit([1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0]) == [0.0, 0.05263157894736842, 0.10526315789473684, 0.15789473684210525, 0.21052631578947367, 0.2631578947368421, 0.3157894736842105, 0.3684210526315789, 0.42105263157894735, 0.47368421052631576, 0.5263157894736842, 0.5789473684210527, 0.631578947368421, 0.6842105263157895, 0.7368421052631579, 0.7894736842105263, 0.8421052631578947, 0.8947368421052632, 0.9473684210526315, 1.0]
    @test rescale_to_unit([-4.0, 4.0]) == [0.0, 1.0]
    @test rescale_to_unit([-1.0, -2.0, -3.0, -4.0]) == [1.0, 0.6666666666666666, 0.3333333333333333, 0.0]
    @test rescale_to_unit([5.0, 6.0, 7.0, 8.0]) == [0.0, 0.3333333333333333, 0.6666666666666666, 1.0]
    @test rescale_to_unit([3.4028235e38, -3.4028235e38]) == [1.0, 0.0]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 1.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0, 11.0, -1.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0, 0.25]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 4.0, 6.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.5, 0.7]
    @test rescale_to_unit([1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 2.0]) == [0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 1.0, 0.3333333333333333]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.49752129843287196, 1.0, 0.49752129843287196, 0.49752129843287196, 0.9950425968657439, 0.9950425968657439, 0.9950425968657439, 0.9950425968657439]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0]
    @test rescale_to_unit([2.3974061228253545, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.0]) == [0.19870306141267724, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 2.0, 4.0, 3.0]) == [0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 1.0, 0.3333333333333333, 1.0, 0.6666666666666666]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([1.0, 2.0, 2.0, 3.0, 4.0, 2.0]) == [0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 0.3333333333333333]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5]
    @test rescale_to_unit([0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 1.0]) == [0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5]
    @test rescale_to_unit([-5.0, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 2.0, 3.0]) == [0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 1.0, 0.3333333333333333, 0.6666666666666666]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.15625, 0.5]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 11.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 1.0]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6, 11.0]) == [0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.03571428571428571, 0.3071428571428571, 0.39999999999999997, 0.3798357534627028, 0.39999999999999997, 1.0]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.0, 0.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.5385438667434284]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 3.7435131776430204, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 0.8717565888215102, 1.0, 1.0]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.3084506581856825, 0.0, 1.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.16611421015887298, 0.0, 0.5385438667434284, 0.5385438667434284]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.63532512522154, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.5000181766256261, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876]
    @test rescale_to_unit([2.317700548477839, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, -0.5]) == [0.3798357534627028, 0.0, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.6579213422902667, 0.5714285714285714, 0.7142857142857143, 0.8571428571428571, 1.0, 0.17857142857142858]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0, 1.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5, 0.375]
    @test rescale_to_unit([1.0, -0.1, 2.0, 4.0, 4.0]) == [0.26829268292682934, 0.0, 0.5121951219512195, 1.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.49752129843287196, 1.0, 0.49752129843287196, 0.49752129843287196, 0.9950425968657439, 0.9950425968657439, 0.9950425968657439]
    @test rescale_to_unit([2.0, 2.604901901518098, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.5000130245095076, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 11.0, -5.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.604901901518098, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 100000.0]) == [0.50001, 0.5000130245095076, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 1.0]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0, 5.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5, 0.625]
    @test rescale_to_unit([0.0, 0.0, 0.0, 1.3, 0.0, 0.0, 1.0]) == [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.7692307692307692]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 4.0]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0, 0.9973080733816876]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 15.0, 100000.0, 1.8803882689883606, -100000.0, 100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.500075, 1.0, 0.5000094019413449, 0.0, 1.0]
    @test rescale_to_unit([-5.0, -2.1195243965065043, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.18002972521834348, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 2.0, 4.0, 6.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.3, 0.5, 0.7]
    @test rescale_to_unit([2.0, 2.3613347876448154, 4.009964202838896, 3.0, 2.604901901518098, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.17977175271801463, 1.0, 0.49752129843287196, 0.3009515794677973, 0.9950425968657439, 0.9950425968657439, 0.9950425968657439, 0.9950425968657439]
    @test rescale_to_unit([-5.0, -2.1195243965065043, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 9.0]) == [0.0, 0.18002972521834348, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.875]
    @test rescale_to_unit([-5.0, -2.1195243965065043, 3.093771311909787, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.18002972521834348, 0.5058607069943617, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.1948658640064189, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0, 11.0, 11.0, -5.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0, 1.0, 0.0]
    @test rescale_to_unit([2.3974061228253545, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.0, 3.0]) == [0.19870306141267724, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 1.0, 1.0, 1.0, 0.5]
    @test rescale_to_unit([2.3974061228253545, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.95439506042047, 4.0, 3.0]) == [0.1345135348177828, 0.0, 0.3384787679199815, 0.3384787679199815, 0.6243091497427591, 0.3384787679199815, 0.676957535839963, 0.676957535839963, 0.676957535839963, 1.0, 0.676957535839963, 0.3384787679199815]
    @test rescale_to_unit([1.0, 2.0, 3.0, 4.0, 2.0]) == [0.0, 0.3333333333333333, 0.6666666666666666, 1.0, 0.3333333333333333]
    @test rescale_to_unit([2.3974061228253545, 2.7499191886213326, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.0, 2.3974061228253545]) == [0.19870306141267724, 0.3749595943106663, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 1.0, 1.0, 1.0, 0.19870306141267724]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.3, 0.5, 0.2987978284968885, 0.7, 0.3]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.63532512522154, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.5000181766256261, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0]
    @test rescale_to_unit([13.0, 0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 1.0]) == [1.0, 0.0, 0.02372697370659096, 0.0, 0.0, 0.0, 0.07692307692307693]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825]) == [0.45822205940851846, 0.45822205940851846, 0.7291110297042592, 0.7291110297042592, 0.7291110297042592, 1.0, 1.0, 1.0, 0.0]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0]) == [0.5000094542896366, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([0.0, 2.6, 0.0, 0.0, 0.0, 0.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.3846153846153846]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 9.0, 11.0, -1.0, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.875, 1.0, 0.25, 0.5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 0.3084506581856825]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0, 0.0]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 2.7499191886213326, 3.0, 4.0, 4.0, 1.89085792733363, 100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.5000137495959431, 0.500015, 0.50002, 0.50002, 0.5000094542896366, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.132612632596544, 4.0, 4.0, 4.0, 0.3084506581856825]) == [0.45822205940851846, 0.45822205940851846, 0.7291110297042592, 0.7291110297042592, 0.7650343291965445, 1.0, 1.0, 1.0, 0.0]
    @test rescale_to_unit([-0.5100337078730766, -0.7560991815460972, 0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 1.0]) == [0.1401204876460228, 0.0, 0.4305560810525609, 0.6062014326517329, 0.4305560810525609, 0.4305560810525609, 0.4305560810525609, 1.0]
    @test rescale_to_unit([-5.0, 3.132612632596544, -3.0, 1.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.508288289537284, 0.125, 0.375, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([-0.1, 2.0, 3.63532512522154, 4.0]) == [0.0, 0.5121951219512195, 0.9110549085906197, 1.0]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0, 1.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5, 0.375]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.1948658640064189, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 2.0, 1.9879782849688847, 6.0, 2.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.3, 0.2987978284968885, 0.7, 0.3]
    @test rescale_to_unit([0.0, 2.6, 0.0, 0.0, 0.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.0, 0.3846153846153846]
    @test rescale_to_unit([7.0, 3.0, 9.0, 2.0, 4.0, 6.0]) == [0.7142857142857143, 0.14285714285714285, 1.0, 0.0, 0.2857142857142857, 0.5714285714285714]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 9.0, 11.0, -1.0, 3.0, 1.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.875, 1.0, 0.25, 0.5, 0.375]
    @test rescale_to_unit([-5.5, -1.0, -1.0, -0.5, -0.1]) == [0.0, 0.8333333333333333, 0.8333333333333333, 0.9259259259259258, 1.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.132612632596544, 4.0, 4.0, 0.3084506581856825]) == [0.45822205940851846, 0.45822205940851846, 0.7291110297042592, 0.7291110297042592, 0.7650343291965445, 1.0, 1.0, 0.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0]) == [0.0, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.5714285714285714, 0.7142857142857143, 0.8571428571428571, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 2.6, 4.0, 4.0]) == [0.0, 0.0, 0.49752129843287196, 1.0, 0.49752129843287196, 0.49752129843287196, 0.9950425968657439, 0.9950425968657439, 0.29851277905972323, 0.9950425968657439, 0.9950425968657439]
    @test rescale_to_unit([-5.0, 8.485686893878379, -1.8821461758972977, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, -1.8821461758972977]) == [0.0, 0.8428554308673987, 0.1948658640064189, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.1948658640064189]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 17.0, 4.424148152025293, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.10134166141047106, 0.10134166141047106, 0.16125221731643966, 0.22175973415364636, 0.16125221731643966, 0.16125221731643966, 0.22116277322240827, 1.0, 0.24657372479673287, 0.0, 0.22116277322240827, 0.0]
    @test rescale_to_unit([7.0, 3.0, 15.0, -1.0, -5.0, 2.0, 4.0, 6.0, 3.0]) == [0.6, 0.4, 1.0, 0.2, 0.0, 0.35, 0.45, 0.55, 0.4]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75]
    @test rescale_to_unit([0.0, -10.0, 0.0, 1.3, 0.0, 0.0, -12.900064462349789, 1.0]) == [0.9084511198208406, 0.20422896459653775, 0.9084511198208406, 1.0, 0.9084511198208406, 0.9084511198208406, 0.0, 0.9788733353432708]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, -0.2950823455421112, 0.0, 1.0]) == [0.22784832683252437, 0.22784832683252437, 0.22784832683252437, 0.22784832683252437, 0.0, 0.22784832683252437, 1.0]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0]) == [1.0, 0.5, 0.0, 0.375, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375]
    @test rescale_to_unit([-5.0, -3.0, 0.3128608452500923, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.125, 0.3320538028281308, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, -100000.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 0.9999831776783776, 0.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 2.0, 4.0, 6.0, 3.0, 7.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.3, 0.5, 0.7, 0.4, 0.8]
    @test rescale_to_unit([-0.5100337078730766, -0.7560991815460972, 0.0, 0.0, 0.927368319637066, 0.0, 0.0, 1.0]) == [0.1401204876460228, 0.0, 0.4305560810525609, 0.4305560810525609, 0.9586403312943932, 0.4305560810525609, 0.4305560810525609, 1.0]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.047004414913656, 5.0, 9.0, 11.0, -1.0, 3.0, 1.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5029377759321035, 0.625, 0.875, 1.0, 0.25, 0.5, 0.375]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, 4.0, 100000.0, -100000.0, 100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 1.0, 0.0, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 2.0, 6.210898792063733, 5.0, 7.0, 9.0]) == [0.0, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.5, 0.8007784851474096, 0.7142857142857143, 0.8571428571428571, 1.0]
    @test rescale_to_unit([7.0, 3.0, 15.0, -1.0, -5.0, 2.0, 4.0, 6.0, 3.0, -5.0, 6.0]) == [0.6, 0.4, 1.0, 0.2, 0.0, 0.35, 0.45, 0.55, 0.4, 0.0, 0.55]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -1.9243870830593395, 1.3, 2.6, -2.033802097685287, 2.317700548477839, 2.6, 11.0, -1.9243870830593395]) == [0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.07682949406719004, 0.3071428571428571, 0.39999999999999997, 0.06901413587962235, 0.3798357534627028, 0.39999999999999997, 1.0, 0.07682949406719004]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, -2.5, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 3.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.4999875, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.500015]
    @test rescale_to_unit([1.0, 2.0, 1.0, 3.0, 4.0, 2.0]) == [0.0, 0.3333333333333333, 0.0, 0.6666666666666666, 1.0, 0.3333333333333333]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 3.7435131776430204, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 0.8717565888215102, 1.0, 1.0, 0.5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 2.604901901518098, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.5000130245095076, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6, 11.0, 2.6]) == [0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.03571428571428571, 0.3071428571428571, 0.39999999999999997, 0.3798357534627028, 0.39999999999999997, 1.0, 0.39999999999999997]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 2.0, 6.210898792063733, 5.0, 9.0]) == [0.0, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.5, 0.8007784851474096, 0.7142857142857143, 1.0]
    @test rescale_to_unit([0.0, 0.1581270304608839, 0.0, 0.0, 0.0]) == [0.0, 1.0, 0.0, 0.0, 0.0]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0, -1.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5, 0.25]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 1.377524891878108, 2.0, 1.9879782849688847, 6.0, 2.0]) == [0.8, 0.4, 1.0, 0.0, 0.2377524891878108, 0.3, 0.2987978284968885, 0.7, 0.3]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 4.0, 4.295988999465306, 6.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.5, 0.5295988999465306, 0.7]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 13.0, 15.0, 17.0, 19.0, 17.0, 17.0]) == [0.0, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0, 0.9, 0.9]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, 4.0]) == [0.0, 0.0, 1.000020000400008e-5, 1.000020000400008e-5, 1.000020000400008e-5, 2.000040000800016e-5, 2.000040000800016e-5, 2.000040000800016e-5, 1.0, 2.000040000800016e-5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 2.604901901518098, 2.996533149237559, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.5000130245095076, 0.5000149826657462, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([2.331382164224474, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 17.0, 4.424148152025293, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.12119495108648229, 0.10134166141047106, 0.16125221731643966, 0.22175973415364636, 0.16125221731643966, 0.16125221731643966, 0.22116277322240827, 1.0, 0.24657372479673287, 0.0, 0.22116277322240827, 0.0]
    @test rescale_to_unit([2.0, 6.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 4.0]) == [0.29720366814479654, 1.0, 0.29720366814479654, 0.4729027511085974, 0.6503525353736576, 0.4729027511085974, 0.4729027511085974, 0.6486018340723982, 0.6486018340723982, 0.6486018340723982, 0.0, 0.6486018340723982, 0.0, 0.6486018340723982]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, -0.2950823455421112, 100000.0, -100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.500015, 0.50002, 0.49999852458827226, 1.0, 0.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0]) == [0.0, 0.0, 0.49752129843287196, 1.0, 0.49752129843287196, 0.49752129843287196, 0.9950425968657439, 0.9950425968657439]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 1.9879782849688847, 6.0, 2.0, 2.0, 3.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.2987978284968885, 0.7, 0.3, 0.3, 0.4]
    @test rescale_to_unit([-5.0, -2.1195243965065043, 3.093771311909787, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, -5.0]) == [0.0, 0.18002972521834348, 0.5058607069943617, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.9879782849688847, -1.0, 2.0, 2.0, 4.0, 6.0, 3.0]) == [0.8, 0.4, 1.0, 0.2987978284968885, 0.0, 0.3, 0.3, 0.5, 0.7, 0.4]
    @test rescale_to_unit([7.0, 3.0, 9.0, 6.0, 2.0, 2.0, 2.709339832728434, 4.0, 6.0, 3.0, 7.0, 3.0]) == [0.7142857142857143, 0.14285714285714285, 1.0, 0.5714285714285714, 0.0, 0.0, 0.10133426181834773, 0.2857142857142857, 0.5714285714285714, 0.14285714285714285, 0.7142857142857143, 0.14285714285714285]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 1.9879782849688847, 6.0, 2.0, 2.0, 3.0, 7.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.2987978284968885, 0.7, 0.3, 0.3, 0.4, 0.8]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 2.6, 4.0, -0.5, 6.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.36, 0.5, 0.05, 0.7]
    @test rescale_to_unit([-5.0, -3.0, 1.0, 3.0, 5.0, 7.0, 9.0, 11.0, 7.0]) == [0.0, 0.125, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0, 0.75]
    @test rescale_to_unit([-5.0, -3.9359140818779, -1.0, 10.012494985460352, 1.0, 3.0, 5.0, 7.0, 9.0, 11.0, -1.0]) == [0.0, 0.06650536988263125, 0.25, 0.938280936591272, 0.375, 0.5, 0.625, 0.75, 0.875, 1.0, 0.25]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 17.0, 4.424148152025293, 0.3084506581856825, 4.0, 0.3084506581856825, 2.0]) == [0.10134166141047106, 0.10134166141047106, 0.16125221731643966, 0.22175973415364636, 0.16125221731643966, 0.16125221731643966, 0.22116277322240827, 1.0, 0.24657372479673287, 0.0, 0.22116277322240827, 0.0, 0.10134166141047106]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 2.6, 2.317700548477839, 2.6, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 1.0, 0.9495893836567572, 1.0, 1.0]
    @test rescale_to_unit([2.3974061228253545, 2.7499191886213326, -0.2950823455421112, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.009964202838896, 2.3974061228253545]) == [0.6254260989071131, 0.7073097816581271, 0.0, 0.7653999343587325, 0.7653999343587325, 0.9615548095000674, 0.7653999343587325, 0.9976854599068985, 0.9976854599068985, 0.9976854599068985, 1.0, 0.6254260989071131]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, 2.0, 4.0, 6.0, 3.0, 6.941347396260423]) == [1.0, 0.5, 0.0, 0.375, 0.375, 0.625, 0.875, 0.5, 0.9926684245325529]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0, -2.5]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5, 0.15625]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 9.0, 11.0, -1.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.875, 1.0, 0.25]
    @test rescale_to_unit([-5.0, -3.0, 0.3128608452500923, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, -5.0]) == [0.0, 0.125, 0.3320538028281308, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, -2.212238668183224, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.1742350832385485, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75]
    @test rescale_to_unit([11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09090909090909091, 0.0]
    @test rescale_to_unit([2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, -100000.0, 3.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 0.9999831776783776, 0.0, 0.999990000399984]
    @test rescale_to_unit([13.0, 0.0, 0.0, 0.0, 0.0, 1.0]) == [1.0, 0.0, 0.0, 0.0, 0.0, 0.07692307692307693]
    @test rescale_to_unit([7.0, 3.0, 15.0, -1.0, -5.0, 2.0, 6.0, 3.0, 4.0]) == [0.6, 0.4, 1.0, 0.2, 0.0, 0.35, 0.55, 0.4, 0.45]
    @test rescale_to_unit([3.6010757126300734, 2.0, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 3.7435131776430204, 4.0, 4.0]) == [0.8005378563150367, 0.0, 0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 0.8717565888215102, 1.0, 1.0]
    @test rescale_to_unit([1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 2.0, 3.0, 4.0]) == [0.0, 0.3333333333333333, 0.3333333333333333, 0.6666666666666666, 1.0, 1.0, 0.3333333333333333, 0.6666666666666666, 1.0]
    @test rescale_to_unit([-0.5100337078730766, -2.5869330155418675, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2806228932579327, 0.15081668652863328, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.15625, 0.5]
    @test rescale_to_unit([-5.0, 3.844455868175311, 1.0, 3.0, 5.0, 4.833878055412355, 9.0, 11.0, 7.0]) == [0.0, 0.552778491760957, 0.375, 0.5, 0.625, 0.6146173784632722, 0.875, 1.0, 0.75]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, -3.6497815875309945, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.47203855153246277, 0.6614970533978501, 0.07966939295929135, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 4.5024139185226595, 6.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0, 3.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.5000225120695926, 0.50003, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002, 0.500015]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.63532512522154, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0]) == [0.50001, 0.5000092842947599, 0.5000181766256261, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 2.996533149237559, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.5000149826657462, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([-3.0, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6, 2.6]) == [0.0, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0, 1.0]
    @test rescale_to_unit([-5.0, -3.0, 1.0, 2.9770126806470683, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.125, 0.375, 0.49856329254044174, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 13.0]) == [0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.4444444444444444, 0.6228277106702075, 0.5555555555555556, 0.6666666666666666, 0.7777777777777778, 1.0]
    @test rescale_to_unit([13.0, 0.0, 0.0, 0.0, 0.0, 17.0]) == [0.7647058823529411, 0.0, 0.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0, 3.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75, 0.5]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, -2.870785908662275, 5.0, 7.0, 9.0, 11.0, -1.0]) == [0.0, 0.125, 0.25, 0.375, 0.5, 0.13307588070860782, 0.625, 0.75, 0.875, 1.0, 0.25]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 6.89535009486304, 11.0, 6.210898792063733]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.74345938092894, 1.0, 0.7006811745039834]
    @test rescale_to_unit([-3.0, -1.5885610609142073, -1.2, 0.0, -1.9243870830593395, 1.3, 2.6, -2.033802097685287, 2.317700548477839, 2.6, 11.0, -1.9243870830593395]) == [0.0, 0.10081706707755662, 0.1285714285714286, 0.21428571428571427, 0.07682949406719004, 0.3071428571428571, 0.39999999999999997, 0.06901413587962235, 0.3798357534627028, 0.39999999999999997, 1.0, 0.07682949406719004]
    @test rescale_to_unit([-3.0, -1.2, 0.0, -2.5, 1.991219214535127, 2.6, 2.317700548477839, 2.6, 2.6]) == [0.0, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.8912891454527012, 1.0, 0.9495893836567572, 1.0, 1.0]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6, -1.2]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0, 0.32142857142857145]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.132612632596544, 4.0, 4.0, 4.0, 0.3084506581856825, 2.3242811798678176]) == [0.45822205940851846, 0.45822205940851846, 0.7291110297042592, 0.7291110297042592, 0.7650343291965445, 1.0, 1.0, 1.0, 0.0, 0.5460662543091995]
    @test rescale_to_unit([7.0, 3.0, -1.0, -5.0, 2.0, 4.0, 6.0, 3.0, -5.0, 6.0]) == [1.0, 0.6666666666666666, 0.3333333333333333, 0.0, 0.5833333333333334, 0.75, 0.9166666666666666, 0.6666666666666666, 0.0, 0.9166666666666666]
    @test rescale_to_unit([8.485686893878379, 2.0, 2.604901901518098, 3.0, 3.0, 4.0, 4.0, 4.0, -3.0, -100000.0, 100000.0]) == [0.5000424284344694, 0.50001, 0.5000130245095076, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.499985, 0.0, 1.0]
    @test rescale_to_unit([1.0, 2.0, 3.0, 4.0, 19.0]) == [0.0, 0.05555555555555555, 0.1111111111111111, 0.16666666666666666, 1.0]
    @test rescale_to_unit([1.0, 2.0, 3.0, 19.0]) == [0.0, 0.05555555555555555, 0.1111111111111111, 1.0]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, -0.2950823455421112, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0]) == [1.0, 0.5, 0.0, 0.375, 0.0881147068072361, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.77124784854875, 3.0, 3.0, 4.0, 4.0, 4.0, 3.3437558978820334, 100000.0, -100000.0, 4.0, 100000.0]) == [0.50001, 0.50001, 0.500015, 0.5000188562392427, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.5000167187794894, 1.0, 0.0, 0.50002, 1.0]
    @test rescale_to_unit([7.0, 3.0, 15.0, -1.0, -0.9053077270335478, -5.0, 6.0, 3.0, 3.7435131776430204, 15.0]) == [0.6, 0.4, 1.0, 0.2, 0.20473461364832263, 0.0, 0.55, 0.4, 0.43717565888215104, 1.0]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0]
    @test rescale_to_unit([2.3974061228253545, 2.0, 1.5971393412498083, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.95439506042047, 4.0, 3.0]) == [0.2383693255791772, 0.11999701317053972, 0.0, 0.4178593399184791, 0.4178593399184791, 0.6693909296491285, 0.4178593399184791, 0.7157216666664186, 0.7157216666664186, 0.7157216666664186, 1.0, 0.7157216666664186, 0.4178593399184791]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, -0.9053077270335478, 4.0, 4.0, 4.0, 4.0]) == [0.5910777203142337, 0.5910777203142337, 0.7945252638616261, 1.0, 0.7945252638616261, 0.0, 0.9979728074090186, 0.9979728074090186, 0.9979728074090186, 0.9979728074090186]
    @test rescale_to_unit([-5.0, -3.0, -0.3115474205775115, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 11.0]) == [0.0, 0.125, 0.29302828621390553, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 1.0]
    @test rescale_to_unit([7.0, 1.89085792733363, 3.0, -1.0, 2.0, -0.2950823455421112, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0]) == [1.0, 0.36135724091670374, 0.5, 0.0, 0.375, 0.0881147068072361, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 2.0, 6.0, 3.0, 7.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.3, 0.7, 0.4, 0.8]
    @test rescale_to_unit([-5.0, 3.844455868175311, 1.0, 3.0, 5.0, 1.5971393412498083, 9.0, 11.0, 7.0]) == [0.0, 0.552778491760957, 0.375, 0.5, 0.625, 0.412321208828113, 0.875, 1.0, 0.75]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 2.996533149237559, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7262117127559281, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876]
    @test rescale_to_unit([2.3974061228253545, 2.0, 1.5971393412498083, -2.1195243965065043, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.95439506042047, 4.0, 3.0]) == [0.6385329302708921, 0.5823538734912445, 0.5254037398060638, 0.0, 0.7237182198184807, 0.8430941716252824, 0.7237182198184807, 0.865082566145717, 0.865082566145717, 0.865082566145717, 1.0, 0.865082566145717, 0.7237182198184807]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 4.0, 6.0, -1.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.5, 0.7, 0.0]
    @test rescale_to_unit([-3.9436012405046843, -1.0, 1.0, 3.0, 5.0, 2.6, 7.0, 9.0]) == [0.0, 0.22741748496494243, 0.38193398797195394, 0.5364504909789655, 0.6909669939859769, 0.5055471903775632, 0.8454834969929885, 1.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, -5.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.0, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, -2.212238668183224, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, -2.212238668183224, 7.0, -2.033802097685287]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.1742350832385485, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.1742350832385485, 0.75, 0.18538736889466956]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.89085792733363, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.1948658640064189, 0.25, 0.43067862045835187, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, 4.009964202838896, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0]) == [1.0, 0.5, 0.0, 0.375, 0.626245525354862, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375]
    @test rescale_to_unit([-5.0, 3.132612632596544, -3.0, 1.0, 6.210898792063733, 5.0, 7.0, 9.0, 2.709339832728434, 7.0]) == [0.0, 0.5809009023283246, 0.14285714285714285, 0.42857142857142855, 0.8007784851474096, 0.7142857142857143, 0.8571428571428571, 1.0, 0.5506671309091739, 0.8571428571428571]
    @test rescale_to_unit([3.6010757126300734, 2.0, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 7.0, 3.7435131776430204, 4.0, 4.0]) == [0.3202151425260147, 0.0, 0.0, 0.2, 0.2, 0.36889117363506224, 0.2, 0.4, 1.0, 0.3487026355286041, 0.4, 0.4]
    @test rescale_to_unit([-1.0, 3.0, 9.0, -1.0, 2.0, 2.0, 1.9879782849688847, 6.0, 2.0]) == [0.0, 0.4, 1.0, 0.0, 0.3, 0.3, 0.2987978284968885, 0.7, 0.3]
    @test rescale_to_unit([7.0, 3.286574222026122, 3.0, -1.0, 2.0, 4.009964202838896, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0]) == [1.0, 0.5358217777532652, 0.5, 0.0, 0.375, 0.626245525354862, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, -1.0, -2.5, 3.0]) == [0.320711878009066, 0.0, 0.2118712787367652, 0.0, 0.2857142857142857, 0.42857142857142855, 0.5714285714285714, 0.7142857142857143, 0.7110282186014621, 0.17857142857142858, 1.0, 0.2857142857142857, 0.17857142857142858, 0.5714285714285714]
    @test rescale_to_unit([7.0, 3.0, 2.0, 2.0, 6.0, 3.0, 7.0, 2.0]) == [1.0, 0.2, 0.0, 0.0, 0.8, 0.2, 1.0, 0.0]
    @test rescale_to_unit([7.0, 3.0, 15.0, -1.0, -5.0, 2.0, 4.0, 6.0, 3.0, -5.0, 6.0, 3.0]) == [0.6, 0.4, 1.0, 0.2, 0.0, 0.35, 0.45, 0.55, 0.4, 0.0, 0.55, 0.4]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.132612632596544, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.5, 0.566306316298272, 1.0, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, -1.0, -5.0, 2.0, 4.0, 6.0, -5.0, 6.0]) == [1.0, 0.6666666666666666, 0.3333333333333333, 0.0, 0.5833333333333334, 0.75, 0.9166666666666666, 0.0, 0.9166666666666666]
    @test rescale_to_unit([2.0, -3.6497815875309945, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, -100000.0, 2.317700548477839]) == [0.999980000799968, 0.9999235052439149, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 0.9999831776783776, 0.0, 0.9999831776783776]
    @test rescale_to_unit([-5.0, -3.0, 3.0, 4.009964202838896, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, -5.0]) == [0.0, 0.125, 0.5, 0.563122762677431, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.6728877465517957, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, -100000.0]) == [0.999980000799968, 0.999980000799968, 0.9999967290083052, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 1.0, 0.0]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.0, 1.0, 1.8568589519865748]) == [0.0, 1.0, 0.0, 0.0, 0.0, 0.5385438667434284, 1.0]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 5.423014615696999, 9.0, 11.0, -1.0, 3.0, 5.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6514384134810625, 0.875, 1.0, 0.25, 0.5, 0.625]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 9.0, 11.0, -1.0, 3.0, -2.033802097685287]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.875, 1.0, 0.25, 0.5, 0.18538736889466956]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 1.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.375, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.89085792733363, 3.0, 6.210898792063733, 5.0, 7.0, 9.0]) == [0.0, 0.22270384457876444, 0.2857142857142857, 0.49220413766668786, 0.5714285714285714, 0.8007784851474096, 0.7142857142857143, 0.8571428571428571, 1.0]
    @test rescale_to_unit([-4.747059300613937, -0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0, -2.5]) == [0.01580879371162891, 0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5, 0.15625]
    @test rescale_to_unit([13.0, 0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 0.1581270304608839, 1.0]) == [1.0, 0.0, 0.02372697370659096, 0.0, 0.0, 0.0, 0.0121636177277603, 0.07692307692307693]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.3084506581856825, 0.0, 0.546353249751977, 1.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.16611421015887298, 0.0, 0.2942351917292677, 0.5385438667434284, 0.5385438667434284]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0, 4.0]) == [0.5000094542896366, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002, 0.50002]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 1.0, 100000.0, 1.8568589519865748, 1.8568589519865748]) == [0.0, 1.8568589519865747e-5, 0.0, 0.0, 1.0e-5, 1.0, 1.8568589519865747e-5, 1.8568589519865747e-5]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 3.0, 1.0]) == [0.0, 0.16666666666666666, 0.3333333333333333, 0.5, 0.6666666666666666, 0.8333333333333334, 1.0, 0.6666666666666666, 0.5]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 9.0, -5.0, 11.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.875, 0.0, 1.0]
    @test rescale_to_unit([2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 2.317700548477839, -100000.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 0.9999831776783776, 0.0]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -10.0, 1.0, 3.0, 8.214348434556833, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.23809523809523808, 0.3865644678144144, 0.0, 0.5238095238095238, 0.6190476190476191, 0.8673499254550873, 0.7719475615268445, 0.7142857142857143, 0.8095238095238095, 0.9047619047619048, 1.0, 0.7719475615268445]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.38904762141515903, 0.0, 1.0, 100000.0, 1.8568589519865748, 1.8568589519865748, 0.0, 1.0]) == [0.0, 1.8568589519865747e-5, 3.890476214151591e-6, 0.0, 1.0e-5, 1.0, 1.8568589519865747e-5, 1.8568589519865747e-5, 0.0, 1.0e-5]
    @test rescale_to_unit([2.0, 3.0, 3.0, 2.093512706816888, 3.0, 4.0, 4.0, 2.317700548477839, -100000.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 0.9999809358896327, 0.999990000399984, 1.0, 1.0, 0.9999831776783776, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.5]
    @test rescale_to_unit([7.0, 15.0, -1.0, -5.0, 2.0, 4.0, 6.0, 3.0, -5.0, 6.0, 3.0]) == [0.6, 1.0, 0.2, 0.0, 0.35, 0.45, 0.55, 0.4, 0.0, 0.55, 0.4]
    @test rescale_to_unit([2.0, 2.0, -2.1195243965065043, 4.009964202838896, 2.996533149237559, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 3.0]) == [0.6720828874608641, 0.6720828874608641, 0.0, 1.0, 0.8346630331102065, 0.8352286350696932, 0.9983743826785223, 0.9983743826785223, 0.9983743826785223, 0.3961138054733445, 0.9983743826785223, 0.8352286350696932]
    @test rescale_to_unit([-5.0, -2.033802097685287, 10.012494985460352, -1.0, 1.0, 3.0, 10.216971081237052, 5.0, 4.95439506042047, 9.0, 6.0, -1.0, 3.0, 1.0]) == [0.0, 0.19492695927983444, 0.9865626283519179, 0.26286440176863524, 0.39429660265295285, 0.5257288035372705, 1.0, 0.6571610044215881, 0.6541640256315211, 0.9200254061902233, 0.7228771048637469, 0.26286440176863524, 0.5257288035372705, 0.39429660265295285]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 2.539730481972406, 0.1581270304608839, 0.3084506581856825, 4.0]) == [0.47818038175326016, 0.47818038175326016, 0.7377967557711238, 1.0, 0.7377967557711238, 0.7377967557711238, 0.9974131297889873, 0.9974131297889873, 0.6183032524298501, 0.0, 0.03902647515912341, 0.9974131297889873]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 1.3, 6.210898792063733, 0.1581270304608839, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.3717303593318144, 0.6614970533978501, 0.30435435150989987, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([-3.0, -1.2, 0.0, -2.5, -2.5, 2.6, 2.317700548477839, 2.6, 5.0, 2.6]) == [0.0, 0.225, 0.375, 0.0625, 0.0625, 0.7, 0.6647125685597299, 0.7, 1.0, 0.7]
    @test rescale_to_unit([7.0, 15.0, -1.0, -5.0, 2.0, 6.0, 3.0, -5.0, 6.0, 3.0, 3.0]) == [0.6, 1.0, 0.2, 0.0, 0.35, 0.55, 0.4, 0.0, 0.55, 0.4, 0.4]
    @test rescale_to_unit([-5.0, 8.485686893878379, -1.8821461758972977, -1.0, 1.0, 2.7499191886213326, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, -1.8821461758972977]) == [0.0, 0.8428554308673987, 0.1948658640064189, 0.25, 0.375, 0.48436994928883326, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.1948658640064189]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0, 3.0, -5.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75, 0.5, 0.0]
    @test rescale_to_unit([-5.0, 0.927368319637066, -2.1195243965065043, 3.093771311909787, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, -5.0, 6.210898792063733]) == [0.0, 0.3704605199773166, 0.18002972521834348, 0.5058607069943617, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.0, 0.7006811745039834]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 1.8568589519865748]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.5000092842947599]
    @test rescale_to_unit([1.0, -0.1, 2.0, 4.0, 4.0, 4.0]) == [0.26829268292682934, 0.0, 0.5121951219512195, 1.0, 1.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 13.0, 2.0, 2.0, 6.0, 3.0, 7.0]) == [0.5714285714285714, 0.2857142857142857, 0.7142857142857143, 0.0, 1.0, 0.21428571428571427, 0.21428571428571427, 0.5, 0.2857142857142857, 0.5714285714285714]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, -0.2950823455421112, 2.0, 2.989630289631409, 4.0, 1.9879782849688847, 6.0, 2.0]) == [1.0, 0.5, 0.0, 0.375, 0.0881147068072361, 0.375, 0.49870378620392614, 0.625, 0.3734972856211106, 0.875, 0.375]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0, 5.0, 4.95439506042047]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5, 0.625, 0.6221496912762794]
    @test rescale_to_unit([-3.0, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.0, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0]
    @test rescale_to_unit([1.377524891878108, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 17.0, 4.424148152025293, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.0640488316452606, 0.10134166141047106, 0.16125221731643966, 0.22175973415364636, 0.16125221731643966, 0.16125221731643966, 0.22116277322240827, 1.0, 0.24657372479673287, 0.0, 0.22116277322240827, 0.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 4.0, 6.0, -1.0]) == [0.8, 0.4, 1.0, 0.0, 0.5, 0.7, 0.0]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, 2.0, 4.0, 6.0, 3.0, 6.698272723595944, 6.941347396260423]) == [1.0, 0.5, 0.0, 0.375, 0.375, 0.625, 0.875, 0.5, 0.962284090449493, 0.9926684245325529]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 9.0, 11.0, -1.0, 3.0, -2.033802097685287, 1.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.875, 1.0, 0.25, 0.5, 0.18538736889466956, 0.375]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 1.1519077916929108, 2.317700548477839, 2.6, 11.0, -3.0]) == [0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.03571428571428571, 0.3071428571428571, 0.39999999999999997, 0.2965648422637793, 0.3798357534627028, 0.39999999999999997, 1.0, 0.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0, 3.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75, 0.5]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 5.167048792887977, -3.0, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6354405495554986, 0.125, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5]
    @test rescale_to_unit([2.0, 3.0479423465957955, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 4.0]) == [0.4569885592496988, 0.740100409025187, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0, 0.9973080733816876]
    @test rescale_to_unit([2.675310403852642, 2.0, 3.6728877465517957, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, -100000.0]) == [0.9999867536338931, 0.999980000799968, 0.9999967290083052, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 1.0, 0.0]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 3.0, 4.0, 4.0, 100000.0, 100000.0]) == [1.4314370599014409e-6, 0.0, 1.143162274924463e-5, 1.143162274924463e-5, 1.143162274924463e-5, 2.1431808438587818e-5, 2.1431808438587818e-5, 1.0, 1.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, -3.6497815875309945, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.47203855153246277, 0.6614970533978501, 0.5900481894155785, 0.07966939295929135, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 2.8812658011312893, 3.0, 4.0, 17.0, 4.424148152025293, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.10134166141047106, 0.10134166141047106, 0.16125221731643966, 0.22175973415364636, 0.1541387854571654, 0.16125221731643966, 0.22116277322240827, 1.0, 0.24657372479673287, 0.0, 0.22116277322240827, 0.0]
    @test rescale_to_unit([-2.5, -1.2, 0.0, -1.9243870830593395, 1.3, 2.6, -2.033802097685287, 2.317700548477839, -100000.0, 2.6, 11.0, -1.9243870830593395]) == [0.9998650148483667, 0.999878013418524, 0.9998900120986691, 0.9998707703444316, 0.9999030106688265, 0.9999160092389837, 0.9998696763146284, 0.9999131865549638, 0.0, 0.9999160092389837, 1.0, 0.9998707703444316]
    @test rescale_to_unit([2.6, 0.0, 0.0, 0.0, 1.0]) == [1.0, 0.0, 0.0, 0.0, 0.3846153846153846]
    @test rescale_to_unit([-2.212238668183224, 0.0, 1.8568589519865748, 0.0, 0.0, 0.3084506581856825, 0.0, 1.0, 1.0]) == [0.0, 0.5436681236688811, 1.0, 0.5436681236688811, 0.5436681236688811, 0.6194713328759414, 0.5436681236688811, 0.7894228568665258, 0.7894228568665258]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -3.271286856294544, 1.3, 2.6, 1.1519077916929108, 2.317700548477839, 2.6, 11.0, -3.0, 1.3]) == [0.01900927779157416, 0.054044660727589365, 0.1451366563612289, 0.2292215754076654, 0.0, 0.320313571041305, 0.4114055666749445, 0.30993663658554693, 0.3916246279015325, 0.4114055666749445, 1.0, 0.01900927779157416, 0.320313571041305]
    @test rescale_to_unit([7.0, 3.286574222026122, 3.0, -1.0, 2.940752465498065, 4.009964202838896, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0, 2.0]) == [1.0, 0.5358217777532652, 0.5, 0.0, 0.4925940581872581, 0.626245525354862, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375, 0.375]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 3.0, 4.0, 2.3974061228253545, 100000.0, -100000.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.500015, 0.50002, 0.5000119870306141, 1.0, 0.0]
    @test rescale_to_unit([-5.0, -3.0, 0.3128608452500923, 3.0, 6.210898792063733, 0.3128608452500923, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.125, 0.3320538028281308, 0.5, 0.7006811745039834, 0.3320538028281308, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([-0.3440825794661051, -3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.47427096795248125, 0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0]
    @test rescale_to_unit([2.0, -3.6497815875309945, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, -100000.0, 2.317700548477839, 3.0, 2.317700548477839]) == [0.999980000799968, 0.9999235052439149, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 0.9999831776783776, 0.0, 0.9999831776783776, 0.999990000399984, 0.9999831776783776]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6, 2.6]) == [0.0, 0.08928571428571429, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0, 1.0]
    @test rescale_to_unit([4.833878055412355, 3.0, 9.0, -1.0, 2.0, 1.9879782849688847, 6.0, 2.0, 2.0, 3.0, 7.687190467376851]) == [0.5833878055412355, 0.4, 1.0, 0.0, 0.3, 0.2987978284968885, 0.7, 0.3, 0.3, 0.4, 0.8687190467376851]
    @test rescale_to_unit([2.675310403852642, 2.0, 3.6728877465517957, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, -100000.0, 2.675310403852642]) == [0.9999867536338931, 0.999980000799968, 0.9999967290083052, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 1.0, 0.0, 0.9999867536338931]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 2.996533149237559, 4.0, 100000.0, -100000.0, 4.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.5000149826657462, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.3084506581856825, 0.0, 0.0, 0.546353249751977, 1.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.16611421015887298, 0.0, 0.0, 0.2942351917292677, 0.5385438667434284, 0.5385438667434284]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, -3.271286856294544, 6.89535009486304, 11.0, 6.210898792063733, -2.033802097685287, 6.210898792063733]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.108044571481591, 0.74345938092894, 1.0, 0.7006811745039834, 0.18538736889466956, 0.7006811745039834]
    @test rescale_to_unit([2.0, -3.6497815875309945, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, -100000.0, 2.317700548477839, 3.0, 17.0]) == [0.9998500254956657, 0.9997935372827866, 0.9998600237959547, 0.9998600237959547, 0.9998600237959547, 0.9998700220962436, 0.9998700220962436, 0.9998700220962436, 0.9998532019611513, 0.0, 0.9998532019611513, 0.9998600237959547, 1.0]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 9.344477625800707, 2.317700548477839, 2.6, 11.0]) == [0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.03571428571428571, 0.3071428571428571, 0.39999999999999997, 0.8817484018429076, 0.3798357534627028, 0.39999999999999997, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 1.9879782849688847, 6.0, 2.0, 3.0, 7.0]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.2987978284968885, 0.7, 0.3, 0.4, 0.8]
    @test rescale_to_unit([7.0, 3.0, 9.0, -1.0, 2.0, 4.0, 6.577002407130273]) == [0.8, 0.4, 1.0, 0.0, 0.3, 0.5, 0.7577002407130273]
    @test rescale_to_unit([-1.8821461758972977, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 7.0, 3.0, -5.0]) == [0.1948658640064189, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.75, 0.5, 0.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 4.268063860875567, 1.3, 6.210898792063733, 0.1581270304608839, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.5468604300497585, 0.3717303593318144, 0.6614970533978501, 0.30435435150989987, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, -3.271286856294544, 0.38904762141515903, 6.89535009486304, 11.0, 6.210898792063733, -2.033802097685287, 6.210898792063733, 6.210898792063733]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.108044571481591, 0.33681547633844744, 0.74345938092894, 1.0, 0.7006811745039834, 0.18538736889466956, 0.7006811745039834, 0.7006811745039834]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 1.1519077916929108, 2.317700548477839, 2.6, 11.0, -3.0]) == [0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.03571428571428571, 0.3071428571428571, 0.2965648422637793, 0.3798357534627028, 0.39999999999999997, 1.0, 0.0]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 0.546353249751977, 1.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.16611421015887298, 0.0, 0.0, 0.0, 0.2942351917292677, 0.5385438667434284, 0.5385438667434284]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, -1.9490889498022153, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.19068194063736155, 0.625, 0.6221496912762794, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.0, 6.210898792063733, 5.0, 7.0, 8.670628219354063, 11.0]) == [0.0, 0.1948658640064189, 0.25, 0.375, 0.7006811745039834, 0.625, 0.75, 0.8544142637096289, 1.0]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2806228932579327, 0.0, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, 4.009964202838896, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0, 2.0]) == [1.0, 0.5, 0.0, 0.375, 0.626245525354862, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375, 0.375]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 3.0, 6.210898792063733, 5.0, -3.6497815875309945, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.47203855153246277, 0.6614970533978501, 0.5900481894155785, 0.07966939295929135, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([-5.0, -2.1195243965065043, 3.093771311909787, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 6.210898792063733]) == [0.0, 0.18002972521834348, 0.5058607069943617, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.7006811745039834]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 4.0, 4.0, 100000.0, -100000.0, 4.0, 4.0]) == [0.5000094542896366, 0.50001, 0.500015, 0.500015, 0.50002, 0.50002, 1.0, 0.0, 0.50002, 0.50002]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 1.9231874764034629, 6.210898792063733, 5.0, 7.0, 9.0, 4.770428788329857, 13.0]) == [0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.38462152646685904, 0.6228277106702075, 0.5555555555555556, 0.6666666666666666, 0.7777777777777778, 0.5428015993516587, 1.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, -3.6497815875309945, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.47203855153246277, 0.6614970533978501, 0.5900481894155785, 0.07966939295929135, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569, 0.11800963788311569]
    @test rescale_to_unit([7.0, 3.0, 0.0, 9.0, -1.0, 2.0, 2.0, 4.0, 5.125238815616499, 6.0, 6.0]) == [0.8, 0.4, 0.1, 1.0, 0.0, 0.3, 0.3, 0.5, 0.6125238815616499, 0.7, 0.7]
    @test rescale_to_unit([-2.870785908662275, -3.0, -2.5, -1.2, 0.0, -2.5, 1.3, 2.6, 1.1519077916929108, 2.317700548477839, 2.6, 11.0, -3.0]) == [0.00922957795269465, 0.0, 0.03571428571428571, 0.1285714285714286, 0.21428571428571427, 0.03571428571428571, 0.3071428571428571, 0.39999999999999997, 0.2965648422637793, 0.3798357534627028, 0.39999999999999997, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.844455868175311, 3.0, 4.0, 3.7435131776430204, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.9222279340876556, 0.5, 1.0, 0.8717565888215102, 1.0, 1.0]
    @test rescale_to_unit([-5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 13.0, 6.210898792063733, 5.0, -3.271286856294544, 0.38904762141515903, 6.89535009486304, 6.210898792063733, -2.033802097685287, 6.210898792063733, 6.210898792063733]) == [0.0, 0.16002642241630533, 0.1111111111111111, 0.3333333333333333, 0.4444444444444444, 1.0, 0.6228277106702075, 0.5555555555555556, 0.09603961909474755, 0.2993915345230644, 0.6608527830479467, 0.6228277106702075, 0.16478877235081738, 0.6228277106702075, 0.6228277106702075]
    @test rescale_to_unit([1.0, 2.0, 2.604901901518098, 3.0, 19.0]) == [0.0, 0.05555555555555555, 0.08916121675100544, 0.1111111111111111, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.50001, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 3.0]) == [0.5000094542896366, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.500015]
    @test rescale_to_unit([7.0, 3.0, -5.0, 4.0, 6.0, -5.0, 6.0, 4.0]) == [1.0, 0.6666666666666666, 0.0, 0.75, 0.9166666666666666, 0.0, 0.9166666666666666, 0.75]
    @test rescale_to_unit([7.0, 1.7028886023781937, 3.0, 9.0, -1.0, 5.001164845966617, 2.0, 2.0, 1.9879782849688847, 6.0]) == [0.8, 0.2702888602378194, 0.4, 1.0, 0.0, 0.6001164845966617, 0.3, 0.3, 0.2987978284968885, 0.7]
    @test rescale_to_unit([5.373081551848091, 2.0, 2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 3.7435131776430204, 4.0, 4.0, 3.0]) == [1.0, 0.0, 0.0, 0.2964648155192412, 0.2964648155192412, 0.5468162686919754, 0.2964648155192412, 0.5929296310384824, 0.516890312565304, 0.5929296310384824, 0.5929296310384824, 0.2964648155192412]
    @test rescale_to_unit([-3.0, -1.2, -2.298305269747882, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.0, 0.32142857142857145, 0.12530263040216397, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.0]) == [0.0, 0.0, 0.5, 0.9222279340876556, 0.5, 1.0, 1.0, 1.0, 1.0]
    @test rescale_to_unit([2.3974061228253545, 2.0, 1.5971393412498083, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, -0.3440825794661051, 4.95439506042047, 4.0, 3.0]) == [0.5174106391718484, 0.4424068079140341, 0.36637352323666106, 0.6311402645718613, 0.6311402645718613, 0.7905173395675744, 0.6311402645718613, 0.8198737212296887, 0.8198737212296887, 0.0, 1.0, 0.8198737212296887, 0.6311402645718613]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.0, -1.2, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.1948658640064189, 0.25, 0.375, 0.2375, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -1.0, 1.0, 3.38441078074546, 3.0, 5.0, 9.0, 11.0, -1.0, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.25, 0.375, 0.5240256737965913, 0.5, 0.625, 0.875, 1.0, 0.25, 0.5]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, -0.9053077270335478, 4.0, 4.0, 4.0]) == [0.5910777203142337, 0.5910777203142337, 0.7945252638616261, 1.0, 0.7945252638616261, 0.0, 0.9979728074090186, 0.9979728074090186, 0.9979728074090186]
    @test rescale_to_unit([2.0, 2.0, 3.0, 0.18490766288493937, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825]) == [0.47576629258929487, 0.47576629258929487, 0.7378831462946475, 0.0, 0.7378831462946475, 0.7378831462946475, 1.0, 1.0, 1.0, 0.03238270122556595]
    @test rescale_to_unit([2.0, -3.6497815875309945, 3.0, 3.0, 3.0, 4.0, 4.0, 2.317700548477839, -100000.0, 2.317700548477839]) == [0.999980000799968, 0.9999235052439149, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 0.9999831776783776, 0.0, 0.9999831776783776]
    @test rescale_to_unit([-0.5100337078730766, -0.7560991815460972, 0.0, 0.0, 0.927368319637066, 0.0, 11.0, 1.0, 0.0]) == [0.020930877655343114, 0.0, 0.06431548168060447, 0.06431548168060447, 0.14319949799553858, 0.06431548168060447, 1.0, 0.1493777106187313, 0.06431548168060447]
    @test rescale_to_unit([13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [1.0, 0.0, 0.0, 0.0, 0.0, 0.07692307692307693, 0.0]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, 4.009964202838896, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0, 2.0, 6.0]) == [1.0, 0.5, 0.0, 0.375, 0.626245525354862, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375, 0.375, 0.875]
    @test rescale_to_unit([-5.0, -3.0, 3.0, 4.009964202838896, 6.210898792063733, 7.0, 9.0, 11.0, -5.0]) == [0.0, 0.125, 0.5, 0.563122762677431, 0.7006811745039834, 0.75, 0.875, 1.0, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([7.0, 3.0, -1.0, 2.0, -0.2950823455421112, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0, -0.2950823455421112]) == [1.0, 0.5, 0.0, 0.375, 0.0881147068072361, 0.375, 0.625, 0.3734972856211106, 0.875, 0.375, 0.0881147068072361]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 0.3084506581856825, 0.0, 0.0, 0.0, 0.546353249751977, 1.0, 1.0, 1.0]) == [0.0, 1.0, 0.0, 0.0, 0.16611421015887298, 0.0, 0.0, 0.0, 0.2942351917292677, 0.5385438667434284, 0.5385438667434284, 0.5385438667434284]
    @test rescale_to_unit([2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, -100000.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 0.9999831776783776, 0.0]
    @test rescale_to_unit([7.0, 9.0, -1.0, 4.0, 6.0, -1.0, 9.0]) == [0.8, 1.0, 0.0, 0.5, 0.7, 0.0, 1.0]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.9879782849688847, -1.0, 2.6672071366353363, 2.0, 4.0, 6.0, 3.0]) == [0.8, 0.4, 1.0, 0.2987978284968885, 0.0, 0.36672071366353365, 0.3, 0.5, 0.7, 0.4]
    @test rescale_to_unit([-5.0, -3.0, -0.3115474205775115, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 11.0, 11.0]) == [0.0, 0.125, 0.29302828621390553, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 1.0, 1.0]
    @test rescale_to_unit([-3.0, -2.5, -12.900064462349789, 0.0, -1.9243870830593395, 1.3, 2.6, -2.033802097685287, 2.317700548477839, 2.6, 11.0, -1.9243870830593395, 0.0]) == [0.4142275213502266, 0.43514796701628994, 0.0, 0.5397501953466066, 0.45923212452337253, 0.5941433540783713, 0.6485365128101359, 0.45465410278630525, 0.6367248521358783, 0.6485365128101359, 1.0, 0.45923212452337253, 0.5397501953466066]
    @test rescale_to_unit([1.377524891878108, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.424148152025293, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.2597552991425194, 0.4109994343234006, 0.6539716161945909, 0.8993648221701548, 0.6539716161945909, 0.6539716161945909, 0.8969437980657812, 1.0, 0.0, 0.8969437980657812, 0.0]
    @test rescale_to_unit([1.0, -0.1, 2.0, 4.0, 4.0, 4.0, 1.0]) == [0.26829268292682934, 0.0, 0.5121951219512195, 1.0, 1.0, 1.0, 0.26829268292682934]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 3.0, 2.675310403852642, 4.0, 4.0, 4.0, 0.546353249751977, -100000.0, 4.0, 4.0]) == [0.9999789094228964, 0.999980000799968, 0.999990000399984, 0.999990000399984, 0.999990000399984, 0.9999867536338931, 1.0, 1.0, 1.0, 0.9999654649139009, 0.0, 1.0, 1.0]
    @test rescale_to_unit([4.833878055412355, 3.0, 9.0, -1.0, 2.0, 1.9879782849688847, 2.0, 2.0, 3.0, 7.687190467376851]) == [0.5833878055412355, 0.4, 1.0, 0.0, 0.3, 0.2987978284968885, 0.3, 0.3, 0.4, 0.8687190467376851]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.132612632596544, 4.0, 4.0, 4.0, 3.518404627675752, 0.3084506581856825]) == [0.45822205940851846, 0.45822205940851846, 0.7291110297042592, 0.7291110297042592, 0.7650343291965445, 1.0, 1.0, 1.0, 0.8695411254918906, 0.0]
    @test rescale_to_unit([7.0, 1.613929098849716, 3.0, 9.0, -1.0, 1.377524891878108, 2.0, 1.9879782849688847, 6.0, 2.0]) == [0.8, 0.26139290988497155, 0.4, 1.0, 0.0, 0.2377524891878108, 0.3, 0.2987978284968885, 0.7, 0.3]
    @test rescale_to_unit([-2.033802097685287, -5.0, 3.266924662181324, -2.1195243965065043, -3.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.18538736889466956, 0.0, 0.5166827913863328, 0.18002972521834348, 0.125, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834]
    @test rescale_to_unit([2.317700548477839, -3.0, -1.0, 1.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, -0.5]) == [0.3798357534627028, 0.0, 0.14285714285714285, 0.2857142857142857, 0.6579213422902667, 0.5714285714285714, 0.7142857142857143, 0.8571428571428571, 1.0, 0.17857142857142858]
    @test rescale_to_unit([-4.747059300613937, -0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 1.1519077916929108, 11.0, -1.0, -2.5, 3.0, -2.5]) == [0.01580879371162891, 0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.3844942369808069, 1.0, 0.25, 0.15625, 0.5, 0.15625]
    @test rescale_to_unit([3.0, 0.0, 9.0, -1.0, 2.0, 2.0, 4.0, 5.125238815616499, 6.0, 6.0]) == [0.4, 0.1, 1.0, 0.0, 0.3, 0.3, 0.5, 0.6125238815616499, 0.7, 0.7]
    @test rescale_to_unit([0.0, 0.1581270304608839, 0.0, 0.0, 0.0, 0.0]) == [0.0, 1.0, 0.0, 0.0, 0.0, 0.0]
    @test rescale_to_unit([-5.0, 2.709339832728434, -2.1195243965065043, 3.093771311909787, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 6.210898792063733]) == [0.0, 0.4818337395455271, 0.18002972521834348, 0.5058607069943617, 0.125, 0.25, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.7006811745039834]
    @test rescale_to_unit([13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 13.0]) == [1.0, 0.0, 0.0, 0.0, 0.0, 0.07692307692307693, 0.0, 1.0]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 5.423014615696999, 9.0, 11.0, -1.0, 3.0, 5.0, 5.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6514384134810625, 0.875, 1.0, 0.25, 0.5, 0.625, 0.625]
    @test rescale_to_unit([-5.0, -3.0, -0.3115474205775115, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0]) == [0.0, 0.125, 0.29302828621390553, 0.375, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0]
    @test rescale_to_unit([3.0, 0.0, 9.0, -1.0, 2.0, 2.0, 4.0, 6.0, 0.3128608452500923, 6.0]) == [0.4, 0.1, 1.0, 0.0, 0.3, 0.3, 0.5, 0.7, 0.13128608452500923, 0.7]
    @test rescale_to_unit([13.0, 0.3084506581856825, 0.0, 0.0, 0.0, 1.0]) == [1.0, 0.02372697370659096, 0.0, 0.0, 0.0, 0.07692307692307693]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 4.0, 4.0, 100000.0, 4.0, 4.0]) == [0.0, 1.0914413642692594e-6, 1.1091630453637403e-5, 1.1091630453637403e-5, 2.1091819543005547e-5, 2.1091819543005547e-5, 1.0, 2.1091819543005547e-5, 2.1091819543005547e-5]
    @test rescale_to_unit([7.0, 3.0, 9.0, 1.9879782849688847, -1.0, 2.6672071366353363, 2.0, 4.0, 3.0]) == [0.8, 0.4, 1.0, 0.2987978284968885, 0.0, 0.36672071366353365, 0.3, 0.5, 0.4]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 13.0, -3.0]) == [0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.4444444444444444, 0.6228277106702075, 0.5555555555555556, 0.6666666666666666, 0.7777777777777778, 1.0, 0.1111111111111111]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, -2.5, 3.0, -2.5]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.15625, 0.5, 0.15625]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 0.3084506581856825, 4.0, 3.0]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0, 0.0, 0.9973080733816876, 0.7271483163156932]
    @test rescale_to_unit([-3.0, -2.5, -1.2, 0.0, -2.5, 2.6, 2.317700548477839, 2.6, 11.439507913526228, 2.6]) == [0.0, 0.03462721880789472, 0.12465798770842099, 0.2077633128473683, 0.03462721880789472, 0.3878248506484208, 0.3682743608940078, 0.3878248506484208, 1.0, 0.3878248506484208]
    @test rescale_to_unit([13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0]) == [1.0, 0.0, 0.0, 0.0, 0.0, 0.07692307692307693, 1.0]
    @test rescale_to_unit([2.0, 2.6274907176106725, 3.3897940249536718, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 15.0, 100000.0, 1.8803882689883606, -100000.0, 100000.0]) == [0.50001, 0.5000131374535881, 0.5000169489701248, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.500075, 1.0, 0.5000094019413449, 0.0, 1.0]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 1.0, 0.546353249751977, 1.8568589519865748, 1.8568589519865748]) == [0.0, 1.0, 0.0, 0.0, 0.5385438667434284, 0.2942351917292677, 1.0, 1.0]
    @test rescale_to_unit([4.833878055412355, 3.0, 9.0, -1.0, 2.0, 1.9879782849688847, 6.0, 1.1020021624546297, 2.0, 3.0, 7.687190467376851]) == [0.5833878055412355, 0.4, 1.0, 0.0, 0.3, 0.2987978284968885, 0.7, 0.21020021624546298, 0.3, 0.4, 0.8687190467376851]
    @test rescale_to_unit([2.0, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 3.7435131776430204, 4.0, 4.0]) == [0.0, 0.5, 0.5, 0.9222279340876556, 0.5, 1.0, 0.8717565888215102, 1.0, 1.0]
    @test rescale_to_unit([-3.0, -1.2, -2.298305269747882, 0.0, -2.5, 1.3, 2.6274907176106725, 2.317700548477839]) == [0.0, 0.3198583685561806, 0.12469051757939542, 0.5330972809269677, 0.08884954682116128, 0.764106102661987, 1.0, 0.9449505677257937]
    @test rescale_to_unit([2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.317700548477839, 1.0, -100000.0, -100000.0]) == [0.999980000799968, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 1.0, 0.9999831776783776, 0.999970001199952, 0.0, 0.0]
    @test rescale_to_unit([2.3974061228253545, 2.7499191886213326, 2.0, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 2.3974061228253545, 4.0]) == [0.19870306141267724, 0.3749595943106663, 0.0, 0.5, 0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 0.19870306141267724, 1.0]
    @test rescale_to_unit([2.0, 3.5496229973645987, 3.0, 3.0, 2.093512706816888, 3.0, 4.0, 4.0, 2.317700548477839, -100000.0]) == [0.999980000799968, 0.9999954964101172, 0.999990000399984, 0.999990000399984, 0.9999809358896327, 0.999990000399984, 1.0, 1.0, 0.9999831776783776, 0.0]
    @test rescale_to_unit([2.0, 2.0, 3.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 0.3084506581856825, 4.0, 3.0]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0, 0.0, 0.9973080733816876, 0.7271483163156932]
    @test rescale_to_unit([-2.1195243965065043, 2.3974061228253545, 2.7499191886213326, 2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 2.3974061228253545, 4.0]) == [0.0, 0.7381179037231178, 0.7957225545023874, 0.6731772160036238, 0.8365886080018119, 0.8365886080018119, 1.0, 1.0, 1.0, 0.7381179037231178, 1.0]
    @test rescale_to_unit([2.0, 1.8568589519865748, 3.0, 4.0, 2.3974061228253545, 100000.0, -100000.0, 2.0]) == [0.50001, 0.5000092842947599, 0.500015, 0.50002, 0.5000119870306141, 1.0, 0.0, 0.50001]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.132612632596544, 4.0, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.566306316298272, 1.0, 1.0, 1.0, 0.5]
    @test rescale_to_unit([0.0, 0.0, 0.0, -4.747059300613937, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.8259979673616429, 0.8259979673616429, 0.8259979673616429, 0.0, 0.8259979673616429, 0.8259979673616429, 0.8259979673616429, 0.8259979673616429, 1.0, 0.8259979673616429]
    @test rescale_to_unit([2.0, 3.63532512522154, 3.0, 3.0, 3.0, 4.0, 4.0, 4.0, 100000.0, -100000.0]) == [0.50001, 0.5000181766256261, 0.500015, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 1.0, 0.0]
    @test rescale_to_unit([8.485686893878379, 0.0, 0.0, 0.0, 1.0]) == [1.0, 0.0, 0.0, 0.0, 0.1178454982496945]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 3.0, 3.0164328160662626, 4.0, 4.0, 4.0, 3.0]) == [0.0, 0.0, 0.5, 0.5, 0.5, 0.5082164080331313, 1.0, 1.0, 1.0, 0.5]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, 3.0, 1.0, 5.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.5, 0.375, 0.625]
    @test rescale_to_unit([2.0, 2.0, 4.009964202838896, 3.0, 3.0, 4.0, 4.0]) == [0.0, 0.0, 1.0, 0.49752129843287196, 0.49752129843287196, 0.9950425968657439, 0.9950425968657439]
    @test rescale_to_unit([1.0, 2.0, 3.0, 1.991219214535127]) == [0.0, 0.5, 1.0, 0.49560960726756353]
    @test rescale_to_unit([-1.0, 5.0, 7.0, 9.0, 11.0, 13.0, 15.0, 17.0, 24.946980870408836, 19.0, 17.0, 23.70225109869183, 17.0]) == [0.0, 0.23124077633412385, 0.30832103511216513, 0.38540129389020644, 0.4624815526682477, 0.539561811446289, 0.6166420702243303, 0.6937223290023715, 1.0, 0.7708025877804129, 0.6937223290023715, 0.9520279535436604, 0.6937223290023715]
    @test rescale_to_unit([7.0, 3.0, 9.0, -0.09033406201985716, 2.0, 4.0, 6.577002407130273]) == [0.7799860834206127, 0.33995825026183807, 1.0, 0.0, 0.22995129197214437, 0.4499652085515317, 0.7334534048651519]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 3.0164328160662626, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0, 3.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.5010270510041415, 0.5, 0.625, 0.6221496912762794, 0.15625, 0.875, 1.0, 0.25, 0.15625, 0.5, 0.5]
    @test rescale_to_unit([2.0, 3.0, 3.0, 5.373081551848091, 4.0, 4.0, 2.317700548477839, -100000.0, -100000.0]) == [0.9999662709967684, 0.9999762704594891, 0.9999762704594891, 1.0, 0.9999862699222097, 0.9999862699222097, 0.9999694478315592, 0.0, 0.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 3.0, 1.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 3.0]) == [0.18538736889466956, 0.0, 0.18002972521834348, 0.125, 0.375, 0.5, 0.375, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.5]
    @test rescale_to_unit([7.0, 15.0, -0.6957571854516531, -5.0, 2.0, 4.0, 6.0, -5.0, 6.0, 2.2570567824361802, 3.0]) == [0.6, 1.0, 0.21521214072741737, 0.0, 0.35, 0.45, 0.55, 0.0, 0.55, 0.362852839121809, 0.4]
    @test rescale_to_unit([-4.747059300613937, -0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 1.1519077916929108, 11.0, -1.0, 3.0, -2.5]) == [0.01580879371162891, 0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.3844942369808069, 1.0, 0.25, 0.5, 0.15625]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 5.423014615696999, 8.509277922044287, 11.0, -1.0, 3.0, 5.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6514384134810625, 0.844329870127768, 1.0, 0.25, 0.5, 0.625]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0, 1.0]) == [0.0, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.5714285714285714, 0.7142857142857143, 0.8571428571428571, 1.0, 0.42857142857142855]
    @test rescale_to_unit([-5.0, -1.8821461758972977, -1.0, 1.0, -1.2, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 6.210898792063733, 5.0]) == [0.0, 0.1948658640064189, 0.25, 0.375, 0.2375, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.7006811745039834, 0.625]
    @test rescale_to_unit([7.0, 3.0, 9.0, -0.09033406201985716, 2.0, 5.829250022189214, 6.577002407130273, 2.0]) == [0.7799860834206127, 0.33995825026183807, 1.0, 0.0, 0.22995129197214437, 0.6511954394439218, 0.7334534048651519, 0.22995129197214437]
    @test rescale_to_unit([-5.063682676514065, -3.0, 1.0, 2.9770126806470683, -3.9144111138034585, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733]) == [0.0, 0.1284688398091476, 0.3774777427208197, 0.5005511823834173, 0.07154471274453779, 0.7018677905697066, 0.6264866456324919, 0.7509910970883279, 0.875495548544164, 1.0, 0.7018677905697066]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 5.0, 9.0, -5.0, 11.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.625, 0.875, 0.0, 1.0]
    @test rescale_to_unit([1.882888909339558, -3.0, -1.2, 0.0, -2.5, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.8719444480963496, 0.0, 0.32142857142857145, 0.5357142857142857, 0.08928571428571429, 0.7678571428571429, 1.0, 0.9495893836567572, 1.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 1.3, 6.210898792063733, 0.1581270304608839, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.3717303593318144, 0.6614970533978501, 0.30435435150989987, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.510011823263119, 4.009964202838896, 3.0, 3.0, 4.0, 4.0, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825, 4.0, 0.3084506581856825]) == [0.4569885592496988, 0.4569885592496988, 0.7271483163156932, 0.8649329865892422, 1.0, 0.7271483163156932, 0.7271483163156932, 0.9973080733816876, 0.9973080733816876, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0, 0.9973080733816876, 0.0]
    @test rescale_to_unit([-5.0, -2.1195243965065043, -3.0, -1.0, 0.46169913310022603, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 11.0, 6.210898792063733, 9.0]) == [0.0, 0.18002972521834348, 0.125, 0.25, 0.34135619581876414, 0.5, 0.7006811745039834, 0.625, 0.75, 0.875, 1.0, 0.7006811745039834, 0.875]
    @test rescale_to_unit([1.89085792733363, 2.0, 3.0, 3.0, 3.0, 4.0, 3.6864156720265173, 4.0, 100000.0, -100000.0, 4.0]) == [0.5000094542896366, 0.50001, 0.500015, 0.500015, 0.500015, 0.50002, 0.5000184320783602, 0.50002, 1.0, 0.0, 0.50002]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, -3.0, 1.0, 1.3, 6.210898792063733, 0.1581270304608839, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.11800963788311569, 0.3540289136493471, 0.3717303593318144, 0.6614970533978501, 0.30435435150989987, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([2.3974061228253545, 1.6182674623272582, 3.0, 3.0, 3.844455868175311, 3.0, 4.0, 4.0, 4.0, 4.95439506042047, 4.0, 3.0]) == [0.23354582149178546, 0.0, 0.4141725689576385, 0.4141725689576385, 0.6672971402893724, 0.4141725689576385, 0.7139212957663964, 0.7139212957663964, 0.7139212957663964, 1.0, 0.7139212957663964, 0.4141725689576385]
    @test rescale_to_unit([-5.0, -2.1195243965065043, -3.0, -1.0, 1.0, 3.0, 6.210898792063733, 5.0, 7.0, 9.0, 6.210898792063733, 2.996533149237559]) == [0.0, 0.20574825739239255, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.5714285714285714, 0.8007784851474096, 0.7142857142857143, 0.8571428571428571, 1.0, 0.8007784851474096, 0.5711809392312542]
    @test rescale_to_unit([0.0, 1.8568589519865748, 0.0, 0.0, 1.0, 3.266924662181324, 1.8568589519865748, 1.8568589519865748]) == [0.0, 0.5683813200475676, 0.0, 0.0, 0.3060982738831512, 1.0, 0.5683813200475676, 0.5683813200475676]
    @test rescale_to_unit([-5.0, -3.0, 0.3128608452500923, 3.0, 6.210898792063733, 0.3128608452500923, 5.0, 7.0, 9.0, 11.0, -3.0]) == [0.0, 0.125, 0.3320538028281308, 0.5, 0.7006811745039834, 0.3320538028281308, 0.625, 0.75, 0.875, 1.0, 0.125]
    @test rescale_to_unit([2.0, 2.0, 3.0, 3.0, 4.0, 4.0, 4.0, 4.0, 100000.0, -100000.0, 4.0, 4.0]) == [0.50001, 0.50001, 0.500015, 0.500015, 0.50002, 0.50002, 0.50002, 0.50002, 1.0, 0.0, 0.50002, 0.50002]
    @test rescale_to_unit([-0.5100337078730766, -5.0, -2.033802097685287, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, 9.0, 11.0, -1.0, -2.5, 3.0, 11.0, -5.0]) == [0.2806228932579327, 0.0, 0.18538736889466956, 0.0, 0.25, 0.375, 0.5, 0.625, 0.6221496912762794, 0.875, 1.0, 0.25, 0.15625, 0.5, 1.0, 0.0]
    @test rescale_to_unit([4.833878055412355, 3.254937912294724, 9.0, -1.0, 2.0, 1.9879782849688847, 2.0, 2.0, 3.0, 7.687190467376851]) == [0.5833878055412355, 0.4254937912294724, 1.0, 0.0, 0.3, 0.2987978284968885, 0.3, 0.3, 0.4, 0.8687190467376851]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0]) == [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 3.0, 5.0, 7.0, 9.0, -5.0]) == [0.0, 0.14285714285714285, 0.2857142857142857, 0.42857142857142855, 0.5714285714285714, 0.7142857142857143, 0.8571428571428571, 1.0, 0.0]
    @test rescale_to_unit([13.0, 0.3084506581856825, 0.0, 0.0, -0.31361409536449547, 1.0]) == [1.0, 0.04672395858062065, 0.023555894974730332, 0.023555894974730332, 0.0, 0.09866697997667415]
    @test rescale_to_unit([-0.5100337078730766, -0.7560991815460972, 0.0, 0.3084506581856825, 3.3897940249536718, 0.0, 0.0, 11.0, 1.0]) == [0.020930877655343114, 0.0, 0.06431548168060447, 0.0905529821833109, 0.35265891708430824, 0.06431548168060447, 0.06431548168060447, 1.0, 0.1493777106187313]
    @test rescale_to_unit([2.604901901518098, 3.0, -1.0, 2.0, 4.009964202838896, 2.0, 4.0, 1.9879782849688847, 6.0, 2.0, 2.0, 6.0]) == [0.5149859859311569, 0.5714285714285714, 0.0, 0.42857142857142855, 0.715709171834128, 0.42857142857142855, 0.7142857142857143, 0.42685404070984073, 1.0, 0.42857142857142855, 0.42857142857142855, 1.0]
    @test rescale_to_unit([-5.0, -3.0, -1.0, 1.0, 7.0, 6.210898792063733, 5.0, 7.0, 9.0, 4.770428788329857, 13.0]) == [0.0, 0.1111111111111111, 0.2222222222222222, 0.3333333333333333, 0.6666666666666666, 0.6228277106702075, 0.5555555555555556, 0.6666666666666666, 0.7777777777777778, 0.5428015993516587, 1.0]
    @test rescale_to_unit([0.0, 2.6, 0.0, 0.0, 1.0, 0.20411598356772886]) == [0.0, 1.0, 0.0, 0.0, 0.3846153846153846, 0.07850614752604956]
    @test rescale_to_unit([0.0, 0.0, 0.0, 0.0, 1.0, 0.0]) == [0.0, 0.0, 0.0, 0.0, 1.0, 0.0]
    @test rescale_to_unit([-2.033802097685287, -5.0, -2.1195243965065043, 3.38441078074546, -2.077778522892178, 1.0, 1.3, 6.210898792063733, 0.1581270304608839, 5.0, 7.0, 9.0, 11.947768299915708, 6.210898792063733, -3.0]) == [0.1750199701709083, 0.0, 0.16996194144970828, 0.49472064004953153, 0.17242514916387877, 0.3540289136493471, 0.3717303593318144, 0.6614970533978501, 0.30435435150989987, 0.5900481894155785, 0.7080578272986942, 0.8260674651818098, 1.0, 0.6614970533978501, 0.11800963788311569]
    @test rescale_to_unit([1.0, 3.0, 4.0, 2.0, 4.0]) == [0.0, 0.6666666666666666, 1.0, 0.3333333333333333, 1.0]
    @test rescale_to_unit([2.0, -3.6497815875309945, 3.0, 3.0, 3.0, 4.0, 4.0, -3.4147617533948647, 4.0, 2.317700548477839, -100000.0, 2.317700548477839, 3.0, 2.317700548477839]) == [0.999980000799968, 0.9999235052439149, 0.999990000399984, 0.999990000399984, 0.999990000399984, 1.0, 1.0, 0.9999258553482522, 1.0, 0.9999831776783776, 0.0, 0.9999831776783776, 0.999990000399984, 0.9999831776783776]
    @test rescale_to_unit([-3.0, 5.423014615696999, -2.5, -1.2, 0.0, 1.3, 2.6, 2.317700548477839, 2.6]) == [0.0, 1.0, 0.05936116970142825, 0.2137002109251417, 0.3561670182085695, 0.5105060594322829, 0.6648451006559963, 0.6313298493591422, 0.6648451006559963]
    @test rescale_to_unit([-5.0, -2.033802097685287, -1.0, 1.0, 3.0, 5.0, 5.423014615696999, 8.509277922044287, 11.0, -1.0, 3.941667953273927, 5.0]) == [0.0, 0.18538736889466956, 0.25, 0.375, 0.5, 0.625, 0.6514384134810625, 0.844329870127768, 1.0, 0.25, 0.5588542470796205, 0.625]
    @test rescale_to_unit([-0.5100337078730766, -5.063682676514065, -5.0, -1.0, 1.0, 3.0, 5.0, 4.95439506042047, -2.5, 9.0, 11.0, -1.0, -2.5, 3.0]) == [0.2834747834815399, 0.0, 0.003964388353311572, 0.2529732912649837, 0.3774777427208197, 0.5019821941766558, 0.6264866456324919, 0.6236476366394789, 0.15959495267310664, 0.875495548544164, 1.0, 0.2529732912649837, 0.15959495267310664, 0.5019821941766558]
end
